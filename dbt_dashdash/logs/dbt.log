[0m16:47:33.391124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104955e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104955e50>]}


============================== 16:47:33.393713 | 732088d9-6819-4d15-9c53-eb1ef8df5d3a ==============================
[0m16:47:33.393713 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:47:33.394032 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash', 'use_colors': 'True', 'log_format': 'default', 'version_check': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'target_path': 'None', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash', 'debug': 'False', 'log_cache_events': 'False'}
[0m16:47:33.519631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '732088d9-6819-4d15-9c53-eb1ef8df5d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104985d30>]}
[0m16:47:33.530671 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-1uguv6pq'
[0m16:47:33.530970 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:47:33.632463 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:47:33.633381 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:47:33.692911 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:47:33.698607 [info ] [MainThread]: Updating lock file in file path: /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/package-lock.yml
[0m16:47:33.699601 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-cglo4byv'
[0m16:47:33.700901 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:47:33.943059 [info ] [MainThread]: Installed from version 1.1.1
[0m16:47:33.943316 [info ] [MainThread]: Updated version available: 1.3.1
[0m16:47:33.943511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '732088d9-6819-4d15-9c53-eb1ef8df5d3a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105728500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587b140>]}
[0m16:47:33.943722 [info ] [MainThread]: 
[0m16:47:33.943884 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m16:47:33.945483 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.58892864, "process_in_blocks": "0", "process_kernel_time": 0.171946, "process_mem_max_rss": "114835456", "process_out_blocks": "0", "process_user_time": 0.760562}
[0m16:47:33.945761 [debug] [MainThread]: Command `dbt deps` succeeded at 16:47:33.945716 after 0.59 seconds
[0m16:47:33.945944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105728500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104985d30>]}
[0m16:47:33.946123 [debug] [MainThread]: Flushing usage events
[0m16:47:34.103887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:34.900132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c56cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7ddf0>]}


============================== 16:47:34.902261 | 85c1ddf8-b2fa-47a2-8fe0-80f2f87c7bee ==============================
[0m16:47:34.902261 [info ] [MainThread]: Running with dbt=1.10.11
[0m16:47:34.902558 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash', 'no_print': 'None', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:47:34.903903 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dashdash_lab'
[0m16:47:34.905045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.039457083, "process_in_blocks": "0", "process_kernel_time": 0.091831, "process_mem_max_rss": "105152512", "process_out_blocks": "0", "process_user_time": 0.614375}
[0m16:47:34.905334 [debug] [MainThread]: Command `dbt run` failed at 16:47:34.905292 after 0.04 seconds
[0m16:47:34.905497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c46b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998b470>]}
[0m16:47:34.905650 [debug] [MainThread]: Flushing usage events
[0m16:47:34.982899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:20.739305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103320bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5a120>]}


============================== 17:24:20.741925 | 692e6221-42cc-4a79-a56e-fd005d4c9b48 ==============================
[0m17:24:20.741925 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:24:20.742274 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'None', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'introspect': 'True', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m17:24:20.869201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '692e6221-42cc-4a79-a56e-fd005d4c9b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c39880>]}
[0m17:24:20.897521 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-crhtzqei'
[0m17:24:20.897786 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:24:20.999119 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:24:21.000129 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:24:21.050173 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:24:21.052511 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:24:21.325675 [info ] [MainThread]: Installed from version 1.1.1
[0m17:24:21.325947 [info ] [MainThread]: Updated version available: 1.3.1
[0m17:24:21.326151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '692e6221-42cc-4a79-a56e-fd005d4c9b48', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d34f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d34320>]}
[0m17:24:21.326345 [info ] [MainThread]: 
[0m17:24:21.326518 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:24:21.328149 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6245197, "process_in_blocks": "0", "process_kernel_time": 0.191814, "process_mem_max_rss": "116588544", "process_out_blocks": "0", "process_user_time": 0.769216}
[0m17:24:21.328407 [debug] [MainThread]: Command `dbt deps` succeeded at 17:24:21.328365 after 0.62 seconds
[0m17:24:21.328579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ae3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ae6c0>]}
[0m17:24:21.328744 [debug] [MainThread]: Flushing usage events
[0m17:24:21.445598 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:22.305571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c7c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105276780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c3fe0>]}


============================== 17:24:22.307850 | ce0e6537-7a40-441a-b614-10fcd255204b ==============================
[0m17:24:22.307850 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:24:22.308161 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'no_print': 'None', 'fail_fast': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'False', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default'}
[0m17:24:22.416054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f6ea0>]}
[0m17:24:22.446833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c28770>]}
[0m17:24:22.447638 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:24:22.525211 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:24:22.525649 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:24:22.525829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610faa0>]}
[0m17:24:23.076624 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:24:23.076937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106547950>]}
[0m17:24:23.197629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106876a20>]}
[0m17:24:23.235031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:24:23.236038 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:24:23.271905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065eed50>]}
[0m17:24:23.272186 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:24:23.272351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a7140>]}
[0m17:24:23.273291 [info ] [MainThread]: 
[0m17:24:23.273450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:24:23.273576 [info ] [MainThread]: 
[0m17:24:23.273791 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:24:23.275569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m17:24:23.310335 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m17:24:23.310579 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m17:24:23.310715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:23.602531 [debug] [ThreadPool]: SQL status: SELECT 100 in 0.292 seconds
[0m17:24:23.605938 [debug] [ThreadPool]: On list_neondb: Close
[0m17:24:23.607683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now create_neondb_netid1234_netid1234)
[0m17:24:23.608641 [debug] [ThreadPool]: Creating schema "database: "neondb"
schema: "netid1234_netid1234"
"
[0m17:24:23.618969 [debug] [ThreadPool]: Using postgres connection "create_neondb_netid1234_netid1234"
[0m17:24:23.619230 [debug] [ThreadPool]: On create_neondb_netid1234_netid1234: BEGIN
[0m17:24:23.619362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:23.809587 [debug] [ThreadPool]: SQL status: BEGIN in 0.190 seconds
[0m17:24:23.810243 [debug] [ThreadPool]: Using postgres connection "create_neondb_netid1234_netid1234"
[0m17:24:23.810709 [debug] [ThreadPool]: On create_neondb_netid1234_netid1234: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "create_neondb_netid1234_netid1234"} */
create schema if not exists "netid1234_netid1234"
[0m17:24:23.928431 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.117 seconds
[0m17:24:23.930795 [debug] [ThreadPool]: On create_neondb_netid1234_netid1234: COMMIT
[0m17:24:23.931568 [debug] [ThreadPool]: Using postgres connection "create_neondb_netid1234_netid1234"
[0m17:24:23.932179 [debug] [ThreadPool]: On create_neondb_netid1234_netid1234: COMMIT
[0m17:24:23.952686 [debug] [ThreadPool]: SQL status: COMMIT in 0.020 seconds
[0m17:24:23.953927 [debug] [ThreadPool]: On create_neondb_netid1234_netid1234: Close
[0m17:24:23.957793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_neondb_netid1234_netid1234, now list_neondb_netid1234_netid1234)
[0m17:24:23.967001 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:24:23.967537 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: BEGIN
[0m17:24:23.967933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:24.134581 [debug] [ThreadPool]: SQL status: BEGIN in 0.167 seconds
[0m17:24:24.135499 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:24:24.136229 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_netid1234_netid1234"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'netid1234_netid1234'
  
[0m17:24:24.174988 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.038 seconds
[0m17:24:24.178239 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: ROLLBACK
[0m17:24:24.197175 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: Close
[0m17:24:24.208001 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:24.209109 [debug] [MainThread]: On master: BEGIN
[0m17:24:24.209628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:24.469775 [debug] [MainThread]: SQL status: BEGIN in 0.260 seconds
[0m17:24:24.471352 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:24.472271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:24:24.507532 [debug] [MainThread]: SQL status: SELECT 77 in 0.034 seconds
[0m17:24:24.513633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a035f0>]}
[0m17:24:24.514669 [debug] [MainThread]: On master: ROLLBACK
[0m17:24:24.533082 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:24.533853 [debug] [MainThread]: On master: BEGIN
[0m17:24:24.571898 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m17:24:24.573433 [debug] [MainThread]: On master: COMMIT
[0m17:24:24.574535 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:24.575153 [debug] [MainThread]: On master: COMMIT
[0m17:24:24.598783 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m17:24:24.600485 [debug] [MainThread]: On master: Close
[0m17:24:24.607222 [debug] [Thread-1 (]: Began running node model.dashdash_lab.stg_couriers
[0m17:24:24.608034 [debug] [Thread-2 (]: Began running node model.dashdash_lab.stg_customers
[0m17:24:24.608902 [debug] [Thread-3 (]: Began running node model.dashdash_lab.stg_orders
[0m17:24:24.609668 [debug] [Thread-4 (]: Began running node model.dashdash_lab.stg_restaurants
[0m17:24:24.610558 [info ] [Thread-1 (]: 1 of 10 START sql view model netid1234_netid1234.stg_couriers .................. [RUN]
[0m17:24:24.611334 [info ] [Thread-2 (]: 2 of 10 START sql view model netid1234_netid1234.stg_customers ................. [RUN]
[0m17:24:24.612066 [info ] [Thread-3 (]: 3 of 10 START sql view model netid1234_netid1234.stg_orders .................... [RUN]
[0m17:24:24.612707 [info ] [Thread-4 (]: 4 of 10 START sql view model netid1234_netid1234.stg_restaurants ............... [RUN]
[0m17:24:24.613418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_netid1234_netid1234, now model.dashdash_lab.stg_couriers)
[0m17:24:24.614101 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_customers'
[0m17:24:24.614678 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_orders'
[0m17:24:24.615230 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_restaurants'
[0m17:24:24.615711 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.stg_couriers
[0m17:24:24.616113 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.stg_customers
[0m17:24:24.616335 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.stg_orders
[0m17:24:24.616492 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.stg_restaurants
[0m17:24:24.620073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.stg_couriers"
[0m17:24:24.621309 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.stg_customers"
[0m17:24:24.623345 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.stg_orders"
[0m17:24:24.624417 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.stg_restaurants"
[0m17:24:24.625133 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.stg_couriers
[0m17:24:24.625344 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.stg_restaurants
[0m17:24:24.625527 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.stg_customers
[0m17:24:24.637662 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.stg_orders
[0m17:24:24.641246 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.stg_couriers"
[0m17:24:24.642830 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.stg_restaurants"
[0m17:24:24.644179 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.stg_customers"
[0m17:24:24.645477 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.stg_orders"
[0m17:24:24.646354 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:24:24.646606 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:24:24.646791 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:24:24.646960 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:24:24.647103 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: BEGIN
[0m17:24:24.647274 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: BEGIN
[0m17:24:24.647452 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: BEGIN
[0m17:24:24.647653 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: BEGIN
[0m17:24:24.647836 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:24:24.647993 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:24:24.648149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:24.648301 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:24:24.951578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.303 seconds
[0m17:24:24.952718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.304 seconds
[0m17:24:24.953821 [debug] [Thread-3 (]: SQL status: BEGIN in 0.305 seconds
[0m17:24:24.954578 [debug] [Thread-2 (]: SQL status: BEGIN in 0.306 seconds
[0m17:24:24.955486 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:24:24.956262 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:24:24.956951 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:24:24.957603 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:24:24.958276 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */

  create view "neondb"."netid1234_netid1234"."stg_restaurants__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."dashdash"."restaurants"
  );
[0m17:24:24.959513 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */

  create view "neondb"."netid1234_netid1234"."stg_couriers__dbt_tmp"
    
    
  as (
    

select
  courier_id,
  courier_name,
  lower(vehicle_type) as vehicle_type,
  active_from,
  active_to,
  region
from "neondb"."dashdash"."couriers"
  );
[0m17:24:24.960460 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */

  create view "neondb"."netid1234_netid1234"."stg_orders__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(nullif(trim(status), '')) as status_norm,
        payment_method,
        
    
        NULLIF(BTRIM(subtotal::text), '')::numeric(10, 2)
    
 as subtotal,
        
    
        NULLIF(BTRIM(delivery_fee::text), '')::numeric(10, 2)
    
 as delivery_fee,
        
    
        NULLIF(BTRIM(tip_amount::text), '')::numeric(10, 2)
    
 as tip_amount,
        
    
        NULLIF(BTRIM(distance_km::text), '')::numeric(6, 2)
    
 as distance_km,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."dashdash"."orders"
),
dedup as (
    select *
    from base
    where rn = 1
),
clean as (
    select
        *,
        case
            when status_norm in ('delivered', 'canceled', 'returned') then status_norm
            when status_norm is null or status_norm = '' then 'unknown'
            else 'unknown'
        end as status_final,
        case
            when pickup_ts is not null and dropoff_ts is not null
                then 
    
        EXTRACT(epoch FROM (dropoff_ts - pickup_ts)) / 60.0
    

            else null
        end as delivery_minutes
    from dedup
)
select
    order_id,
    customer_id,
    restaurant_id,
    courier_id,
    order_ts,
    pickup_ts,
    dropoff_ts,
    status_final as status,
    payment_method,
    subtotal,
    delivery_fee,
    tip_amount,
    distance_km,
    delivery_minutes,
    case
        when status_final = 'delivered' and delivery_minutes <= 45 then 
    TRUE

        else 
    FALSE

    end as on_time_flag
from clean
  );
[0m17:24:24.961396 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */

  create view "neondb"."netid1234_netid1234"."stg_customers__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."dashdash"."customers"
  );
[0m17:24:24.980098 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "dashdash.restaurants" does not exist
LINE 11: from "neondb"."dashdash"."restaurants"
              ^

[0m17:24:24.981232 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: ROLLBACK
[0m17:24:24.997890 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "dashdash.orders" does not exist
LINE 53:     from "neondb"."dashdash"."orders"
                  ^

[0m17:24:24.999042 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "dashdash.customers" does not exist
LINE 11: from "neondb"."dashdash"."customers"
              ^

[0m17:24:25.000101 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dashdash.couriers" does not exist
LINE 16: from "neondb"."dashdash"."couriers"
              ^

[0m17:24:25.001266 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: ROLLBACK
[0m17:24:25.002023 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: ROLLBACK
[0m17:24:25.002691 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: ROLLBACK
[0m17:24:25.014175 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: Close
[0m17:24:25.026105 [debug] [Thread-4 (]: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "dashdash.restaurants" does not exist
  LINE 11: from "neondb"."dashdash"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:24:25.026940 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: Close
[0m17:24:25.027511 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: Close
[0m17:24:25.028034 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: Close
[0m17:24:25.032282 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106849d30>]}
[0m17:24:25.032740 [error] [Thread-4 (]: 4 of 10 ERROR creating sql view model netid1234_netid1234.stg_restaurants ...... [[31mERROR[0m in 0.41s]
[0m17:24:25.033166 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.stg_restaurants
[0m17:24:25.033826 [debug] [Thread-3 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "dashdash.orders" does not exist
  LINE 53:     from "neondb"."dashdash"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:24:25.034616 [debug] [Thread-1 (]: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "dashdash.couriers" does not exist
  LINE 16: from "neondb"."dashdash"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:24:25.034850 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_restaurants' to be skipped because of status 'error'.  Reason: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "dashdash.restaurants" does not exist
  LINE 11: from "neondb"."dashdash"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql.
[0m17:24:25.035470 [debug] [Thread-2 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "dashdash.customers" does not exist
  LINE 11: from "neondb"."dashdash"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:24:25.035682 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048520c0>]}
[0m17:24:25.035875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106848c80>]}
[0m17:24:25.036397 [debug] [Thread-4 (]: Began running node model.dashdash_lab.dim_restaurant
[0m17:24:25.036574 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0e6537-7a40-441a-b614-10fcd255204b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106849d30>]}
[0m17:24:25.036848 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model netid1234_netid1234.stg_orders ........... [[31mERROR[0m in 0.42s]
[0m17:24:25.037127 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model netid1234_netid1234.stg_couriers ......... [[31mERROR[0m in 0.42s]
[0m17:24:25.037336 [info ] [Thread-4 (]: 5 of 10 SKIP relation netid1234_netid1234.dim_restaurant ....................... [[33mSKIP[0m]
[0m17:24:25.037572 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model netid1234_netid1234.stg_customers ........ [[31mERROR[0m in 0.42s]
[0m17:24:25.037798 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.stg_orders
[0m17:24:25.038032 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.stg_couriers
[0m17:24:25.038207 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.dim_restaurant
[0m17:24:25.038424 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.stg_customers
[0m17:24:25.038628 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "dashdash.orders" does not exist
  LINE 53:     from "neondb"."dashdash"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql.
[0m17:24:25.038905 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_couriers' to be skipped because of status 'error'.  Reason: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "dashdash.couriers" does not exist
  LINE 16: from "neondb"."dashdash"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql.
[0m17:24:25.039119 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "dashdash.customers" does not exist
  LINE 11: from "neondb"."dashdash"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql.
[0m17:24:25.039455 [debug] [Thread-3 (]: Began running node model.dashdash_lab.dim_courier
[0m17:24:25.039618 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_customer
[0m17:24:25.039808 [info ] [Thread-3 (]: 6 of 10 SKIP relation netid1234_netid1234.dim_courier .......................... [[33mSKIP[0m]
[0m17:24:25.039981 [debug] [Thread-4 (]: Began running node model.dashdash_lab.fct_deliveries
[0m17:24:25.040132 [debug] [Thread-2 (]: Began running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:24:25.040287 [info ] [Thread-1 (]: 7 of 10 SKIP relation netid1234_netid1234.dim_customer ......................... [[33mSKIP[0m]
[0m17:24:25.040464 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.dim_courier
[0m17:24:25.040621 [info ] [Thread-4 (]: 8 of 10 SKIP relation netid1234_netid1234.fct_deliveries ....................... [[33mSKIP[0m]
[0m17:24:25.040797 [info ] [Thread-2 (]: 9 of 10 SKIP relation netid1234_netid1234.monitoring_dq_exceptions ............. [[33mSKIP[0m]
[0m17:24:25.040973 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_customer
[0m17:24:25.041203 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.fct_deliveries
[0m17:24:25.041379 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:24:25.041692 [debug] [Thread-3 (]: Began running node model.dashdash_lab.kpi_delivery_overview
[0m17:24:25.041907 [info ] [Thread-3 (]: 10 of 10 SKIP relation netid1234_netid1234.kpi_delivery_overview ............... [[33mSKIP[0m]
[0m17:24:25.042128 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.kpi_delivery_overview
[0m17:24:25.042745 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:25.042918 [debug] [MainThread]: On master: BEGIN
[0m17:24:25.043045 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:25.225434 [debug] [MainThread]: SQL status: BEGIN in 0.182 seconds
[0m17:24:25.227150 [debug] [MainThread]: On master: COMMIT
[0m17:24:25.228357 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:25.229000 [debug] [MainThread]: On master: COMMIT
[0m17:24:25.247410 [debug] [MainThread]: SQL status: COMMIT in 0.018 seconds
[0m17:24:25.248903 [debug] [MainThread]: On master: Close
[0m17:24:25.250687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:25.251361 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_couriers' was properly closed.
[0m17:24:25.251943 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_customers' was properly closed.
[0m17:24:25.252449 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_orders' was properly closed.
[0m17:24:25.252961 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_restaurants' was properly closed.
[0m17:24:25.253685 [info ] [MainThread]: 
[0m17:24:25.254295 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m17:24:25.256588 [debug] [MainThread]: Command end result
[0m17:24:25.284219 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:24:25.285097 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:24:25.287664 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/run_results.json
[0m17:24:25.287825 [info ] [MainThread]: 
[0m17:24:25.287994 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m17:24:25.288130 [info ] [MainThread]: 
[0m17:24:25.288296 [error] [MainThread]: [31mFailure in model stg_restaurants (models/staging/stg_restaurants.sql)[0m
[0m17:24:25.288462 [error] [MainThread]:   Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "dashdash.restaurants" does not exist
  LINE 11: from "neondb"."dashdash"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:24:25.288589 [info ] [MainThread]: 
[0m17:24:25.288733 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:24:25.288856 [info ] [MainThread]: 
[0m17:24:25.289001 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m17:24:25.289155 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "dashdash.orders" does not exist
  LINE 53:     from "neondb"."dashdash"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:24:25.289278 [info ] [MainThread]: 
[0m17:24:25.289415 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.sql
[0m17:24:25.289533 [info ] [MainThread]: 
[0m17:24:25.289676 [error] [MainThread]: [31mFailure in model stg_couriers (models/staging/stg_couriers.sql)[0m
[0m17:24:25.289825 [error] [MainThread]:   Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "dashdash.couriers" does not exist
  LINE 16: from "neondb"."dashdash"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:24:25.289947 [info ] [MainThread]: 
[0m17:24:25.290087 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_couriers.sql
[0m17:24:25.290204 [info ] [MainThread]: 
[0m17:24:25.290342 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m17:24:25.290492 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "dashdash.customers" does not exist
  LINE 11: from "neondb"."dashdash"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:24:25.290611 [info ] [MainThread]: 
[0m17:24:25.290754 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_customers.sql
[0m17:24:25.290872 [info ] [MainThread]: 
[0m17:24:25.291014 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=6 NO-OP=0 TOTAL=10
[0m17:24:25.291255 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 9 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:24:25.292724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0216076, "process_in_blocks": "0", "process_kernel_time": 0.216594, "process_mem_max_rss": "139804672", "process_out_blocks": "0", "process_user_time": 1.756272}
[0m17:24:25.292929 [debug] [MainThread]: Command `dbt run` failed at 17:24:25.292894 after 3.02 seconds
[0m17:24:25.293105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c7c4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106350950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106848200>]}
[0m17:24:25.293263 [debug] [MainThread]: Flushing usage events
[0m17:24:25.476489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:45.658330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043162a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457a1e0>]}


============================== 17:40:45.661241 | 0efce114-de74-4e26-8113-7c8d302f8d4e ==============================
[0m17:40:45.661241 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:40:45.661549 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'write_json': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'partial_parse': 'True', 'debug': 'False', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'empty': 'None', 'indirect_selection': 'eager'}
[0m17:40:45.785038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0efce114-de74-4e26-8113-7c8d302f8d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d9910>]}
[0m17:40:45.808763 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-7o2_qm7y'
[0m17:40:45.809034 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:40:45.875167 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:40:45.876130 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:40:45.913517 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:40:45.915921 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:40:46.057455 [info ] [MainThread]: Installed from version 1.1.1
[0m17:40:46.057729 [info ] [MainThread]: Updated version available: 1.3.1
[0m17:40:46.057930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0efce114-de74-4e26-8113-7c8d302f8d4e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105378770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105378320>]}
[0m17:40:46.058148 [info ] [MainThread]: 
[0m17:40:46.058307 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:40:46.060023 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43874776, "process_in_blocks": "0", "process_kernel_time": 0.188352, "process_mem_max_rss": "115376128", "process_out_blocks": "0", "process_user_time": 0.761628}
[0m17:40:46.060351 [debug] [MainThread]: Command `dbt deps` succeeded at 17:40:46.060290 after 0.44 seconds
[0m17:40:46.060538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105287f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105378770>]}
[0m17:40:46.060713 [debug] [MainThread]: Flushing usage events
[0m17:40:46.146850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:47.000442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af2b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cbf20>]}


============================== 17:40:47.002968 | fa45e3d9-965d-4b27-8f30-145f88a832d5 ==============================
[0m17:40:47.002968 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:40:47.003282 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'no_print': 'None', 'empty': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default'}
[0m17:40:47.112729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109891d90>]}
[0m17:40:47.143589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108660a40>]}
[0m17:40:47.144883 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:40:47.222072 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:40:47.287288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m17:40:47.287937 [debug] [MainThread]: Partial parsing: updated file: dashdash_lab://models/sources.yml
[0m17:40:47.288148 [debug] [MainThread]: Partial parsing: updated file: dashdash_lab://models/staging/stg_orders.yml
[0m17:40:47.288320 [debug] [MainThread]: Partial parsing: updated file: dashdash_lab://models/staging/stg_couriers.yml
[0m17:40:47.288492 [debug] [MainThread]: Partial parsing: updated file: dashdash_lab://models/marts/schema.yml
[0m17:40:47.509928 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:40:47.510246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1642f0>]}
[0m17:40:47.595485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a514320>]}
[0m17:40:47.629783 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:40:47.630876 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:40:47.638727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a570650>]}
[0m17:40:47.638960 [info ] [MainThread]: Found 10 models, 9 data tests, 4 sources, 556 macros
[0m17:40:47.639113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bc1a0>]}
[0m17:40:47.640011 [info ] [MainThread]: 
[0m17:40:47.640182 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:40:47.640308 [info ] [MainThread]: 
[0m17:40:47.640525 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:40:47.642222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m17:40:47.669275 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m17:40:47.669540 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m17:40:47.669686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:47.831033 [debug] [ThreadPool]: SQL status: SELECT 101 in 0.161 seconds
[0m17:40:47.831855 [debug] [ThreadPool]: On list_neondb: Close
[0m17:40:47.832684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_netid1234_netid1234)
[0m17:40:47.835226 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:40:47.835399 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: BEGIN
[0m17:40:47.835579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:47.987614 [debug] [ThreadPool]: SQL status: BEGIN in 0.152 seconds
[0m17:40:47.989168 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:40:47.990509 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_netid1234_netid1234"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'netid1234_netid1234'
  
[0m17:40:48.010829 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m17:40:48.014091 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: ROLLBACK
[0m17:40:48.031131 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: Close
[0m17:40:48.042418 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:48.043105 [debug] [MainThread]: On master: BEGIN
[0m17:40:48.043557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:48.213013 [debug] [MainThread]: SQL status: BEGIN in 0.169 seconds
[0m17:40:48.213937 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:48.214749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:40:48.238867 [debug] [MainThread]: SQL status: SELECT 62 in 0.023 seconds
[0m17:40:48.244917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa9ac60>]}
[0m17:40:48.245861 [debug] [MainThread]: On master: ROLLBACK
[0m17:40:48.264769 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:48.265899 [debug] [MainThread]: On master: BEGIN
[0m17:40:48.304352 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m17:40:48.305833 [debug] [MainThread]: On master: COMMIT
[0m17:40:48.307049 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:48.307707 [debug] [MainThread]: On master: COMMIT
[0m17:40:48.325070 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m17:40:48.325926 [debug] [MainThread]: On master: Close
[0m17:40:48.331402 [debug] [Thread-1 (]: Began running node model.dashdash_lab.stg_couriers
[0m17:40:48.331982 [debug] [Thread-2 (]: Began running node model.dashdash_lab.stg_customers
[0m17:40:48.332461 [debug] [Thread-3 (]: Began running node model.dashdash_lab.stg_orders
[0m17:40:48.332906 [debug] [Thread-4 (]: Began running node model.dashdash_lab.stg_restaurants
[0m17:40:48.333568 [info ] [Thread-1 (]: 1 of 10 START sql view model netid1234_netid1234.stg_couriers .................. [RUN]
[0m17:40:48.334348 [info ] [Thread-2 (]: 2 of 10 START sql view model netid1234_netid1234.stg_customers ................. [RUN]
[0m17:40:48.335059 [info ] [Thread-3 (]: 3 of 10 START sql view model netid1234_netid1234.stg_orders .................... [RUN]
[0m17:40:48.335619 [info ] [Thread-4 (]: 4 of 10 START sql view model netid1234_netid1234.stg_restaurants ............... [RUN]
[0m17:40:48.336240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_netid1234_netid1234, now model.dashdash_lab.stg_couriers)
[0m17:40:48.336822 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_customers'
[0m17:40:48.337284 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_orders'
[0m17:40:48.337513 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_restaurants'
[0m17:40:48.337690 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.stg_couriers
[0m17:40:48.337843 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.stg_customers
[0m17:40:48.337987 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.stg_orders
[0m17:40:48.338141 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.stg_restaurants
[0m17:40:48.341366 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.stg_couriers"
[0m17:40:48.342535 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.stg_customers"
[0m17:40:48.344612 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.stg_orders"
[0m17:40:48.345670 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.stg_restaurants"
[0m17:40:48.346183 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.stg_customers
[0m17:40:48.352413 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.stg_couriers
[0m17:40:48.352622 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.stg_orders
[0m17:40:48.360938 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.stg_customers"
[0m17:40:48.362308 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.stg_couriers"
[0m17:40:48.364113 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.stg_orders"
[0m17:40:48.364304 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.stg_restaurants
[0m17:40:48.365674 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.stg_restaurants"
[0m17:40:48.365995 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:40:48.366159 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:40:48.366304 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:40:48.366479 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: BEGIN
[0m17:40:48.366658 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: BEGIN
[0m17:40:48.366824 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:40:48.366974 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: BEGIN
[0m17:40:48.367127 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:40:48.367370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:48.367624 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: BEGIN
[0m17:40:48.367791 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:40:48.368061 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:40:48.532343 [debug] [Thread-2 (]: SQL status: BEGIN in 0.165 seconds
[0m17:40:48.533055 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:40:48.533561 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */

  create view "neondb"."netid1234_netid1234"."stg_customers__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."netid1234"."customers"
  );
[0m17:40:48.551361 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "netid1234.customers" does not exist
LINE 11: from "neondb"."netid1234"."customers"
              ^

[0m17:40:48.552199 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: ROLLBACK
[0m17:40:48.554012 [debug] [Thread-4 (]: SQL status: BEGIN in 0.186 seconds
[0m17:40:48.554796 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:40:48.555496 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */

  create view "neondb"."netid1234_netid1234"."stg_restaurants__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."netid1234"."restaurants"
  );
[0m17:40:48.558348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.191 seconds
[0m17:40:48.559320 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:40:48.559888 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */

  create view "neondb"."netid1234_netid1234"."stg_couriers__dbt_tmp"
    
    
  as (
    

select
  courier_id,
  courier_name,
  lower(vehicle_type) as vehicle_type,
  active_from,
  active_to,
  region
from "neondb"."netid1234"."couriers"
  );
[0m17:40:48.561353 [debug] [Thread-3 (]: SQL status: BEGIN in 0.193 seconds
[0m17:40:48.561845 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:40:48.562492 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */

  create view "neondb"."netid1234_netid1234"."stg_orders__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(nullif(trim(status), '')) as status_norm,
        payment_method,
        
    
        NULLIF(BTRIM(subtotal::text), '')::numeric(10, 2)
    
 as subtotal,
        
    
        NULLIF(BTRIM(delivery_fee::text), '')::numeric(10, 2)
    
 as delivery_fee,
        
    
        NULLIF(BTRIM(tip_amount::text), '')::numeric(10, 2)
    
 as tip_amount,
        
    
        NULLIF(BTRIM(distance_km::text), '')::numeric(6, 2)
    
 as distance_km,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."netid1234"."orders"
),
dedup as (
    select *
    from base
    where rn = 1
),
clean as (
    select
        *,
        case
            when status_norm in ('delivered', 'canceled', 'returned') then status_norm
            when status_norm is null or status_norm = '' then 'unknown'
            else 'unknown'
        end as status_final,
        case
            when pickup_ts is not null and dropoff_ts is not null
                then 
    
        EXTRACT(epoch FROM (dropoff_ts - pickup_ts)) / 60.0
    

            else null
        end as delivery_minutes
    from dedup
)
select
    order_id,
    customer_id,
    restaurant_id,
    courier_id,
    order_ts,
    pickup_ts,
    dropoff_ts,
    status_final as status,
    payment_method,
    subtotal,
    delivery_fee,
    tip_amount,
    distance_km,
    delivery_minutes,
    case
        when status_final = 'delivered' and delivery_minutes <= 45 then 
    TRUE

        else 
    FALSE

    end as on_time_flag
from clean
  );
[0m17:40:48.569448 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: Close
[0m17:40:48.572792 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "netid1234.restaurants" does not exist
LINE 11: from "neondb"."netid1234"."restaurants"
              ^

[0m17:40:48.573337 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: ROLLBACK
[0m17:40:48.577937 [debug] [Thread-2 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:40:48.578398 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "netid1234.couriers" does not exist
LINE 16: from "neondb"."netid1234"."couriers"
              ^

[0m17:40:48.579580 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: ROLLBACK
[0m17:40:48.579945 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab4e7b0>]}
[0m17:40:48.580151 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "netid1234.orders" does not exist
LINE 53:     from "neondb"."netid1234"."orders"
                  ^

[0m17:40:48.580451 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model netid1234_netid1234.stg_customers ........ [[31mERROR[0m in 0.24s]
[0m17:40:48.580703 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: ROLLBACK
[0m17:40:48.580961 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.stg_customers
[0m17:40:48.581235 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql.
[0m17:40:48.581741 [debug] [Thread-2 (]: Began running node model.dashdash_lab.dim_customer
[0m17:40:48.581918 [info ] [Thread-2 (]: 5 of 10 SKIP relation netid1234_netid1234.dim_customer ......................... [[33mSKIP[0m]
[0m17:40:48.582101 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.dim_customer
[0m17:40:48.589521 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: Close
[0m17:40:48.590942 [debug] [Thread-4 (]: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:40:48.591192 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a136ed0>]}
[0m17:40:48.591486 [error] [Thread-4 (]: 4 of 10 ERROR creating sql view model netid1234_netid1234.stg_restaurants ...... [[31mERROR[0m in 0.25s]
[0m17:40:48.591731 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.stg_restaurants
[0m17:40:48.591950 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_restaurants' to be skipped because of status 'error'.  Reason: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql.
[0m17:40:48.592213 [debug] [Thread-2 (]: Began running node model.dashdash_lab.dim_restaurant
[0m17:40:48.592386 [info ] [Thread-2 (]: 6 of 10 SKIP relation netid1234_netid1234.dim_restaurant ....................... [[33mSKIP[0m]
[0m17:40:48.592557 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.dim_restaurant
[0m17:40:48.595265 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: Close
[0m17:40:48.596548 [debug] [Thread-1 (]: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:40:48.596745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a136f30>]}
[0m17:40:48.597006 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model netid1234_netid1234.stg_couriers ......... [[31mERROR[0m in 0.26s]
[0m17:40:48.597232 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.stg_couriers
[0m17:40:48.597424 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_couriers' to be skipped because of status 'error'.  Reason: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql.
[0m17:40:48.597680 [debug] [Thread-4 (]: Began running node model.dashdash_lab.dim_courier
[0m17:40:48.598314 [debug] [Thread-2 (]: Began running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:40:48.598520 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: Close
[0m17:40:48.597864 [info ] [Thread-4 (]: 7 of 10 SKIP relation netid1234_netid1234.dim_courier .......................... [[33mSKIP[0m]
[0m17:40:48.598743 [info ] [Thread-2 (]: 8 of 10 SKIP relation netid1234_netid1234.monitoring_dq_exceptions ............. [[33mSKIP[0m]
[0m17:40:48.598996 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.dim_courier
[0m17:40:48.599684 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:40:48.600475 [debug] [Thread-3 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:40:48.600680 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa45e3d9-965d-4b27-8f30-145f88a832d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1368a0>]}
[0m17:40:48.600948 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model netid1234_netid1234.stg_orders ........... [[31mERROR[0m in 0.26s]
[0m17:40:48.601182 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.stg_orders
[0m17:40:48.601388 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql.
[0m17:40:48.601735 [debug] [Thread-1 (]: Began running node model.dashdash_lab.fct_deliveries
[0m17:40:48.601961 [info ] [Thread-1 (]: 9 of 10 SKIP relation netid1234_netid1234.fct_deliveries ....................... [[33mSKIP[0m]
[0m17:40:48.602131 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.fct_deliveries
[0m17:40:48.602359 [debug] [Thread-2 (]: Began running node model.dashdash_lab.kpi_delivery_overview
[0m17:40:48.602576 [info ] [Thread-2 (]: 10 of 10 SKIP relation netid1234_netid1234.kpi_delivery_overview ............... [[33mSKIP[0m]
[0m17:40:48.602804 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.kpi_delivery_overview
[0m17:40:48.603341 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:48.603498 [debug] [MainThread]: On master: BEGIN
[0m17:40:48.603621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:48.750976 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m17:40:48.751856 [debug] [MainThread]: On master: COMMIT
[0m17:40:48.752503 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:48.753010 [debug] [MainThread]: On master: COMMIT
[0m17:40:48.770052 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m17:40:48.770848 [debug] [MainThread]: On master: Close
[0m17:40:48.772013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:48.772602 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_couriers' was properly closed.
[0m17:40:48.773033 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_customers' was properly closed.
[0m17:40:48.773412 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_orders' was properly closed.
[0m17:40:48.773755 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_restaurants' was properly closed.
[0m17:40:48.774231 [info ] [MainThread]: 
[0m17:40:48.774781 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m17:40:48.776872 [debug] [MainThread]: Command end result
[0m17:40:48.794123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:40:48.794977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:40:48.797553 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/run_results.json
[0m17:40:48.797704 [info ] [MainThread]: 
[0m17:40:48.797863 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m17:40:48.797993 [info ] [MainThread]: 
[0m17:40:48.798149 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m17:40:48.798306 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:40:48.798433 [info ] [MainThread]: 
[0m17:40:48.798571 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_customers.sql
[0m17:40:48.798690 [info ] [MainThread]: 
[0m17:40:48.798831 [error] [MainThread]: [31mFailure in model stg_restaurants (models/staging/stg_restaurants.sql)[0m
[0m17:40:48.798976 [error] [MainThread]:   Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:40:48.799093 [info ] [MainThread]: 
[0m17:40:48.799230 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:40:48.799345 [info ] [MainThread]: 
[0m17:40:48.799482 [error] [MainThread]: [31mFailure in model stg_couriers (models/staging/stg_couriers.sql)[0m
[0m17:40:48.799628 [error] [MainThread]:   Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:40:48.799743 [info ] [MainThread]: 
[0m17:40:48.799876 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_couriers.sql
[0m17:40:48.799988 [info ] [MainThread]: 
[0m17:40:48.800123 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m17:40:48.800267 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:40:48.800387 [info ] [MainThread]: 
[0m17:40:48.800522 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.sql
[0m17:40:48.800639 [info ] [MainThread]: 
[0m17:40:48.800777 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=6 NO-OP=0 TOTAL=10
[0m17:40:48.801007 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:40:48.802488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.83672, "process_in_blocks": "0", "process_kernel_time": 0.20387, "process_mem_max_rss": "144818176", "process_out_blocks": "0", "process_user_time": 1.359076}
[0m17:40:48.802695 [debug] [MainThread]: Command `dbt run` failed at 17:40:48.802659 after 1.84 seconds
[0m17:40:48.802869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cbef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e62a0>]}
[0m17:40:48.803027 [debug] [MainThread]: Flushing usage events
[0m17:40:48.894678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:02.108986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7d1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a55a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a55a0f0>]}


============================== 17:42:02.111708 | aacbd1c8-2be0-4ec6-ab90-f26ecf4b49ae ==============================
[0m17:42:02.111708 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:42:02.112012 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'write_json': 'True', 'static_parser': 'True', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'quiet': 'False', 'empty': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'indirect_selection': 'eager'}
[0m17:42:02.188054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aacbd1c8-2be0-4ec6-ab90-f26ecf4b49ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f2420>]}
[0m17:42:02.212054 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-pj7k0wgm'
[0m17:42:02.212327 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:42:02.301577 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:42:02.302545 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:42:02.340562 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:42:02.343039 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:42:02.478496 [info ] [MainThread]: Installed from version 1.1.1
[0m17:42:02.478771 [info ] [MainThread]: Updated version available: 1.3.1
[0m17:42:02.478965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aacbd1c8-2be0-4ec6-ab90-f26ecf4b49ae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6ab6e0>]}
[0m17:42:02.479167 [info ] [MainThread]: 
[0m17:42:02.479341 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:42:02.480957 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40834546, "process_in_blocks": "0", "process_kernel_time": 0.167835, "process_mem_max_rss": "115851264", "process_out_blocks": "0", "process_user_time": 0.749776}
[0m17:42:02.481224 [debug] [MainThread]: Command `dbt deps` succeeded at 17:42:02.481183 after 0.41 seconds
[0m17:42:02.481388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7e4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b71ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5363f0>]}
[0m17:42:02.481548 [debug] [MainThread]: Flushing usage events
[0m17:42:02.560418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:03.451611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b6e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922fe00>]}


============================== 17:42:03.453999 | 91d82186-e85d-4739-a36e-46ddc3d2cb05 ==============================
[0m17:42:03.453999 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:42:03.454320 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'partial_parse': 'True'}
[0m17:42:03.559656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957a8a0>]}
[0m17:42:03.590283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857a720>]}
[0m17:42:03.591021 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:42:03.642383 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:42:03.683193 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:42:03.683499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109663f50>]}
[0m17:42:04.250619 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:42:04.250965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ff9880>]}
[0m17:42:04.315595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ffbb00>]}
[0m17:42:04.349848 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:42:04.351032 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:42:04.359112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2f1be0>]}
[0m17:42:04.359358 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:42:04.359522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34e0c0>]}
[0m17:42:04.360467 [info ] [MainThread]: 
[0m17:42:04.360633 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:42:04.360764 [info ] [MainThread]: 
[0m17:42:04.360994 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:42:04.362904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m17:42:04.388341 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m17:42:04.388586 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m17:42:04.388732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:04.557777 [debug] [ThreadPool]: SQL status: SELECT 101 in 0.169 seconds
[0m17:42:04.558586 [debug] [ThreadPool]: On list_neondb: Close
[0m17:42:04.559016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now create_neondb_public_public)
[0m17:42:04.559213 [debug] [ThreadPool]: Creating schema "database: "neondb"
schema: "public_public"
"
[0m17:42:04.561478 [debug] [ThreadPool]: Using postgres connection "create_neondb_public_public"
[0m17:42:04.561638 [debug] [ThreadPool]: On create_neondb_public_public: BEGIN
[0m17:42:04.561759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:04.730749 [debug] [ThreadPool]: SQL status: BEGIN in 0.169 seconds
[0m17:42:04.731593 [debug] [ThreadPool]: Using postgres connection "create_neondb_public_public"
[0m17:42:04.732236 [debug] [ThreadPool]: On create_neondb_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "create_neondb_public_public"} */
create schema if not exists "public_public"
[0m17:42:04.750011 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.017 seconds
[0m17:42:04.753164 [debug] [ThreadPool]: On create_neondb_public_public: COMMIT
[0m17:42:04.753821 [debug] [ThreadPool]: Using postgres connection "create_neondb_public_public"
[0m17:42:04.754345 [debug] [ThreadPool]: On create_neondb_public_public: COMMIT
[0m17:42:04.777148 [debug] [ThreadPool]: SQL status: COMMIT in 0.022 seconds
[0m17:42:04.778533 [debug] [ThreadPool]: On create_neondb_public_public: Close
[0m17:42:04.782035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_neondb_public_public, now list_neondb_public_public)
[0m17:42:04.792268 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:42:04.792716 [debug] [ThreadPool]: On list_neondb_public_public: BEGIN
[0m17:42:04.792883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:42:04.981653 [debug] [ThreadPool]: SQL status: BEGIN in 0.189 seconds
[0m17:42:04.982555 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:42:04.983368 [debug] [ThreadPool]: On list_neondb_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_public_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m17:42:05.016785 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.033 seconds
[0m17:42:05.020245 [debug] [ThreadPool]: On list_neondb_public_public: ROLLBACK
[0m17:42:05.043583 [debug] [ThreadPool]: On list_neondb_public_public: Close
[0m17:42:05.084462 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:05.084745 [debug] [MainThread]: On master: BEGIN
[0m17:42:05.084888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:42:05.234954 [debug] [MainThread]: SQL status: BEGIN in 0.150 seconds
[0m17:42:05.235567 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:05.236057 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:42:05.259001 [debug] [MainThread]: SQL status: SELECT 62 in 0.022 seconds
[0m17:42:05.261798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075518b0>]}
[0m17:42:05.262383 [debug] [MainThread]: On master: ROLLBACK
[0m17:42:05.278938 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:05.279445 [debug] [MainThread]: On master: BEGIN
[0m17:42:05.313118 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m17:42:05.313818 [debug] [MainThread]: On master: COMMIT
[0m17:42:05.314426 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:05.314970 [debug] [MainThread]: On master: COMMIT
[0m17:42:05.331930 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:42:05.332967 [debug] [MainThread]: On master: Close
[0m17:42:05.339090 [debug] [Thread-1 (]: Began running node model.dashdash_lab.stg_couriers
[0m17:42:05.339666 [debug] [Thread-2 (]: Began running node model.dashdash_lab.stg_customers
[0m17:42:05.340122 [debug] [Thread-3 (]: Began running node model.dashdash_lab.stg_orders
[0m17:42:05.340564 [debug] [Thread-4 (]: Began running node model.dashdash_lab.stg_restaurants
[0m17:42:05.341272 [info ] [Thread-1 (]: 1 of 10 START sql view model public_public.stg_couriers ........................ [RUN]
[0m17:42:05.341910 [info ] [Thread-2 (]: 2 of 10 START sql view model public_public.stg_customers ....................... [RUN]
[0m17:42:05.342505 [info ] [Thread-3 (]: 3 of 10 START sql view model public_public.stg_orders .......................... [RUN]
[0m17:42:05.343257 [info ] [Thread-4 (]: 4 of 10 START sql view model public_public.stg_restaurants ..................... [RUN]
[0m17:42:05.343862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public_public, now model.dashdash_lab.stg_couriers)
[0m17:42:05.344415 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_customers'
[0m17:42:05.344940 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_orders'
[0m17:42:05.345423 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_restaurants'
[0m17:42:05.345635 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.stg_couriers
[0m17:42:05.345812 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.stg_customers
[0m17:42:05.345970 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.stg_orders
[0m17:42:05.346123 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.stg_restaurants
[0m17:42:05.349445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.stg_couriers"
[0m17:42:05.350598 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.stg_customers"
[0m17:42:05.352620 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.stg_orders"
[0m17:42:05.353669 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.stg_restaurants"
[0m17:42:05.354170 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.stg_couriers
[0m17:42:05.366655 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.stg_restaurants
[0m17:42:05.366875 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.stg_customers
[0m17:42:05.367022 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.stg_orders
[0m17:42:05.368743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.stg_couriers"
[0m17:42:05.370044 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.stg_restaurants"
[0m17:42:05.371765 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.stg_customers"
[0m17:42:05.372937 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.stg_orders"
[0m17:42:05.373566 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:42:05.373764 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:42:05.373914 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:42:05.374075 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:42:05.374223 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: BEGIN
[0m17:42:05.374381 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: BEGIN
[0m17:42:05.374527 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: BEGIN
[0m17:42:05.374670 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: BEGIN
[0m17:42:05.374810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:05.374960 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:42:05.375097 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:42:05.375233 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:42:05.556104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.181 seconds
[0m17:42:05.557978 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:42:05.558840 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */

  create view "neondb"."public_public"."stg_couriers__dbt_tmp"
    
    
  as (
    

select
  courier_id,
  courier_name,
  lower(vehicle_type) as vehicle_type,
  active_from,
  active_to,
  region
from "neondb"."public"."couriers"
  );
[0m17:42:05.566895 [debug] [Thread-4 (]: SQL status: BEGIN in 0.192 seconds
[0m17:42:05.567440 [debug] [Thread-2 (]: SQL status: BEGIN in 0.192 seconds
[0m17:42:05.567958 [debug] [Thread-3 (]: SQL status: BEGIN in 0.193 seconds
[0m17:42:05.568531 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:42:05.569047 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:42:05.569531 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:42:05.570081 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */

  create view "neondb"."public_public"."stg_restaurants__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."public"."restaurants"
  );
[0m17:42:05.570742 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */

  create view "neondb"."public_public"."stg_customers__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."public"."customers"
  );
[0m17:42:05.571602 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */

  create view "neondb"."public_public"."stg_orders__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(nullif(trim(status), '')) as status_norm,
        payment_method,
        
    
        NULLIF(BTRIM(subtotal::text), '')::numeric(10, 2)
    
 as subtotal,
        
    
        NULLIF(BTRIM(delivery_fee::text), '')::numeric(10, 2)
    
 as delivery_fee,
        
    
        NULLIF(BTRIM(tip_amount::text), '')::numeric(10, 2)
    
 as tip_amount,
        
    
        NULLIF(BTRIM(distance_km::text), '')::numeric(6, 2)
    
 as distance_km,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."public"."orders"
),
dedup as (
    select *
    from base
    where rn = 1
),
clean as (
    select
        *,
        case
            when status_norm in ('delivered', 'canceled', 'returned') then status_norm
            when status_norm is null or status_norm = '' then 'unknown'
            else 'unknown'
        end as status_final,
        case
            when pickup_ts is not null and dropoff_ts is not null
                then 
    
        EXTRACT(epoch FROM (dropoff_ts - pickup_ts)) / 60.0
    

            else null
        end as delivery_minutes
    from dedup
)
select
    order_id,
    customer_id,
    restaurant_id,
    courier_id,
    order_ts,
    pickup_ts,
    dropoff_ts,
    status_final as status,
    payment_method,
    subtotal,
    delivery_fee,
    tip_amount,
    distance_km,
    delivery_minutes,
    case
        when status_final = 'delivered' and delivery_minutes <= 45 then 
    TRUE

        else 
    FALSE

    end as on_time_flag
from clean
  );
[0m17:42:05.591020 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m17:42:05.598522 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:42:05.598778 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */
alter table "neondb"."public_public"."stg_couriers__dbt_tmp" rename to "stg_couriers"
[0m17:42:05.610725 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.038 seconds
[0m17:42:05.611174 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m17:42:05.611598 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m17:42:05.615035 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:42:05.615438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:42:05.616940 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:42:05.618100 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:42:05.618273 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */
alter table "neondb"."public_public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:42:05.624016 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: COMMIT
[0m17:42:05.624207 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */
alter table "neondb"."public_public"."stg_restaurants__dbt_tmp" rename to "stg_restaurants"
[0m17:42:05.624374 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */
alter table "neondb"."public_public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:42:05.624568 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:42:05.624770 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: COMMIT
[0m17:42:05.644996 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m17:42:05.645156 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m17:42:05.645335 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m17:42:05.645871 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: COMMIT
[0m17:42:05.646021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m17:42:05.646480 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: COMMIT
[0m17:42:05.646919 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: COMMIT
[0m17:42:05.647078 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:42:05.649595 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."stg_couriers__dbt_backup"
[0m17:42:05.649767 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:42:05.649922 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:42:05.650069 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: COMMIT
[0m17:42:05.651978 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:42:05.652152 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: COMMIT
[0m17:42:05.652301 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: COMMIT
[0m17:42:05.652480 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */
drop view if exists "neondb"."public_public"."stg_couriers__dbt_backup" cascade
[0m17:42:05.679568 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m17:42:05.680596 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: Close
[0m17:42:05.681162 [debug] [Thread-3 (]: SQL status: COMMIT in 0.028 seconds
[0m17:42:05.681526 [debug] [Thread-4 (]: SQL status: COMMIT in 0.029 seconds
[0m17:42:05.681724 [debug] [Thread-2 (]: SQL status: COMMIT in 0.029 seconds
[0m17:42:05.682703 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."stg_orders__dbt_backup"
[0m17:42:05.684444 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."stg_restaurants__dbt_backup"
[0m17:42:05.685339 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_public"."stg_customers__dbt_backup"
[0m17:42:05.685591 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:42:05.685863 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:42:05.686071 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:42:05.686248 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */
drop view if exists "neondb"."public_public"."stg_orders__dbt_backup" cascade
[0m17:42:05.686406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f13e30>]}
[0m17:42:05.686573 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */
drop view if exists "neondb"."public_public"."stg_restaurants__dbt_backup" cascade
[0m17:42:05.686740 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */
drop view if exists "neondb"."public_public"."stg_customers__dbt_backup" cascade
[0m17:42:05.687048 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public_public.stg_couriers ................... [[32mCREATE VIEW[0m in 0.34s]
[0m17:42:05.687356 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.stg_couriers
[0m17:42:05.687626 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_courier
[0m17:42:05.687841 [info ] [Thread-1 (]: 5 of 10 START sql view model public_public.dim_courier ......................... [RUN]
[0m17:42:05.688036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_couriers, now model.dashdash_lab.dim_courier)
[0m17:42:05.688210 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.dim_courier
[0m17:42:05.689472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.dim_courier"
[0m17:42:05.689885 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.dim_courier
[0m17:42:05.691198 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.dim_courier"
[0m17:42:05.691796 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:42:05.691952 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: BEGIN
[0m17:42:05.692093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:05.709461 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.023 seconds
[0m17:42:05.709642 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.022 seconds
[0m17:42:05.709813 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.023 seconds
[0m17:42:05.710407 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: Close
[0m17:42:05.710897 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: Close
[0m17:42:05.711366 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: Close
[0m17:42:05.711718 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8abb90>]}
[0m17:42:05.711925 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10925d730>]}
[0m17:42:05.712115 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a890b90>]}
[0m17:42:05.712834 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public_public.stg_orders ..................... [[32mCREATE VIEW[0m in 0.37s]
[0m17:42:05.713086 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public_public.stg_restaurants ................ [[32mCREATE VIEW[0m in 0.37s]
[0m17:42:05.713326 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public_public.stg_customers .................. [[32mCREATE VIEW[0m in 0.37s]
[0m17:42:05.713560 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.stg_orders
[0m17:42:05.713769 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.stg_restaurants
[0m17:42:05.713964 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.stg_customers
[0m17:42:05.714291 [debug] [Thread-2 (]: Began running node model.dashdash_lab.dim_restaurant
[0m17:42:05.714450 [debug] [Thread-3 (]: Began running node model.dashdash_lab.fct_deliveries
[0m17:42:05.714682 [info ] [Thread-2 (]: 6 of 10 START sql view model public_public.dim_restaurant ...................... [RUN]
[0m17:42:05.714877 [debug] [Thread-4 (]: Began running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:42:05.715053 [info ] [Thread-3 (]: 7 of 10 START sql view model public_public.fct_deliveries ...................... [RUN]
[0m17:42:05.715250 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_customers, now model.dashdash_lab.dim_restaurant)
[0m17:42:05.715458 [info ] [Thread-4 (]: 8 of 10 START sql view model public_public.monitoring_dq_exceptions ............ [RUN]
[0m17:42:05.715637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_orders, now model.dashdash_lab.fct_deliveries)
[0m17:42:05.715792 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.dim_restaurant
[0m17:42:05.715943 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_restaurants, now model.dashdash_lab.monitoring_dq_exceptions)
[0m17:42:05.716095 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.fct_deliveries
[0m17:42:05.717386 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.dim_restaurant"
[0m17:42:05.717563 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.monitoring_dq_exceptions
[0m17:42:05.718837 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.fct_deliveries"
[0m17:42:05.720759 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:42:05.721204 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.dim_restaurant
[0m17:42:05.721359 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.fct_deliveries
[0m17:42:05.722543 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.dim_restaurant"
[0m17:42:05.722712 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.monitoring_dq_exceptions
[0m17:42:05.723929 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.fct_deliveries"
[0m17:42:05.725922 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:42:05.726161 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:42:05.726365 [debug] [Thread-2 (]: On model.dashdash_lab.dim_restaurant: BEGIN
[0m17:42:05.726523 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:42:05.726703 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:42:05.727014 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:42:05.727191 [debug] [Thread-3 (]: On model.dashdash_lab.fct_deliveries: BEGIN
[0m17:42:05.727373 [debug] [Thread-4 (]: On model.dashdash_lab.monitoring_dq_exceptions: BEGIN
[0m17:42:05.727535 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:42:05.727688 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:42:05.902756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.210 seconds
[0m17:42:05.903717 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:42:05.904425 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */

  create view "neondb"."public_public"."dim_courier__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_couriers"
  );
[0m17:42:05.920683 [debug] [Thread-3 (]: SQL status: BEGIN in 0.193 seconds
[0m17:42:05.921371 [debug] [Thread-4 (]: SQL status: BEGIN in 0.194 seconds
[0m17:42:05.922068 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:42:05.922974 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:42:05.923766 [debug] [Thread-3 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */

  create view "neondb"."public_public"."fct_deliveries__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_orders" as o
where o.status = 'delivered'
  and o.restaurant_id in (select restaurant_id from "neondb"."public_public"."stg_restaurants")
  and (
        o.courier_id is null
        or o.courier_id in (select courier_id from "neondb"."public_public"."stg_couriers")
      )
  );
[0m17:42:05.924613 [debug] [Thread-4 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */

  create view "neondb"."public_public"."monitoring_dq_exceptions__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(trim(coalesce(status, ''))) as status_norm,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."public"."orders"
),
dupes as (
    select order_id, 'duplicate_order' as reason
    from base
    where rn > 1
),
bad_rest_fk as (
    select o.order_id, 'bad_fk_restaurant' as reason
    from "neondb"."public"."orders" as o
    left join "neondb"."public_public"."stg_restaurants" as r on o.restaurant_id = r.restaurant_id
    where r.restaurant_id is null
),
bad_cour_fk as (
    select o.order_id, 'bad_fk_courier' as reason
    from "neondb"."public"."orders" as o
    left join "neondb"."public_public"."stg_couriers" as c on o.courier_id = c.courier_id
    where o.courier_id is not null and c.courier_id is null
),
unknown_status as (
    select order_id, 'status_unknown' as reason
    from base
    where status_norm is null or status_norm not in ('delivered', 'canceled', 'returned')
)
select distinct order_id, reason
from (
    select * from dupes
    union all
    select * from bad_rest_fk
    union all
    select * from bad_cour_fk
    union all
    select * from unknown_status
) as unioned
order by order_id, reason
  );
[0m17:42:05.926771 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m17:42:05.927372 [debug] [Thread-2 (]: SQL status: BEGIN in 0.201 seconds
[0m17:42:05.932499 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:42:05.933035 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:42:05.933693 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */
alter table "neondb"."public_public"."dim_courier__dbt_tmp" rename to "dim_courier"
[0m17:42:05.934254 [debug] [Thread-2 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */

  create view "neondb"."public_public"."dim_restaurant__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_restaurants"
  );
[0m17:42:05.949979 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m17:42:05.954432 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:42:05.954874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m17:42:05.955372 [debug] [Thread-3 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */
alter table "neondb"."public_public"."fct_deliveries__dbt_tmp" rename to "fct_deliveries"
[0m17:42:05.956720 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: COMMIT
[0m17:42:05.957134 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m17:42:05.957399 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m17:42:05.957676 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:42:05.959023 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:42:05.960144 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:42:05.960318 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: COMMIT
[0m17:42:05.960479 [debug] [Thread-4 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */
alter table "neondb"."public_public"."monitoring_dq_exceptions__dbt_tmp" rename to "monitoring_dq_exceptions"
[0m17:42:05.960643 [debug] [Thread-2 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */
alter table "neondb"."public_public"."dim_restaurant__dbt_tmp" rename to "dim_restaurant"
[0m17:42:05.976310 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m17:42:05.977942 [debug] [Thread-3 (]: On model.dashdash_lab.fct_deliveries: COMMIT
[0m17:42:05.978408 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:42:05.978834 [debug] [Thread-3 (]: On model.dashdash_lab.fct_deliveries: COMMIT
[0m17:42:05.982473 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m17:42:05.982871 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m17:42:05.984179 [debug] [Thread-4 (]: On model.dashdash_lab.monitoring_dq_exceptions: COMMIT
[0m17:42:05.985157 [debug] [Thread-2 (]: On model.dashdash_lab.dim_restaurant: COMMIT
[0m17:42:05.985368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m17:42:05.985541 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:42:05.985697 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:42:05.986597 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."dim_courier__dbt_backup"
[0m17:42:05.986764 [debug] [Thread-4 (]: On model.dashdash_lab.monitoring_dq_exceptions: COMMIT
[0m17:42:05.986920 [debug] [Thread-2 (]: On model.dashdash_lab.dim_restaurant: COMMIT
[0m17:42:05.987131 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:42:05.987350 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */
drop view if exists "neondb"."public_public"."dim_courier__dbt_backup" cascade
[0m17:42:05.995830 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m17:42:05.996770 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."fct_deliveries__dbt_backup"
[0m17:42:05.996990 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:42:05.997149 [debug] [Thread-3 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */
drop view if exists "neondb"."public_public"."fct_deliveries__dbt_backup" cascade
[0m17:42:06.006906 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m17:42:06.007325 [debug] [Thread-4 (]: SQL status: COMMIT in 0.020 seconds
[0m17:42:06.007708 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.020 seconds
[0m17:42:06.010489 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_public"."dim_restaurant__dbt_backup"
[0m17:42:06.011555 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."monitoring_dq_exceptions__dbt_backup"
[0m17:42:06.012120 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: Close
[0m17:42:06.012357 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:42:06.012601 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:42:06.012791 [debug] [Thread-2 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */
drop view if exists "neondb"."public_public"."dim_restaurant__dbt_backup" cascade
[0m17:42:06.013032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35d1f0>]}
[0m17:42:06.013201 [debug] [Thread-4 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */
drop view if exists "neondb"."public_public"."monitoring_dq_exceptions__dbt_backup" cascade
[0m17:42:06.013508 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public_public.dim_courier .................... [[32mCREATE VIEW[0m in 0.32s]
[0m17:42:06.013775 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_courier
[0m17:42:06.013948 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_customer
[0m17:42:06.014174 [info ] [Thread-1 (]: 9 of 10 START sql view model public_public.dim_customer ........................ [RUN]
[0m17:42:06.014366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.dim_courier, now model.dashdash_lab.dim_customer)
[0m17:42:06.014524 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.dim_customer
[0m17:42:06.016524 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.dim_customer"
[0m17:42:06.016695 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.019 seconds
[0m17:42:06.017320 [debug] [Thread-3 (]: On model.dashdash_lab.fct_deliveries: Close
[0m17:42:06.017594 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.dim_customer
[0m17:42:06.017796 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e718b0>]}
[0m17:42:06.019158 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.dim_customer"
[0m17:42:06.019428 [info ] [Thread-3 (]: 7 of 10 OK created sql view model public_public.fct_deliveries ................. [[32mCREATE VIEW[0m in 0.30s]
[0m17:42:06.019704 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.fct_deliveries
[0m17:42:06.019953 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:42:06.020108 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: BEGIN
[0m17:42:06.020264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:06.020468 [debug] [Thread-3 (]: Began running node model.dashdash_lab.kpi_delivery_overview
[0m17:42:06.020668 [info ] [Thread-3 (]: 10 of 10 START sql view model public_public.kpi_delivery_overview .............. [RUN]
[0m17:42:06.020858 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.fct_deliveries, now model.dashdash_lab.kpi_delivery_overview)
[0m17:42:06.021016 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.kpi_delivery_overview
[0m17:42:06.022617 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.kpi_delivery_overview"
[0m17:42:06.023009 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.kpi_delivery_overview
[0m17:42:06.024411 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.kpi_delivery_overview"
[0m17:42:06.024764 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:42:06.024914 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: BEGIN
[0m17:42:06.025051 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:42:06.047508 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.034 seconds
[0m17:42:06.047718 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.034 seconds
[0m17:42:06.048492 [debug] [Thread-4 (]: On model.dashdash_lab.monitoring_dq_exceptions: Close
[0m17:42:06.048972 [debug] [Thread-2 (]: On model.dashdash_lab.dim_restaurant: Close
[0m17:42:06.049348 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a081c10>]}
[0m17:42:06.049552 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e3ef0>]}
[0m17:42:06.049833 [info ] [Thread-4 (]: 8 of 10 OK created sql view model public_public.monitoring_dq_exceptions ....... [[32mCREATE VIEW[0m in 0.33s]
[0m17:42:06.050081 [info ] [Thread-2 (]: 6 of 10 OK created sql view model public_public.dim_restaurant ................. [[32mCREATE VIEW[0m in 0.33s]
[0m17:42:06.050321 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:42:06.050519 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.dim_restaurant
[0m17:42:06.217990 [debug] [Thread-3 (]: SQL status: BEGIN in 0.193 seconds
[0m17:42:06.218867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.198 seconds
[0m17:42:06.219750 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:42:06.220577 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:42:06.221435 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */

  create view "neondb"."public_public"."kpi_delivery_overview__dbt_tmp"
    
    
  as (
    

with d as (
    select *
    from "neondb"."public_public"."fct_deliveries"
)
select
    
    
        AVG(CASE WHEN on_time_flag THEN 1 ELSE 0 END)::numeric(5, 4)
    
 as on_time_rate,
    
    
        AVG(delivery_minutes)::numeric(6, 2)
    
 as avg_delivery_minutes,
    (
        select 
    
        (COUNT(*) FILTER (WHERE status IN ('canceled', 'returned'))::numeric / NULLIF(COUNT(*), 0))
    

        from "neondb"."public_public"."stg_orders"
    ) as cancel_return_rate
from d
  );
[0m17:42:06.222217 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */

  create view "neondb"."public_public"."dim_customer__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_customers"
  );
[0m17:42:06.242905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:42:06.246092 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:42:06.246357 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */
alter table "neondb"."public_public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:42:06.246716 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m17:42:06.248163 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:42:06.248356 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */
alter table "neondb"."public_public"."kpi_delivery_overview__dbt_tmp" rename to "kpi_delivery_overview"
[0m17:42:06.273493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m17:42:06.274034 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m17:42:06.275628 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: COMMIT
[0m17:42:06.276991 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: COMMIT
[0m17:42:06.277480 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:42:06.277919 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:42:06.278352 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: COMMIT
[0m17:42:06.278706 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: COMMIT
[0m17:42:06.297208 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m17:42:06.297721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m17:42:06.300421 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."kpi_delivery_overview__dbt_backup"
[0m17:42:06.301657 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."dim_customer__dbt_backup"
[0m17:42:06.301909 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:42:06.302124 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:42:06.302283 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */
drop view if exists "neondb"."public_public"."kpi_delivery_overview__dbt_backup" cascade
[0m17:42:06.302440 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */
drop view if exists "neondb"."public_public"."dim_customer__dbt_backup" cascade
[0m17:42:06.336785 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.034 seconds
[0m17:42:06.337336 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.035 seconds
[0m17:42:06.339187 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: Close
[0m17:42:06.340745 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: Close
[0m17:42:06.341726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104958cb0>]}
[0m17:42:06.342204 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91d82186-e85d-4739-a36e-46ddc3d2cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34edb0>]}
[0m17:42:06.342896 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public_public.dim_customer ................... [[32mCREATE VIEW[0m in 0.33s]
[0m17:42:06.343464 [info ] [Thread-3 (]: 10 of 10 OK created sql view model public_public.kpi_delivery_overview ......... [[32mCREATE VIEW[0m in 0.32s]
[0m17:42:06.343817 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_customer
[0m17:42:06.344049 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.kpi_delivery_overview
[0m17:42:06.344683 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:06.344836 [debug] [MainThread]: On master: BEGIN
[0m17:42:06.344960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:42:06.539319 [debug] [MainThread]: SQL status: BEGIN in 0.194 seconds
[0m17:42:06.540446 [debug] [MainThread]: On master: COMMIT
[0m17:42:06.541120 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:06.541678 [debug] [MainThread]: On master: COMMIT
[0m17:42:06.566872 [debug] [MainThread]: SQL status: COMMIT in 0.024 seconds
[0m17:42:06.567889 [debug] [MainThread]: On master: Close
[0m17:42:06.569393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:06.570161 [debug] [MainThread]: Connection 'model.dashdash_lab.dim_customer' was properly closed.
[0m17:42:06.570668 [debug] [MainThread]: Connection 'model.dashdash_lab.dim_restaurant' was properly closed.
[0m17:42:06.571155 [debug] [MainThread]: Connection 'model.dashdash_lab.kpi_delivery_overview' was properly closed.
[0m17:42:06.571654 [debug] [MainThread]: Connection 'model.dashdash_lab.monitoring_dq_exceptions' was properly closed.
[0m17:42:06.572307 [info ] [MainThread]: 
[0m17:42:06.572888 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m17:42:06.575744 [debug] [MainThread]: Command end result
[0m17:42:06.594223 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:42:06.595051 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:42:06.597594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/run_results.json
[0m17:42:06.597749 [info ] [MainThread]: 
[0m17:42:06.597919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:42:06.598062 [info ] [MainThread]: 
[0m17:42:06.598215 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m17:42:06.598469 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:42:06.599962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1812425, "process_in_blocks": "0", "process_kernel_time": 0.218492, "process_mem_max_rss": "146325504", "process_out_blocks": "0", "process_user_time": 1.874462}
[0m17:42:06.600198 [debug] [MainThread]: Command `dbt run` succeeded at 17:42:06.600163 after 3.18 seconds
[0m17:42:06.600369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e80b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd04a0>]}
[0m17:42:06.600540 [debug] [MainThread]: Flushing usage events
[0m17:42:06.726709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:07.528864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ef1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106380b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106382240>]}


============================== 17:42:07.530905 | 7c2f23fc-bd9d-44c6-8080-6e05255b0ba8 ==============================
[0m17:42:07.530905 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:42:07.531207 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'version_check': 'True', 'invocation_command': 'dbt test --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'empty': 'None', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'fail_fast': 'False', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles'}
[0m17:42:07.627933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c2f23fc-bd9d-44c6-8080-6e05255b0ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107617740>]}
[0m17:42:07.658342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c2f23fc-bd9d-44c6-8080-6e05255b0ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069efe00>]}
[0m17:42:07.658744 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:42:07.704971 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:42:07.756985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:42:07.757238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:42:07.775921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c2f23fc-bd9d-44c6-8080-6e05255b0ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107747710>]}
[0m17:42:07.811725 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:42:07.812574 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:42:07.823358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c2f23fc-bd9d-44c6-8080-6e05255b0ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c2ed20>]}
[0m17:42:07.823591 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:42:07.823763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c2f23fc-bd9d-44c6-8080-6e05255b0ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107744230>]}
[0m17:42:07.824749 [info ] [MainThread]: 
[0m17:42:07.824917 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:42:07.825042 [info ] [MainThread]: 
[0m17:42:07.825261 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:42:07.826987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_public'
[0m17:42:07.846540 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:42:07.846744 [debug] [ThreadPool]: On list_neondb_public_public: BEGIN
[0m17:42:07.846878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:08.097009 [debug] [ThreadPool]: SQL status: BEGIN in 0.250 seconds
[0m17:42:08.097915 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:42:08.098607 [debug] [ThreadPool]: On list_neondb_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_public_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m17:42:08.121792 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.022 seconds
[0m17:42:08.124752 [debug] [ThreadPool]: On list_neondb_public_public: ROLLBACK
[0m17:42:08.141506 [debug] [ThreadPool]: On list_neondb_public_public: Close
[0m17:42:08.153782 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:08.154429 [debug] [MainThread]: On master: BEGIN
[0m17:42:08.154874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:42:08.350102 [debug] [MainThread]: SQL status: BEGIN in 0.195 seconds
[0m17:42:08.351699 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:08.353018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:42:08.375380 [debug] [MainThread]: SQL status: SELECT 77 in 0.021 seconds
[0m17:42:08.384445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c2f23fc-bd9d-44c6-8080-6e05255b0ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077456d0>]}
[0m17:42:08.385389 [debug] [MainThread]: On master: ROLLBACK
[0m17:42:08.403568 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:08.404239 [debug] [MainThread]: On master: BEGIN
[0m17:42:08.445552 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m17:42:08.446886 [debug] [MainThread]: On master: COMMIT
[0m17:42:08.447933 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:08.448480 [debug] [MainThread]: On master: COMMIT
[0m17:42:08.467115 [debug] [MainThread]: SQL status: COMMIT in 0.018 seconds
[0m17:42:08.468003 [debug] [MainThread]: On master: Close
[0m17:42:08.473156 [debug] [Thread-1 (]: Began running node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:42:08.473716 [debug] [Thread-2 (]: Began running node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:42:08.474204 [debug] [Thread-3 (]: Began running node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:42:08.474698 [debug] [Thread-4 (]: Began running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:42:08.475175 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_dim_courier_vehicle_type__bike__scooter__car  [RUN]
[0m17:42:08.475767 [info ] [Thread-2 (]: 2 of 13 START test accepted_values_stg_couriers_vehicle_type__bike__scooter__car  [RUN]
[0m17:42:08.476248 [info ] [Thread-3 (]: 3 of 13 START test accepted_values_stg_orders_status__delivered__canceled__returned__unknown  [RUN]
[0m17:42:08.476785 [info ] [Thread-4 (]: 4 of 13 START test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0  [RUN]
[0m17:42:08.477459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public_public, now test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3)
[0m17:42:08.477857 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37'
[0m17:42:08.478088 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e'
[0m17:42:08.478285 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486'
[0m17:42:08.478463 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:42:08.478620 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:42:08.478770 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:42:08.478921 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:42:08.485862 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:42:08.487361 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:42:08.513472 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:42:08.517641 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:42:08.518382 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:42:08.518566 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:42:08.518755 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:42:08.525742 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:42:08.525965 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:42:08.526971 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:42:08.527944 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:42:08.528875 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:42:08.529235 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:42:08.529437 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: BEGIN
[0m17:42:08.529657 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:42:08.529840 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:42:08.530021 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:42:08.530205 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:42:08.530354 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: BEGIN
[0m17:42:08.530585 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: BEGIN
[0m17:42:08.530743 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: BEGIN
[0m17:42:08.530894 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:42:08.531042 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:42:08.531193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:08.675383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m17:42:08.675638 [debug] [Thread-2 (]: SQL status: BEGIN in 0.145 seconds
[0m17:42:08.675879 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:42:08.676056 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:42:08.676239 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vehicle_type as value_field,
        count(*) as n_records

    from "neondb"."public_public"."dim_courier"
    group by vehicle_type

)

select *
from all_values
where value_field not in (
    'bike','scooter','car'
)



  
  
      
    ) dbt_internal_test
[0m17:42:08.676440 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vehicle_type as value_field,
        count(*) as n_records

    from "neondb"."public_public"."stg_couriers"
    group by vehicle_type

)

select *
from all_values
where value_field not in (
    'bike','scooter','car'
)



  
  
      
    ) dbt_internal_test
[0m17:42:08.677115 [debug] [Thread-4 (]: SQL status: BEGIN in 0.146 seconds
[0m17:42:08.677282 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:42:08.677454 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "neondb"."public_public"."stg_orders"

where not(delivery_minutes delivery_minutes IS NULL OR delivery_minutes >= 0)


  
  
      
    ) dbt_internal_test
[0m17:42:08.687453 [debug] [Thread-3 (]: SQL status: BEGIN in 0.158 seconds
[0m17:42:08.687962 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:42:08.688427 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "neondb"."public_public"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'delivered','canceled','returned','unknown'
)



  
  
      
    ) dbt_internal_test
[0m17:42:08.697333 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m17:42:08.697819 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "delivery_minutes"
LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                    ^

[0m17:42:08.698138 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m17:42:08.699996 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: ROLLBACK
[0m17:42:08.700199 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: ROLLBACK
[0m17:42:08.700747 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: ROLLBACK
[0m17:42:08.716128 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.027 seconds
[0m17:42:08.716889 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: ROLLBACK
[0m17:42:08.718151 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: Close
[0m17:42:08.718318 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: Close
[0m17:42:08.718473 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: Close
[0m17:42:08.720405 [error] [Thread-2 (]: 2 of 13 FAIL 1 accepted_values_stg_couriers_vehicle_type__bike__scooter__car ... [[31mFAIL 1[0m in 0.24s]
[0m17:42:08.720958 [error] [Thread-1 (]: 1 of 13 FAIL 1 accepted_values_dim_courier_vehicle_type__bike__scooter__car .... [[31mFAIL 1[0m in 0.24s]
[0m17:42:08.721778 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:42:08.722080 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:42:08.722284 [debug] [Thread-2 (]: Began running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:42:08.722468 [debug] [Thread-1 (]: Began running node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:42:08.722764 [info ] [Thread-2 (]: 5 of 13 START test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_  [RUN]
[0m17:42:08.723017 [info ] [Thread-1 (]: 6 of 13 START test not_null_fct_deliveries_order_id ............................ [RUN]
[0m17:42:08.723249 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37, now test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3)
[0m17:42:08.723447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3, now test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4)
[0m17:42:08.723690 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:42:08.723872 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:42:08.726105 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:42:08.728644 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:42:08.729040 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:42:08.729198 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:42:08.730217 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:42:08.732010 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:42:08.732537 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:42:08.732731 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:42:08.732928 [debug] [Thread-2 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: BEGIN
[0m17:42:08.733121 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: BEGIN
[0m17:42:08.733293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:42:08.733489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:08.735373 [debug] [Thread-4 (]: Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m17:42:08.735601 [error] [Thread-4 (]: 4 of 13 ERROR dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0  [[31mERROR[0m in 0.26s]
[0m17:42:08.735841 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:42:08.736006 [debug] [Thread-4 (]: Began running node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:42:08.736201 [debug] [Thread-7 (]: Marking all children of 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql.
[0m17:42:08.736374 [info ] [Thread-4 (]: 7 of 13 START test not_null_stg_orders_order_id ................................ [RUN]
[0m17:42:08.736852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486, now test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:42:08.737003 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:42:08.738562 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:42:08.738859 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:42:08.739729 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:42:08.739972 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: Close
[0m17:42:08.740176 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:42:08.740516 [debug] [Thread-4 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m17:42:08.740399 [info ] [Thread-3 (]: 3 of 13 PASS accepted_values_stg_orders_status__delivered__canceled__returned__unknown  [[32mPASS[0m in 0.26s]
[0m17:42:08.740697 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:42:08.740902 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:42:08.741140 [debug] [Thread-3 (]: Began running node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:42:08.741320 [info ] [Thread-3 (]: 8 of 13 START test relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_  [RUN]
[0m17:42:08.741498 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e, now test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447)
[0m17:42:08.741656 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:42:08.744834 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:42:08.745133 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:42:08.746043 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:42:08.746334 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:42:08.746489 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: BEGIN
[0m17:42:08.746631 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:42:08.879698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.146 seconds
[0m17:42:08.880438 [debug] [Thread-4 (]: SQL status: BEGIN in 0.140 seconds
[0m17:42:08.880981 [debug] [Thread-2 (]: SQL status: BEGIN in 0.148 seconds
[0m17:42:08.881912 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:42:08.882561 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:42:08.883190 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:42:08.883781 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "neondb"."public_public"."fct_deliveries"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:42:08.884319 [debug] [Thread-4 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "neondb"."public_public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:42:08.884850 [debug] [Thread-2 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "neondb"."public_public"."stg_orders"

where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS NOT NULL) OR (status IN ('canceled','returned','unknown') AND dropoff_ts IS NULL))


  
  
      
    ) dbt_internal_test
[0m17:42:08.889006 [debug] [Thread-3 (]: SQL status: BEGIN in 0.142 seconds
[0m17:42:08.889229 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:42:08.889412 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select courier_id as from_field
    from (select * from "neondb"."public_public"."fct_deliveries" where courier_id IS NOT NULL) dbt_subquery
    where courier_id is not null
),

parent as (
    select courier_id as to_field
    from "neondb"."public_public"."dim_courier"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:42:08.902048 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m17:42:08.904049 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: ROLLBACK
[0m17:42:08.904565 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m17:42:08.905111 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function dropoff_ts(boolean) does not exist
LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m17:42:08.906631 [debug] [Thread-4 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m17:42:08.907106 [debug] [Thread-2 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: ROLLBACK
[0m17:42:08.907482 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m17:42:08.908195 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: ROLLBACK
[0m17:42:08.922640 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: Close
[0m17:42:08.923239 [debug] [Thread-4 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:42:08.923853 [debug] [Thread-2 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: Close
[0m17:42:08.924853 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: Close
[0m17:42:08.924523 [info ] [Thread-1 (]: 6 of 13 PASS not_null_fct_deliveries_order_id .................................. [[32mPASS[0m in 0.20s]
[0m17:42:08.925821 [info ] [Thread-4 (]: 7 of 13 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.19s]
[0m17:42:08.926653 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:42:08.927185 [info ] [Thread-3 (]: 8 of 13 PASS relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_  [[32mPASS[0m in 0.19s]
[0m17:42:08.927976 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:42:08.928198 [debug] [Thread-1 (]: Began running node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:42:08.929035 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m17:42:08.929293 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:42:08.929486 [debug] [Thread-4 (]: Began running node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:42:08.929683 [info ] [Thread-1 (]: 9 of 13 START test relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_  [RUN]
[0m17:42:08.929922 [error] [Thread-2 (]: 5 of 13 ERROR dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_  [[31mERROR[0m in 0.21s]
[0m17:42:08.930119 [debug] [Thread-3 (]: Began running node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:42:08.930311 [info ] [Thread-4 (]: 10 of 13 START test relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_  [RUN]
[0m17:42:08.930503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4, now test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501)
[0m17:42:08.930744 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:42:08.930910 [info ] [Thread-3 (]: 11 of 13 START test relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_  [RUN]
[0m17:42:08.931091 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64, now test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c)
[0m17:42:08.931260 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:42:08.931430 [debug] [Thread-2 (]: Began running node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:42:08.931637 [debug] [Thread-7 (]: Marking all children of 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql.
[0m17:42:08.931846 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447, now test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465)
[0m17:42:08.932015 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:42:08.934484 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:42:08.934701 [info ] [Thread-2 (]: 12 of 13 START test unique_fct_deliveries_order_id ............................. [RUN]
[0m17:42:08.935363 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:42:08.937416 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:42:08.937665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3, now test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a)
[0m17:42:08.939554 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:42:08.939796 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:42:08.939990 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:42:08.940207 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:42:08.942996 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:42:08.944986 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:42:08.945167 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:42:08.946081 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:42:08.947210 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:42:08.947599 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:42:08.947790 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:42:08.947974 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:42:08.948185 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:42:08.949108 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:42:08.949285 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: BEGIN
[0m17:42:08.949456 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: BEGIN
[0m17:42:08.949630 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: BEGIN
[0m17:42:08.949826 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:42:08.949982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:42:08.950137 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:42:08.950305 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:42:08.950613 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: BEGIN
[0m17:42:08.950762 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:42:09.101226 [debug] [Thread-4 (]: SQL status: BEGIN in 0.151 seconds
[0m17:42:09.101891 [debug] [Thread-3 (]: SQL status: BEGIN in 0.152 seconds
[0m17:42:09.102452 [debug] [Thread-2 (]: SQL status: BEGIN in 0.152 seconds
[0m17:42:09.103026 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:42:09.103571 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:42:09.104066 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:42:09.104600 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select courier_id as from_field
    from (select * from "neondb"."public_public"."stg_orders" where courier_id IS NOT NULL) dbt_subquery
    where courier_id is not null
),

parent as (
    select courier_id as to_field
    from "neondb"."public_public"."stg_couriers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:42:09.105143 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select restaurant_id as from_field
    from "neondb"."public_public"."stg_orders"
    where restaurant_id is not null
),

parent as (
    select restaurant_id as to_field
    from "neondb"."public_public"."stg_restaurants"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:42:09.105623 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "neondb"."public_public"."fct_deliveries"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:42:09.107241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m17:42:09.107749 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:42:09.108252 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select restaurant_id as from_field
    from "neondb"."public_public"."fct_deliveries"
    where restaurant_id is not null
),

parent as (
    select restaurant_id as to_field
    from "neondb"."public_public"."dim_restaurant"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:42:09.124193 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.018 seconds
[0m17:42:09.126882 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: ROLLBACK
[0m17:42:09.127407 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m17:42:09.127946 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m17:42:09.128438 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m17:42:09.130402 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: ROLLBACK
[0m17:42:09.131973 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: ROLLBACK
[0m17:42:09.133398 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: ROLLBACK
[0m17:42:09.145338 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: Close
[0m17:42:09.146496 [info ] [Thread-2 (]: 12 of 13 PASS unique_fct_deliveries_order_id ................................... [[32mPASS[0m in 0.21s]
[0m17:42:09.147213 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:42:09.147699 [debug] [Thread-2 (]: Began running node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:42:09.148252 [info ] [Thread-2 (]: 13 of 13 START test unique_stg_orders_order_id ................................. [RUN]
[0m17:42:09.148808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a, now test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a)
[0m17:42:09.149233 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:42:09.151788 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:42:09.151983 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: Close
[0m17:42:09.152162 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: Close
[0m17:42:09.152313 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: Close
[0m17:42:09.152748 [error] [Thread-3 (]: 11 of 13 FAIL 1 relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_  [[31mFAIL 1[0m in 0.22s]
[0m17:42:09.153008 [info ] [Thread-4 (]: 10 of 13 PASS relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_  [[32mPASS[0m in 0.22s]
[0m17:42:09.153231 [info ] [Thread-1 (]: 9 of 13 PASS relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_  [[32mPASS[0m in 0.22s]
[0m17:42:09.153459 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:42:09.153625 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:42:09.153832 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:42:09.154041 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:42:09.155084 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:42:09.155466 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:42:09.155619 [debug] [Thread-2 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m17:42:09.155755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:42:09.298529 [debug] [Thread-2 (]: SQL status: BEGIN in 0.142 seconds
[0m17:42:09.299655 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:42:09.300714 [debug] [Thread-2 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "neondb"."public_public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:42:09.330076 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.029 seconds
[0m17:42:09.330939 [debug] [Thread-2 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m17:42:09.347408 [debug] [Thread-2 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:42:09.347828 [info ] [Thread-2 (]: 13 of 13 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.20s]
[0m17:42:09.348069 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:42:09.348686 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:09.348820 [debug] [MainThread]: On master: BEGIN
[0m17:42:09.348936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:42:09.495291 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m17:42:09.495909 [debug] [MainThread]: On master: COMMIT
[0m17:42:09.496360 [debug] [MainThread]: Using postgres connection "master"
[0m17:42:09.496737 [debug] [MainThread]: On master: COMMIT
[0m17:42:09.513367 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:42:09.514024 [debug] [MainThread]: On master: Close
[0m17:42:09.514912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:09.515296 [debug] [MainThread]: Connection 'test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501' was properly closed.
[0m17:42:09.515624 [debug] [MainThread]: Connection 'test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m17:42:09.515934 [debug] [MainThread]: Connection 'test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465' was properly closed.
[0m17:42:09.516242 [debug] [MainThread]: Connection 'test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c' was properly closed.
[0m17:42:09.516622 [info ] [MainThread]: 
[0m17:42:09.516994 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m17:42:09.520475 [debug] [MainThread]: Command end result
[0m17:42:09.540204 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:42:09.540996 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:42:09.543921 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/run_results.json
[0m17:42:09.544086 [info ] [MainThread]: 
[0m17:42:09.544254 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m17:42:09.544389 [info ] [MainThread]: 
[0m17:42:09.544559 [error] [MainThread]: [31mFailure in test accepted_values_stg_couriers_vehicle_type__bike__scooter__car (models/staging/stg_couriers.yml)[0m
[0m17:42:09.544767 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:42:09.544926 [info ] [MainThread]: 
[0m17:42:09.545077 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_couriers.yml/accepted_values_stg_couriers_vehicle_type__bike__scooter__car.sql
[0m17:42:09.545205 [info ] [MainThread]: 
[0m17:42:09.545356 [error] [MainThread]: [31mFailure in test accepted_values_dim_courier_vehicle_type__bike__scooter__car (models/marts/schema.yml)[0m
[0m17:42:09.545505 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:42:09.545619 [info ] [MainThread]: 
[0m17:42:09.545760 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/marts/schema.yml/accepted_values_dim_courier_vehicle_type__bike__scooter__car.sql
[0m17:42:09.545881 [info ] [MainThread]: 
[0m17:42:09.546029 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)[0m
[0m17:42:09.546189 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m17:42:09.546322 [info ] [MainThread]: 
[0m17:42:09.546466 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m17:42:09.546587 [info ] [MainThread]: 
[0m17:42:09.546743 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)[0m
[0m17:42:09.546914 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m17:42:09.547048 [info ] [MainThread]: 
[0m17:42:09.547193 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m17:42:09.547309 [info ] [MainThread]: 
[0m17:42:09.547453 [error] [MainThread]: [31mFailure in test relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_ (models/staging/stg_orders.yml)[0m
[0m17:42:09.547597 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:42:09.547706 [info ] [MainThread]: 
[0m17:42:09.547844 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/relationships_stg_orders_30762036887c15c825a33e927a3d9200.sql
[0m17:42:09.547966 [info ] [MainThread]: 
[0m17:42:09.548111 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=13
[0m17:42:09.549574 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.054854, "process_in_blocks": "0", "process_kernel_time": 0.178683, "process_mem_max_rss": "135839744", "process_out_blocks": "0", "process_user_time": 1.175843}
[0m17:42:09.549809 [debug] [MainThread]: Command `dbt test` failed at 17:42:09.549773 after 2.06 seconds
[0m17:42:09.549989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ea630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849ddc0>]}
[0m17:42:09.550165 [debug] [MainThread]: Flushing usage events
[0m17:42:09.621371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:04.790207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053660f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8fe90>]}


============================== 17:44:04.792992 | cb5a8fc7-8404-49a7-9950-ea475bbe01fd ==============================
[0m17:44:04.792992 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:44:04.793325 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'empty': 'None', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'use_colors': 'True', 'static_parser': 'True', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'introspect': 'True', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m17:44:04.872046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb5a8fc7-8404-49a7-9950-ea475bbe01fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033e5eb0>]}
[0m17:44:04.896606 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-oyegquik'
[0m17:44:04.896875 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:44:04.980663 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:44:04.981614 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:44:05.027364 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:44:05.029578 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:44:05.166485 [info ] [MainThread]: Installed from version 1.1.1
[0m17:44:05.166747 [info ] [MainThread]: Updated version available: 1.3.1
[0m17:44:05.166938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cb5a8fc7-8404-49a7-9950-ea475bbe01fd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5cd40>]}
[0m17:44:05.167135 [info ] [MainThread]: 
[0m17:44:05.167299 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:44:05.168922 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4150389, "process_in_blocks": "0", "process_kernel_time": 0.166706, "process_mem_max_rss": "114360320", "process_out_blocks": "0", "process_user_time": 0.753172}
[0m17:44:05.169180 [debug] [MainThread]: Command `dbt deps` succeeded at 17:44:05.169137 after 0.42 seconds
[0m17:44:05.169371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd8830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105caa3f0>]}
[0m17:44:05.169545 [debug] [MainThread]: Flushing usage events
[0m17:44:05.253225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:06.089486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b67bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b67f80>]}


============================== 17:44:06.091543 | 5ab5462d-3e19-4da6-af4a-d41db5e17b16 ==============================
[0m17:44:06.091543 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:44:06.091838 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'fail_fast': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None'}
[0m17:44:06.197756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894b560>]}
[0m17:44:06.228433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ae1b0>]}
[0m17:44:06.229663 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:44:06.282189 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:44:06.322939 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:44:06.323218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cec470>]}
[0m17:44:06.892117 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:44:06.892431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109177d10>]}
[0m17:44:06.957186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04ac60>]}
[0m17:44:06.992978 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:44:06.994318 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:44:07.003203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c15a060>]}
[0m17:44:07.003488 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:44:07.003657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0a4920>]}
[0m17:44:07.004606 [info ] [MainThread]: 
[0m17:44:07.004781 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:44:07.004911 [info ] [MainThread]: 
[0m17:44:07.005242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:44:07.007125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m17:44:07.033246 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m17:44:07.033508 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m17:44:07.033649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:07.195519 [debug] [ThreadPool]: SQL status: SELECT 102 in 0.162 seconds
[0m17:44:07.196413 [debug] [ThreadPool]: On list_neondb: Close
[0m17:44:07.197373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_netid1234_netid1234)
[0m17:44:07.200355 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:44:07.200602 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: BEGIN
[0m17:44:07.200736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:07.346665 [debug] [ThreadPool]: SQL status: BEGIN in 0.146 seconds
[0m17:44:07.347000 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:44:07.347172 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_netid1234_netid1234"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'netid1234_netid1234'
  
[0m17:44:07.365961 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.019 seconds
[0m17:44:07.366695 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: ROLLBACK
[0m17:44:07.383293 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: Close
[0m17:44:07.386629 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:07.386861 [debug] [MainThread]: On master: BEGIN
[0m17:44:07.387022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:07.533309 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m17:44:07.533615 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:07.533811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:44:07.555233 [debug] [MainThread]: SQL status: SELECT 62 in 0.021 seconds
[0m17:44:07.559029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc38c0>]}
[0m17:44:07.559286 [debug] [MainThread]: On master: ROLLBACK
[0m17:44:07.575997 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:07.576254 [debug] [MainThread]: On master: BEGIN
[0m17:44:07.623259 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m17:44:07.623932 [debug] [MainThread]: On master: COMMIT
[0m17:44:07.624462 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:07.624945 [debug] [MainThread]: On master: COMMIT
[0m17:44:07.643707 [debug] [MainThread]: SQL status: COMMIT in 0.018 seconds
[0m17:44:07.644322 [debug] [MainThread]: On master: Close
[0m17:44:07.648675 [debug] [Thread-1 (]: Began running node model.dashdash_lab.stg_couriers
[0m17:44:07.649142 [debug] [Thread-2 (]: Began running node model.dashdash_lab.stg_customers
[0m17:44:07.649562 [debug] [Thread-3 (]: Began running node model.dashdash_lab.stg_orders
[0m17:44:07.649993 [debug] [Thread-4 (]: Began running node model.dashdash_lab.stg_restaurants
[0m17:44:07.650539 [info ] [Thread-1 (]: 1 of 10 START sql view model netid1234_netid1234.stg_couriers .................. [RUN]
[0m17:44:07.651045 [info ] [Thread-2 (]: 2 of 10 START sql view model netid1234_netid1234.stg_customers ................. [RUN]
[0m17:44:07.651311 [info ] [Thread-3 (]: 3 of 10 START sql view model netid1234_netid1234.stg_orders .................... [RUN]
[0m17:44:07.651520 [info ] [Thread-4 (]: 4 of 10 START sql view model netid1234_netid1234.stg_restaurants ............... [RUN]
[0m17:44:07.651744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_netid1234_netid1234, now model.dashdash_lab.stg_couriers)
[0m17:44:07.651948 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_customers'
[0m17:44:07.652130 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_orders'
[0m17:44:07.652309 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_restaurants'
[0m17:44:07.652482 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.stg_couriers
[0m17:44:07.652627 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.stg_customers
[0m17:44:07.652767 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.stg_orders
[0m17:44:07.652904 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.stg_restaurants
[0m17:44:07.685900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.stg_couriers"
[0m17:44:07.687179 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.stg_customers"
[0m17:44:07.689345 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.stg_orders"
[0m17:44:07.690572 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.stg_restaurants"
[0m17:44:07.691106 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.stg_customers
[0m17:44:07.691322 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.stg_couriers
[0m17:44:07.697275 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.stg_orders
[0m17:44:07.703519 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.stg_restaurants
[0m17:44:07.705795 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.stg_customers"
[0m17:44:07.707208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.stg_couriers"
[0m17:44:07.708476 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.stg_orders"
[0m17:44:07.710520 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.stg_restaurants"
[0m17:44:07.711022 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:44:07.711311 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: BEGIN
[0m17:44:07.711518 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:44:07.711715 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:44:07.711871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:07.712035 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:44:07.712202 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: BEGIN
[0m17:44:07.712384 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: BEGIN
[0m17:44:07.712630 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: BEGIN
[0m17:44:07.712791 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:44:07.712967 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:44:07.713159 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:44:07.873099 [debug] [Thread-2 (]: SQL status: BEGIN in 0.160 seconds
[0m17:44:07.873422 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:44:07.873601 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */

  create view "neondb"."netid1234_netid1234"."stg_customers__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."netid1234"."customers"
  );
[0m17:44:07.873935 [debug] [Thread-4 (]: SQL status: BEGIN in 0.161 seconds
[0m17:44:07.874137 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:44:07.874303 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */

  create view "neondb"."netid1234_netid1234"."stg_restaurants__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."netid1234"."restaurants"
  );
[0m17:44:07.875756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.164 seconds
[0m17:44:07.875956 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:44:07.876128 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */

  create view "neondb"."netid1234_netid1234"."stg_couriers__dbt_tmp"
    
    
  as (
    

select
  courier_id,
  courier_name,
  lower(vehicle_type) as vehicle_type,
  active_from,
  active_to,
  region
from "neondb"."netid1234"."couriers"
  );
[0m17:44:07.879956 [debug] [Thread-3 (]: SQL status: BEGIN in 0.167 seconds
[0m17:44:07.880152 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:44:07.880373 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */

  create view "neondb"."netid1234_netid1234"."stg_orders__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(nullif(trim(status), '')) as status_norm,
        payment_method,
        
    
        NULLIF(BTRIM(subtotal::text), '')::numeric(10, 2)
    
 as subtotal,
        
    
        NULLIF(BTRIM(delivery_fee::text), '')::numeric(10, 2)
    
 as delivery_fee,
        
    
        NULLIF(BTRIM(tip_amount::text), '')::numeric(10, 2)
    
 as tip_amount,
        
    
        NULLIF(BTRIM(distance_km::text), '')::numeric(6, 2)
    
 as distance_km,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."netid1234"."orders"
),
dedup as (
    select *
    from base
    where rn = 1
),
clean as (
    select
        *,
        case
            when status_norm in ('delivered', 'canceled', 'returned') then status_norm
            when status_norm is null or status_norm = '' then 'unknown'
            else 'unknown'
        end as status_final,
        case
            when pickup_ts is not null and dropoff_ts is not null
                then 
    
        EXTRACT(epoch FROM (dropoff_ts - pickup_ts)) / 60.0
    

            else null
        end as delivery_minutes
    from dedup
)
select
    order_id,
    customer_id,
    restaurant_id,
    courier_id,
    order_ts,
    pickup_ts,
    dropoff_ts,
    status_final as status,
    payment_method,
    subtotal,
    delivery_fee,
    tip_amount,
    distance_km,
    delivery_minutes,
    case
        when status_final = 'delivered' and delivery_minutes <= 45 then 
    TRUE

        else 
    FALSE

    end as on_time_flag
from clean
  );
[0m17:44:07.890481 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "netid1234.customers" does not exist
LINE 11: from "neondb"."netid1234"."customers"
              ^

[0m17:44:07.891004 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "netid1234.restaurants" does not exist
LINE 11: from "neondb"."netid1234"."restaurants"
              ^

[0m17:44:07.891594 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: ROLLBACK
[0m17:44:07.892170 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: ROLLBACK
[0m17:44:07.893238 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "netid1234.couriers" does not exist
LINE 16: from "neondb"."netid1234"."couriers"
              ^

[0m17:44:07.893691 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: ROLLBACK
[0m17:44:07.897450 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "netid1234.orders" does not exist
LINE 53:     from "neondb"."netid1234"."orders"
                  ^

[0m17:44:07.897931 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: ROLLBACK
[0m17:44:07.909773 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: Close
[0m17:44:07.910383 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: Close
[0m17:44:07.911010 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: Close
[0m17:44:07.915008 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: Close
[0m17:44:07.920689 [debug] [Thread-1 (]: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:44:07.921572 [debug] [Thread-4 (]: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:44:07.922274 [debug] [Thread-3 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:44:07.923220 [debug] [Thread-2 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:44:07.924033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fe000>]}
[0m17:44:07.924187 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be31760>]}
[0m17:44:07.924350 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be31c40>]}
[0m17:44:07.924488 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ab5462d-3e19-4da6-af4a-d41db5e17b16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be31280>]}
[0m17:44:07.924773 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model netid1234_netid1234.stg_couriers ......... [[31mERROR[0m in 0.27s]
[0m17:44:07.925044 [error] [Thread-4 (]: 4 of 10 ERROR creating sql view model netid1234_netid1234.stg_restaurants ...... [[31mERROR[0m in 0.27s]
[0m17:44:07.925301 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model netid1234_netid1234.stg_orders ........... [[31mERROR[0m in 0.27s]
[0m17:44:07.925543 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model netid1234_netid1234.stg_customers ........ [[31mERROR[0m in 0.27s]
[0m17:44:07.925787 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.stg_couriers
[0m17:44:07.926004 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.stg_restaurants
[0m17:44:07.926219 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.stg_orders
[0m17:44:07.926429 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.stg_customers
[0m17:44:07.926638 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_couriers' to be skipped because of status 'error'.  Reason: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql.
[0m17:44:07.927210 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_restaurants' to be skipped because of status 'error'.  Reason: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql.
[0m17:44:07.927414 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_courier
[0m17:44:07.927627 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql.
[0m17:44:07.927822 [debug] [Thread-3 (]: Began running node model.dashdash_lab.dim_restaurant
[0m17:44:07.928120 [debug] [Thread-2 (]: Began running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:44:07.927986 [info ] [Thread-1 (]: 5 of 10 SKIP relation netid1234_netid1234.dim_courier .......................... [[33mSKIP[0m]
[0m17:44:07.928378 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql.
[0m17:44:07.928558 [debug] [Thread-4 (]: Began running node model.dashdash_lab.fct_deliveries
[0m17:44:07.928713 [info ] [Thread-3 (]: 6 of 10 SKIP relation netid1234_netid1234.dim_restaurant ....................... [[33mSKIP[0m]
[0m17:44:07.928893 [info ] [Thread-2 (]: 7 of 10 SKIP relation netid1234_netid1234.monitoring_dq_exceptions ............. [[33mSKIP[0m]
[0m17:44:07.929072 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_courier
[0m17:44:07.929285 [info ] [Thread-4 (]: 8 of 10 SKIP relation netid1234_netid1234.fct_deliveries ....................... [[33mSKIP[0m]
[0m17:44:07.929455 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.dim_restaurant
[0m17:44:07.929616 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:44:07.929783 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_customer
[0m17:44:07.929955 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.fct_deliveries
[0m17:44:07.930178 [info ] [Thread-1 (]: 9 of 10 SKIP relation netid1234_netid1234.dim_customer ......................... [[33mSKIP[0m]
[0m17:44:07.930397 [debug] [Thread-3 (]: Began running node model.dashdash_lab.kpi_delivery_overview
[0m17:44:07.930558 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_customer
[0m17:44:07.930727 [info ] [Thread-3 (]: 10 of 10 SKIP relation netid1234_netid1234.kpi_delivery_overview ............... [[33mSKIP[0m]
[0m17:44:07.930954 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.kpi_delivery_overview
[0m17:44:07.931492 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:07.931628 [debug] [MainThread]: On master: BEGIN
[0m17:44:07.931750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:08.076081 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m17:44:08.076809 [debug] [MainThread]: On master: COMMIT
[0m17:44:08.077331 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:08.077794 [debug] [MainThread]: On master: COMMIT
[0m17:44:08.094525 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:44:08.095211 [debug] [MainThread]: On master: Close
[0m17:44:08.096199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:08.096658 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_couriers' was properly closed.
[0m17:44:08.097076 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_customers' was properly closed.
[0m17:44:08.097457 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_orders' was properly closed.
[0m17:44:08.097813 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_restaurants' was properly closed.
[0m17:44:08.098302 [info ] [MainThread]: 
[0m17:44:08.098744 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m17:44:08.100269 [debug] [MainThread]: Command end result
[0m17:44:08.114860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:44:08.115659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:44:08.118115 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/run_results.json
[0m17:44:08.118276 [info ] [MainThread]: 
[0m17:44:08.118438 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m17:44:08.118571 [info ] [MainThread]: 
[0m17:44:08.118733 [error] [MainThread]: [31mFailure in model stg_couriers (models/staging/stg_couriers.sql)[0m
[0m17:44:08.118894 [error] [MainThread]:   Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:44:08.119021 [info ] [MainThread]: 
[0m17:44:08.119173 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_couriers.sql
[0m17:44:08.119304 [info ] [MainThread]: 
[0m17:44:08.119460 [error] [MainThread]: [31mFailure in model stg_restaurants (models/staging/stg_restaurants.sql)[0m
[0m17:44:08.119616 [error] [MainThread]:   Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:44:08.119737 [info ] [MainThread]: 
[0m17:44:08.119876 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:44:08.119993 [info ] [MainThread]: 
[0m17:44:08.120134 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m17:44:08.120282 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:44:08.120403 [info ] [MainThread]: 
[0m17:44:08.120543 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.sql
[0m17:44:08.120660 [info ] [MainThread]: 
[0m17:44:08.120803 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m17:44:08.120951 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:44:08.121074 [info ] [MainThread]: 
[0m17:44:08.121212 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_customers.sql
[0m17:44:08.121332 [info ] [MainThread]: 
[0m17:44:08.121473 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=6 NO-OP=0 TOTAL=10
[0m17:44:08.121719 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:44:08.123202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.06767, "process_in_blocks": "0", "process_kernel_time": 0.193582, "process_mem_max_rss": "146325504", "process_out_blocks": "0", "process_user_time": 1.641675}
[0m17:44:08.123406 [debug] [MainThread]: Command `dbt run` failed at 17:44:08.123370 after 2.07 seconds
[0m17:44:08.123578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e3260>]}
[0m17:44:08.123739 [debug] [MainThread]: Flushing usage events
[0m17:44:08.211548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:56.324784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107143740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725e1e0>]}


============================== 17:45:56.327553 | 4379347d-802f-486c-894b-0df8f2444c4a ==============================
[0m17:45:56.327553 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:45:56.327847 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'introspect': 'True'}
[0m17:45:56.406376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4379347d-802f-486c-894b-0df8f2444c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b1730>]}
[0m17:45:56.429883 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-672k07xz'
[0m17:45:56.430144 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:45:56.500412 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:45:56.501406 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:45:56.543287 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:45:56.545549 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:45:56.698361 [info ] [MainThread]: Installed from version 1.1.1
[0m17:45:56.698623 [info ] [MainThread]: Updated version available: 1.3.1
[0m17:45:56.698817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4379347d-802f-486c-894b-0df8f2444c4a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a94f0>]}
[0m17:45:56.699029 [info ] [MainThread]: 
[0m17:45:56.699186 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:45:56.700944 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.41091317, "process_in_blocks": "0", "process_kernel_time": 0.167408, "process_mem_max_rss": "116228096", "process_out_blocks": "0", "process_user_time": 0.755684}
[0m17:45:56.701257 [debug] [MainThread]: Command `dbt deps` succeeded at 17:45:56.701206 after 0.41 seconds
[0m17:45:56.701449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ee9c0>]}
[0m17:45:56.701622 [debug] [MainThread]: Flushing usage events
[0m17:45:56.796501 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:57.632231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ada480>]}


============================== 17:45:57.634403 | d3480f82-1657-4d2e-8b56-5544face1afd ==============================
[0m17:45:57.634403 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:45:57.634710 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'False', 'log_format': 'default'}
[0m17:45:57.744366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103feb0e0>]}
[0m17:45:57.775122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106304d0>]}
[0m17:45:57.775956 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:45:57.828411 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:45:57.893424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:57.893681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:57.912556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11065b230>]}
[0m17:45:57.948704 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:45:57.951607 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:45:57.959506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107d58e0>]}
[0m17:45:57.959763 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:45:57.959937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a49e0>]}
[0m17:45:57.960880 [info ] [MainThread]: 
[0m17:45:57.961044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:57.961173 [info ] [MainThread]: 
[0m17:45:57.961396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:57.963199 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m17:45:57.989862 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m17:45:57.990104 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m17:45:57.990247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:58.144672 [debug] [ThreadPool]: SQL status: SELECT 102 in 0.154 seconds
[0m17:45:58.145554 [debug] [ThreadPool]: On list_neondb: Close
[0m17:45:58.146431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_netid1234_netid1234)
[0m17:45:58.149086 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:45:58.149255 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: BEGIN
[0m17:45:58.149381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:58.300327 [debug] [ThreadPool]: SQL status: BEGIN in 0.151 seconds
[0m17:45:58.301502 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:45:58.302620 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_netid1234_netid1234"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'netid1234_netid1234'
  
[0m17:45:58.323457 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m17:45:58.325978 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: ROLLBACK
[0m17:45:58.343524 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: Close
[0m17:45:58.353718 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:58.354457 [debug] [MainThread]: On master: BEGIN
[0m17:45:58.354961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:58.511791 [debug] [MainThread]: SQL status: BEGIN in 0.157 seconds
[0m17:45:58.512480 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:58.512991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:45:58.546176 [debug] [MainThread]: SQL status: SELECT 62 in 0.032 seconds
[0m17:45:58.552359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d47d0>]}
[0m17:45:58.553509 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:58.570554 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:58.571801 [debug] [MainThread]: On master: BEGIN
[0m17:45:58.606464 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m17:45:58.607333 [debug] [MainThread]: On master: COMMIT
[0m17:45:58.608202 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:58.608855 [debug] [MainThread]: On master: COMMIT
[0m17:45:58.626076 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:45:58.627889 [debug] [MainThread]: On master: Close
[0m17:45:58.633623 [debug] [Thread-1 (]: Began running node model.dashdash_lab.stg_couriers
[0m17:45:58.634566 [debug] [Thread-2 (]: Began running node model.dashdash_lab.stg_customers
[0m17:45:58.635306 [debug] [Thread-3 (]: Began running node model.dashdash_lab.stg_orders
[0m17:45:58.635919 [debug] [Thread-4 (]: Began running node model.dashdash_lab.stg_restaurants
[0m17:45:58.636809 [info ] [Thread-1 (]: 1 of 10 START sql view model netid1234_netid1234.stg_couriers .................. [RUN]
[0m17:45:58.637625 [info ] [Thread-2 (]: 2 of 10 START sql view model netid1234_netid1234.stg_customers ................. [RUN]
[0m17:45:58.638412 [info ] [Thread-3 (]: 3 of 10 START sql view model netid1234_netid1234.stg_orders .................... [RUN]
[0m17:45:58.639136 [info ] [Thread-4 (]: 4 of 10 START sql view model netid1234_netid1234.stg_restaurants ............... [RUN]
[0m17:45:58.639793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_netid1234_netid1234, now model.dashdash_lab.stg_couriers)
[0m17:45:58.640416 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_customers'
[0m17:45:58.640978 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_orders'
[0m17:45:58.641627 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_restaurants'
[0m17:45:58.642281 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.stg_couriers
[0m17:45:58.642915 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.stg_customers
[0m17:45:58.643095 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.stg_orders
[0m17:45:58.643251 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.stg_restaurants
[0m17:45:58.646650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.stg_couriers"
[0m17:45:58.647803 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.stg_customers"
[0m17:45:58.652965 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.stg_orders"
[0m17:45:58.654042 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.stg_restaurants"
[0m17:45:58.654542 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.stg_couriers
[0m17:45:58.654774 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.stg_customers
[0m17:45:58.660402 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.stg_orders
[0m17:45:58.666628 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.stg_restaurants
[0m17:45:58.696100 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.stg_couriers"
[0m17:45:58.697492 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.stg_customers"
[0m17:45:58.698789 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.stg_orders"
[0m17:45:58.699970 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.stg_restaurants"
[0m17:45:58.700429 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:45:58.700680 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:45:58.700874 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: BEGIN
[0m17:45:58.701122 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: BEGIN
[0m17:45:58.701304 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:45:58.701473 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:45:58.701646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:58.701801 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:45:58.701957 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: BEGIN
[0m17:45:58.702105 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: BEGIN
[0m17:45:58.702394 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:45:58.702559 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:45:58.851076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m17:45:58.851612 [debug] [Thread-4 (]: SQL status: BEGIN in 0.149 seconds
[0m17:45:58.852159 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:45:58.852664 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:45:58.853133 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */

  create view "neondb"."netid1234_netid1234"."stg_couriers__dbt_tmp"
    
    
  as (
    

select
  courier_id,
  courier_name,
  lower(vehicle_type) as vehicle_type,
  active_from,
  active_to,
  region
from "neondb"."netid1234"."couriers"
  );
[0m17:45:58.853588 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */

  create view "neondb"."netid1234_netid1234"."stg_restaurants__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."netid1234"."restaurants"
  );
[0m17:45:58.853978 [debug] [Thread-2 (]: SQL status: BEGIN in 0.152 seconds
[0m17:45:58.854431 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:45:58.854622 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */

  create view "neondb"."netid1234_netid1234"."stg_customers__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."netid1234"."customers"
  );
[0m17:45:58.856428 [debug] [Thread-3 (]: SQL status: BEGIN in 0.154 seconds
[0m17:45:58.856623 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:45:58.856851 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */

  create view "neondb"."netid1234_netid1234"."stg_orders__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(nullif(trim(status), '')) as status_norm,
        payment_method,
        
    
        NULLIF(BTRIM(subtotal::text), '')::numeric(10, 2)
    
 as subtotal,
        
    
        NULLIF(BTRIM(delivery_fee::text), '')::numeric(10, 2)
    
 as delivery_fee,
        
    
        NULLIF(BTRIM(tip_amount::text), '')::numeric(10, 2)
    
 as tip_amount,
        
    
        NULLIF(BTRIM(distance_km::text), '')::numeric(6, 2)
    
 as distance_km,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."netid1234"."orders"
),
dedup as (
    select *
    from base
    where rn = 1
),
clean as (
    select
        *,
        case
            when status_norm in ('delivered', 'canceled', 'returned') then status_norm
            when status_norm is null or status_norm = '' then 'unknown'
            else 'unknown'
        end as status_final,
        case
            when pickup_ts is not null and dropoff_ts is not null
                then 
    
        EXTRACT(epoch FROM (dropoff_ts - pickup_ts)) / 60.0
    

            else null
        end as delivery_minutes
    from dedup
)
select
    order_id,
    customer_id,
    restaurant_id,
    courier_id,
    order_ts,
    pickup_ts,
    dropoff_ts,
    status_final as status,
    payment_method,
    subtotal,
    delivery_fee,
    tip_amount,
    distance_km,
    delivery_minutes,
    case
        when status_final = 'delivered' and delivery_minutes <= 45 then 
    TRUE

        else 
    FALSE

    end as on_time_flag
from clean
  );
[0m17:45:58.871495 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "netid1234.customers" does not exist
LINE 11: from "neondb"."netid1234"."customers"
              ^

[0m17:45:58.871994 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "netid1234.restaurants" does not exist
LINE 11: from "neondb"."netid1234"."restaurants"
              ^

[0m17:45:58.872457 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "netid1234.couriers" does not exist
LINE 16: from "neondb"."netid1234"."couriers"
              ^

[0m17:45:58.872978 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: ROLLBACK
[0m17:45:58.873388 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: ROLLBACK
[0m17:45:58.873776 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: ROLLBACK
[0m17:45:58.875941 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "netid1234.orders" does not exist
LINE 53:     from "neondb"."netid1234"."orders"
                  ^

[0m17:45:58.876488 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: ROLLBACK
[0m17:45:58.892210 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: Close
[0m17:45:58.892772 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: Close
[0m17:45:58.893301 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: Close
[0m17:45:58.893798 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: Close
[0m17:45:58.900856 [debug] [Thread-3 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:45:58.901630 [debug] [Thread-2 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:45:58.902270 [debug] [Thread-1 (]: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:45:58.902888 [debug] [Thread-4 (]: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:45:58.903947 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e08ef0>]}
[0m17:45:58.904116 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076becc0>]}
[0m17:45:58.904275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bfc50>]}
[0m17:45:58.904424 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3480f82-1657-4d2e-8b56-5544face1afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e431a0>]}
[0m17:45:58.904708 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model netid1234_netid1234.stg_orders ........... [[31mERROR[0m in 0.26s]
[0m17:45:58.904988 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model netid1234_netid1234.stg_customers ........ [[31mERROR[0m in 0.26s]
[0m17:45:58.905244 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model netid1234_netid1234.stg_couriers ......... [[31mERROR[0m in 0.26s]
[0m17:45:58.905502 [error] [Thread-4 (]: 4 of 10 ERROR creating sql view model netid1234_netid1234.stg_restaurants ...... [[31mERROR[0m in 0.26s]
[0m17:45:58.905759 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.stg_orders
[0m17:45:58.905969 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.stg_customers
[0m17:45:58.906192 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.stg_couriers
[0m17:45:58.906415 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.stg_restaurants
[0m17:45:58.906628 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql.
[0m17:45:58.907185 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql.
[0m17:45:58.907401 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_couriers' to be skipped because of status 'error'.  Reason: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql.
[0m17:45:58.907600 [debug] [Thread-3 (]: Began running node model.dashdash_lab.dim_customer
[0m17:45:58.907818 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_restaurants' to be skipped because of status 'error'.  Reason: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql.
[0m17:45:58.908010 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_courier
[0m17:45:58.908183 [info ] [Thread-3 (]: 5 of 10 SKIP relation netid1234_netid1234.dim_customer ......................... [[33mSKIP[0m]
[0m17:45:58.908426 [debug] [Thread-2 (]: Began running node model.dashdash_lab.dim_restaurant
[0m17:45:58.908707 [debug] [Thread-4 (]: Began running node model.dashdash_lab.fct_deliveries
[0m17:45:58.908579 [info ] [Thread-1 (]: 6 of 10 SKIP relation netid1234_netid1234.dim_courier .......................... [[33mSKIP[0m]
[0m17:45:58.908912 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.dim_customer
[0m17:45:58.909079 [info ] [Thread-2 (]: 7 of 10 SKIP relation netid1234_netid1234.dim_restaurant ....................... [[33mSKIP[0m]
[0m17:45:58.909254 [info ] [Thread-4 (]: 8 of 10 SKIP relation netid1234_netid1234.fct_deliveries ....................... [[33mSKIP[0m]
[0m17:45:58.909424 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_courier
[0m17:45:58.909581 [debug] [Thread-3 (]: Began running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:45:58.909754 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.dim_restaurant
[0m17:45:58.909908 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.fct_deliveries
[0m17:45:58.910099 [info ] [Thread-3 (]: 9 of 10 SKIP relation netid1234_netid1234.monitoring_dq_exceptions ............. [[33mSKIP[0m]
[0m17:45:58.910366 [debug] [Thread-1 (]: Began running node model.dashdash_lab.kpi_delivery_overview
[0m17:45:58.910520 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:45:58.910691 [info ] [Thread-1 (]: 10 of 10 SKIP relation netid1234_netid1234.kpi_delivery_overview ............... [[33mSKIP[0m]
[0m17:45:58.910900 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.kpi_delivery_overview
[0m17:45:58.911431 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:58.911588 [debug] [MainThread]: On master: BEGIN
[0m17:45:58.911713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:59.059559 [debug] [MainThread]: SQL status: BEGIN in 0.148 seconds
[0m17:45:59.060443 [debug] [MainThread]: On master: COMMIT
[0m17:45:59.061148 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:59.061730 [debug] [MainThread]: On master: COMMIT
[0m17:45:59.078896 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:45:59.080008 [debug] [MainThread]: On master: Close
[0m17:45:59.081885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:59.082548 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_couriers' was properly closed.
[0m17:45:59.083101 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_customers' was properly closed.
[0m17:45:59.083622 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_orders' was properly closed.
[0m17:45:59.084142 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_restaurants' was properly closed.
[0m17:45:59.084827 [info ] [MainThread]: 
[0m17:45:59.085592 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m17:45:59.088142 [debug] [MainThread]: Command end result
[0m17:45:59.105548 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:45:59.106335 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:45:59.108865 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/run_results.json
[0m17:45:59.109032 [info ] [MainThread]: 
[0m17:45:59.109195 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m17:45:59.109338 [info ] [MainThread]: 
[0m17:45:59.109505 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m17:45:59.109666 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:45:59.109791 [info ] [MainThread]: 
[0m17:45:59.109930 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.sql
[0m17:45:59.110048 [info ] [MainThread]: 
[0m17:45:59.110189 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m17:45:59.110335 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:45:59.110456 [info ] [MainThread]: 
[0m17:45:59.110595 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_customers.sql
[0m17:45:59.110709 [info ] [MainThread]: 
[0m17:45:59.110853 [error] [MainThread]: [31mFailure in model stg_couriers (models/staging/stg_couriers.sql)[0m
[0m17:45:59.111001 [error] [MainThread]:   Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:45:59.111119 [info ] [MainThread]: 
[0m17:45:59.111253 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_couriers.sql
[0m17:45:59.111367 [info ] [MainThread]: 
[0m17:45:59.111503 [error] [MainThread]: [31mFailure in model stg_restaurants (models/staging/stg_restaurants.sql)[0m
[0m17:45:59.111647 [error] [MainThread]:   Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:45:59.111766 [info ] [MainThread]: 
[0m17:45:59.111905 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:45:59.112019 [info ] [MainThread]: 
[0m17:45:59.112158 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=6 NO-OP=0 TOTAL=10
[0m17:45:59.113658 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5187929, "process_in_blocks": "0", "process_kernel_time": 0.192101, "process_mem_max_rss": "136003584", "process_out_blocks": "0", "process_user_time": 1.099996}
[0m17:45:59.113869 [debug] [MainThread]: Command `dbt run` failed at 17:45:59.113834 after 1.52 seconds
[0m17:45:59.114043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c182c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c19940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c197c0>]}
[0m17:45:59.114205 [debug] [MainThread]: Flushing usage events
[0m17:45:59.192888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:47.083039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b40920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105158fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515a120>]}


============================== 17:47:47.085633 | eed8baca-1484-43d4-96ad-b174d3cb6e0d ==============================
[0m17:47:47.085633 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:47:47.085934 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True'}
[0m17:47:47.164835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eed8baca-1484-43d4-96ad-b174d3cb6e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645c4a0>]}
[0m17:47:47.188436 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-ygol4nz_'
[0m17:47:47.188697 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:47:47.264015 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:47:47.264988 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:47:47.304594 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:47:47.306867 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:47:47.889577 [info ] [MainThread]: Installed from version 1.1.1
[0m17:47:47.889851 [info ] [MainThread]: Updated version available: 1.3.1
[0m17:47:47.890072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'eed8baca-1484-43d4-96ad-b174d3cb6e0d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105159190>]}
[0m17:47:47.890296 [info ] [MainThread]: 
[0m17:47:47.890461 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:47:47.892082 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8445025, "process_in_blocks": "0", "process_kernel_time": 0.172218, "process_mem_max_rss": "115916800", "process_out_blocks": "0", "process_user_time": 0.772894}
[0m17:47:47.892333 [debug] [MainThread]: Command `dbt deps` succeeded at 17:47:47.892292 after 0.84 seconds
[0m17:47:47.892507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106412a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653e210>]}
[0m17:47:47.892679 [debug] [MainThread]: Flushing usage events
[0m17:47:47.983248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:48.877332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d332f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ffec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a67f20>]}


============================== 17:47:48.879598 | e2460bc2-2bc3-4aa4-9216-901411c22d5f ==============================
[0m17:47:48.879598 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:47:48.879912 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error': 'None', 'write_json': 'True', 'version_check': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'static_parser': 'True'}
[0m17:47:48.995239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3c290>]}
[0m17:47:49.027172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a67b60>]}
[0m17:47:49.027950 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:47:49.080576 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:47:49.142432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:49.142671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:49.161904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a356d80>]}
[0m17:47:49.198298 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:47:49.200366 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:47:49.208302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a29d310>]}
[0m17:47:49.208565 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:47:49.208731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a878bf0>]}
[0m17:47:49.209683 [info ] [MainThread]: 
[0m17:47:49.209871 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:47:49.210000 [info ] [MainThread]: 
[0m17:47:49.210233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:49.212028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m17:47:49.238119 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m17:47:49.238344 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m17:47:49.238480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:49.399933 [debug] [ThreadPool]: SQL status: SELECT 102 in 0.161 seconds
[0m17:47:49.400784 [debug] [ThreadPool]: On list_neondb: Close
[0m17:47:49.401651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_netid1234_netid1234)
[0m17:47:49.404234 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:47:49.404394 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: BEGIN
[0m17:47:49.404518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:49.554707 [debug] [ThreadPool]: SQL status: BEGIN in 0.150 seconds
[0m17:47:49.555652 [debug] [ThreadPool]: Using postgres connection "list_neondb_netid1234_netid1234"
[0m17:47:49.556429 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_netid1234_netid1234"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'netid1234_netid1234'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'netid1234_netid1234'
  
[0m17:47:49.576946 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m17:47:49.579669 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: ROLLBACK
[0m17:47:49.596865 [debug] [ThreadPool]: On list_neondb_netid1234_netid1234: Close
[0m17:47:49.607412 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:49.608016 [debug] [MainThread]: On master: BEGIN
[0m17:47:49.608477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:49.765443 [debug] [MainThread]: SQL status: BEGIN in 0.157 seconds
[0m17:47:49.766346 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:49.767302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:47:49.791552 [debug] [MainThread]: SQL status: SELECT 62 in 0.023 seconds
[0m17:47:49.796780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aafe8d0>]}
[0m17:47:49.797747 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:49.814698 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:49.815410 [debug] [MainThread]: On master: BEGIN
[0m17:47:49.850259 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m17:47:49.851785 [debug] [MainThread]: On master: COMMIT
[0m17:47:49.852987 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:49.853626 [debug] [MainThread]: On master: COMMIT
[0m17:47:49.870671 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:47:49.871550 [debug] [MainThread]: On master: Close
[0m17:47:49.876665 [debug] [Thread-1 (]: Began running node model.dashdash_lab.stg_couriers
[0m17:47:49.877197 [debug] [Thread-2 (]: Began running node model.dashdash_lab.stg_customers
[0m17:47:49.877696 [debug] [Thread-3 (]: Began running node model.dashdash_lab.stg_orders
[0m17:47:49.878190 [debug] [Thread-4 (]: Began running node model.dashdash_lab.stg_restaurants
[0m17:47:49.878903 [info ] [Thread-1 (]: 1 of 10 START sql view model netid1234_netid1234.stg_couriers .................. [RUN]
[0m17:47:49.879554 [info ] [Thread-2 (]: 2 of 10 START sql view model netid1234_netid1234.stg_customers ................. [RUN]
[0m17:47:49.880148 [info ] [Thread-3 (]: 3 of 10 START sql view model netid1234_netid1234.stg_orders .................... [RUN]
[0m17:47:49.880713 [info ] [Thread-4 (]: 4 of 10 START sql view model netid1234_netid1234.stg_restaurants ............... [RUN]
[0m17:47:49.881049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_netid1234_netid1234, now model.dashdash_lab.stg_couriers)
[0m17:47:49.881308 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_customers'
[0m17:47:49.881519 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_orders'
[0m17:47:49.881714 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_restaurants'
[0m17:47:49.881879 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.stg_couriers
[0m17:47:49.882030 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.stg_customers
[0m17:47:49.882181 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.stg_orders
[0m17:47:49.882365 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.stg_restaurants
[0m17:47:49.885898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.stg_couriers"
[0m17:47:49.887107 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.stg_customers"
[0m17:47:49.892262 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.stg_orders"
[0m17:47:49.893401 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.stg_restaurants"
[0m17:47:49.893860 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.stg_customers
[0m17:47:49.894037 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.stg_orders
[0m17:47:49.894192 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.stg_couriers
[0m17:47:49.934663 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.stg_customers"
[0m17:47:49.934930 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.stg_restaurants
[0m17:47:49.936337 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.stg_orders"
[0m17:47:49.937568 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.stg_couriers"
[0m17:47:49.938925 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.stg_restaurants"
[0m17:47:49.939265 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:47:49.939564 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:47:49.939745 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: BEGIN
[0m17:47:49.939969 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:47:49.940137 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: BEGIN
[0m17:47:49.940313 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:47:49.940513 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:47:49.940711 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: BEGIN
[0m17:47:49.940865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:49.941101 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: BEGIN
[0m17:47:49.941263 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:47:49.941462 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:47:50.094092 [debug] [Thread-3 (]: SQL status: BEGIN in 0.153 seconds
[0m17:47:50.094674 [debug] [Thread-4 (]: SQL status: BEGIN in 0.153 seconds
[0m17:47:50.095099 [debug] [Thread-2 (]: SQL status: BEGIN in 0.155 seconds
[0m17:47:50.095622 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:47:50.095972 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:47:50.096171 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:47:50.096416 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */

  create view "neondb"."netid1234_netid1234"."stg_orders__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(nullif(trim(status), '')) as status_norm,
        payment_method,
        
    
        NULLIF(BTRIM(subtotal::text), '')::numeric(10, 2)
    
 as subtotal,
        
    
        NULLIF(BTRIM(delivery_fee::text), '')::numeric(10, 2)
    
 as delivery_fee,
        
    
        NULLIF(BTRIM(tip_amount::text), '')::numeric(10, 2)
    
 as tip_amount,
        
    
        NULLIF(BTRIM(distance_km::text), '')::numeric(6, 2)
    
 as distance_km,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."netid1234"."orders"
),
dedup as (
    select *
    from base
    where rn = 1
),
clean as (
    select
        *,
        case
            when status_norm in ('delivered', 'canceled', 'returned') then status_norm
            when status_norm is null or status_norm = '' then 'unknown'
            else 'unknown'
        end as status_final,
        case
            when pickup_ts is not null and dropoff_ts is not null
                then 
    
        EXTRACT(epoch FROM (dropoff_ts - pickup_ts)) / 60.0
    

            else null
        end as delivery_minutes
    from dedup
)
select
    order_id,
    customer_id,
    restaurant_id,
    courier_id,
    order_ts,
    pickup_ts,
    dropoff_ts,
    status_final as status,
    payment_method,
    subtotal,
    delivery_fee,
    tip_amount,
    distance_km,
    delivery_minutes,
    case
        when status_final = 'delivered' and delivery_minutes <= 45 then 
    TRUE

        else 
    FALSE

    end as on_time_flag
from clean
  );
[0m17:47:50.096659 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */

  create view "neondb"."netid1234_netid1234"."stg_restaurants__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."netid1234"."restaurants"
  );
[0m17:47:50.096830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m17:47:50.097032 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */

  create view "neondb"."netid1234_netid1234"."stg_customers__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."netid1234"."customers"
  );
[0m17:47:50.097295 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:47:50.097562 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */

  create view "neondb"."netid1234_netid1234"."stg_couriers__dbt_tmp"
    
    
  as (
    

select
  courier_id,
  courier_name,
  lower(vehicle_type) as vehicle_type,
  active_from,
  active_to,
  region
from "neondb"."netid1234"."couriers"
  );
[0m17:47:50.117894 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "netid1234.customers" does not exist
LINE 11: from "neondb"."netid1234"."customers"
              ^

[0m17:47:50.118471 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "netid1234.orders" does not exist
LINE 53:     from "neondb"."netid1234"."orders"
                  ^

[0m17:47:50.119130 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "netid1234.couriers" does not exist
LINE 16: from "neondb"."netid1234"."couriers"
              ^

[0m17:47:50.120039 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "netid1234.restaurants" does not exist
LINE 11: from "neondb"."netid1234"."restaurants"
              ^

[0m17:47:50.120513 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: ROLLBACK
[0m17:47:50.120985 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: ROLLBACK
[0m17:47:50.121409 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: ROLLBACK
[0m17:47:50.121611 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: ROLLBACK
[0m17:47:50.138397 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: Close
[0m17:47:50.139037 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: Close
[0m17:47:50.139569 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: Close
[0m17:47:50.140022 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: Close
[0m17:47:50.149268 [debug] [Thread-2 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:47:50.150006 [debug] [Thread-3 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:47:50.151804 [debug] [Thread-4 (]: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:47:50.152603 [debug] [Thread-1 (]: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:47:50.152934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a87a600>]}
[0m17:47:50.153078 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72b2c0>]}
[0m17:47:50.153222 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fddc0>]}
[0m17:47:50.153375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2460bc2-2bc3-4aa4-9216-901411c22d5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b709880>]}
[0m17:47:50.153681 [error] [Thread-3 (]: 3 of 10 ERROR creating sql view model netid1234_netid1234.stg_orders ........... [[31mERROR[0m in 0.27s]
[0m17:47:50.153975 [error] [Thread-2 (]: 2 of 10 ERROR creating sql view model netid1234_netid1234.stg_customers ........ [[31mERROR[0m in 0.27s]
[0m17:47:50.154224 [error] [Thread-4 (]: 4 of 10 ERROR creating sql view model netid1234_netid1234.stg_restaurants ...... [[31mERROR[0m in 0.27s]
[0m17:47:50.154490 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model netid1234_netid1234.stg_couriers ......... [[31mERROR[0m in 0.27s]
[0m17:47:50.155261 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.stg_orders
[0m17:47:50.155490 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.stg_customers
[0m17:47:50.155713 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.stg_restaurants
[0m17:47:50.155924 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.stg_couriers
[0m17:47:50.156137 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql.
[0m17:47:50.156685 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql.
[0m17:47:50.156896 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_restaurants' to be skipped because of status 'error'.  Reason: Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql.
[0m17:47:50.157095 [debug] [Thread-3 (]: Began running node model.dashdash_lab.dim_customer
[0m17:47:50.157300 [debug] [Thread-7 (]: Marking all children of 'model.dashdash_lab.stg_couriers' to be skipped because of status 'error'.  Reason: Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql.
[0m17:47:50.157634 [debug] [Thread-4 (]: Began running node model.dashdash_lab.dim_restaurant
[0m17:47:50.157507 [info ] [Thread-3 (]: 5 of 10 SKIP relation netid1234_netid1234.dim_customer ......................... [[33mSKIP[0m]
[0m17:47:50.157922 [debug] [Thread-2 (]: Began running node model.dashdash_lab.dim_courier
[0m17:47:50.158078 [info ] [Thread-4 (]: 6 of 10 SKIP relation netid1234_netid1234.dim_restaurant ....................... [[33mSKIP[0m]
[0m17:47:50.158247 [debug] [Thread-1 (]: Began running node model.dashdash_lab.fct_deliveries
[0m17:47:50.158398 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.dim_customer
[0m17:47:50.158570 [info ] [Thread-2 (]: 7 of 10 SKIP relation netid1234_netid1234.dim_courier .......................... [[33mSKIP[0m]
[0m17:47:50.158770 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.dim_restaurant
[0m17:47:50.158965 [info ] [Thread-1 (]: 8 of 10 SKIP relation netid1234_netid1234.fct_deliveries ....................... [[33mSKIP[0m]
[0m17:47:50.159139 [debug] [Thread-3 (]: Began running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:47:50.159310 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.dim_courier
[0m17:47:50.159516 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.fct_deliveries
[0m17:47:50.159690 [info ] [Thread-3 (]: 9 of 10 SKIP relation netid1234_netid1234.monitoring_dq_exceptions ............. [[33mSKIP[0m]
[0m17:47:50.159948 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:47:50.160145 [debug] [Thread-3 (]: Began running node model.dashdash_lab.kpi_delivery_overview
[0m17:47:50.160321 [info ] [Thread-3 (]: 10 of 10 SKIP relation netid1234_netid1234.kpi_delivery_overview ............... [[33mSKIP[0m]
[0m17:47:50.160488 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.kpi_delivery_overview
[0m17:47:50.161031 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:50.161170 [debug] [MainThread]: On master: BEGIN
[0m17:47:50.161282 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:50.307325 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m17:47:50.308272 [debug] [MainThread]: On master: COMMIT
[0m17:47:50.309115 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:50.309766 [debug] [MainThread]: On master: COMMIT
[0m17:47:50.327036 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m17:47:50.327932 [debug] [MainThread]: On master: Close
[0m17:47:50.329281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:50.329907 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_couriers' was properly closed.
[0m17:47:50.330455 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_customers' was properly closed.
[0m17:47:50.330888 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_orders' was properly closed.
[0m17:47:50.331273 [debug] [MainThread]: Connection 'model.dashdash_lab.stg_restaurants' was properly closed.
[0m17:47:50.331809 [info ] [MainThread]: 
[0m17:47:50.332281 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m17:47:50.333807 [debug] [MainThread]: Command end result
[0m17:47:50.349243 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:47:50.350001 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:47:50.352568 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/run_results.json
[0m17:47:50.352720 [info ] [MainThread]: 
[0m17:47:50.352880 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m17:47:50.353029 [info ] [MainThread]: 
[0m17:47:50.353199 [error] [MainThread]: [31mFailure in model stg_orders (models/staging/stg_orders.sql)[0m
[0m17:47:50.353359 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  relation "netid1234.orders" does not exist
  LINE 53:     from "neondb"."netid1234"."orders"
                    ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.sql
[0m17:47:50.353482 [info ] [MainThread]: 
[0m17:47:50.353621 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.sql
[0m17:47:50.353741 [info ] [MainThread]: 
[0m17:47:50.353883 [error] [MainThread]: [31mFailure in model stg_customers (models/staging/stg_customers.sql)[0m
[0m17:47:50.354031 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  relation "netid1234.customers" does not exist
  LINE 11: from "neondb"."netid1234"."customers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_customers.sql
[0m17:47:50.354165 [info ] [MainThread]: 
[0m17:47:50.354313 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_customers.sql
[0m17:47:50.354438 [info ] [MainThread]: 
[0m17:47:50.354580 [error] [MainThread]: [31mFailure in model stg_restaurants (models/staging/stg_restaurants.sql)[0m
[0m17:47:50.354729 [error] [MainThread]:   Database Error in model stg_restaurants (models/staging/stg_restaurants.sql)
  relation "netid1234.restaurants" does not exist
  LINE 11: from "neondb"."netid1234"."restaurants"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:47:50.354848 [info ] [MainThread]: 
[0m17:47:50.354983 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_restaurants.sql
[0m17:47:50.355098 [info ] [MainThread]: 
[0m17:47:50.355238 [error] [MainThread]: [31mFailure in model stg_couriers (models/staging/stg_couriers.sql)[0m
[0m17:47:50.355382 [error] [MainThread]:   Database Error in model stg_couriers (models/staging/stg_couriers.sql)
  relation "netid1234.couriers" does not exist
  LINE 16: from "neondb"."netid1234"."couriers"
                ^
  compiled code at target/run/dashdash_lab/models/staging/stg_couriers.sql
[0m17:47:50.355499 [info ] [MainThread]: 
[0m17:47:50.355634 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_couriers.sql
[0m17:47:50.355748 [info ] [MainThread]: 
[0m17:47:50.355884 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=6 NO-OP=0 TOTAL=10
[0m17:47:50.357360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5266241, "process_in_blocks": "0", "process_kernel_time": 0.203401, "process_mem_max_rss": "134463488", "process_out_blocks": "0", "process_user_time": 1.109162}
[0m17:47:50.357562 [debug] [MainThread]: Command `dbt run` failed at 17:47:50.357527 after 1.53 seconds
[0m17:47:50.357732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab57ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab57bc0>]}
[0m17:47:50.357887 [debug] [MainThread]: Flushing usage events
[0m17:47:50.437953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:28.973202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1231b48c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126358b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12635a2d0>]}


============================== 17:48:28.975977 | 8b2d981c-25c2-418c-8176-e65ac5c38fc2 ==============================
[0m17:48:28.975977 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:48:28.976298 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'write_json': 'True', 'introspect': 'True'}
[0m17:48:29.054701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2d981c-25c2-418c-8176-e65ac5c38fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12782b980>]}
[0m17:48:29.077923 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-lbbjloto'
[0m17:48:29.078193 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:48:29.141520 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:48:29.142546 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:48:29.204341 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:48:29.206605 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:48:29.357448 [info ] [MainThread]: Installed from version 1.1.1
[0m17:48:29.357715 [info ] [MainThread]: Updated version available: 1.3.1
[0m17:48:29.357929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8b2d981c-25c2-418c-8176-e65ac5c38fc2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150534e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15046bce0>]}
[0m17:48:29.358143 [info ] [MainThread]: 
[0m17:48:29.358311 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:48:29.359921 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4217276, "process_in_blocks": "0", "process_kernel_time": 0.170112, "process_mem_max_rss": "114786304", "process_out_blocks": "0", "process_user_time": 0.761156}
[0m17:48:29.360168 [debug] [MainThread]: Command `dbt deps` succeeded at 17:48:29.360125 after 0.42 seconds
[0m17:48:29.360330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1503ee5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150498440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1505aa7b0>]}
[0m17:48:29.360485 [debug] [MainThread]: Flushing usage events
[0m17:48:29.435628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:30.240177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107090950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070902c0>]}


============================== 17:48:30.242213 | 5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf ==============================
[0m17:48:30.242213 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:48:30.242521 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'static_parser': 'True', 'no_print': 'None', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'version_check': 'True', 'partial_parse': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m17:48:30.349876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107475fd0>]}
[0m17:48:30.381826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076163c0>]}
[0m17:48:30.382618 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:48:30.435016 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:48:30.480062 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:48:30.480391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bb4d0>]}
[0m17:48:31.064333 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:48:31.064642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb1760>]}
[0m17:48:31.131416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823e6f0>]}
[0m17:48:31.165647 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:48:31.166787 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:48:31.174986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fee40>]}
[0m17:48:31.175238 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:48:31.175403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108199310>]}
[0m17:48:31.176353 [info ] [MainThread]: 
[0m17:48:31.176529 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:31.176655 [info ] [MainThread]: 
[0m17:48:31.176872 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:31.178649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m17:48:31.204561 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m17:48:31.204834 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m17:48:31.204981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:31.370868 [debug] [ThreadPool]: SQL status: SELECT 102 in 0.166 seconds
[0m17:48:31.371675 [debug] [ThreadPool]: On list_neondb: Close
[0m17:48:31.372507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public_public)
[0m17:48:31.375054 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:48:31.375234 [debug] [ThreadPool]: On list_neondb_public_public: BEGIN
[0m17:48:31.375374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:31.541205 [debug] [ThreadPool]: SQL status: BEGIN in 0.166 seconds
[0m17:48:31.542748 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:48:31.544144 [debug] [ThreadPool]: On list_neondb_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_public_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m17:48:31.569110 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.024 seconds
[0m17:48:31.571886 [debug] [ThreadPool]: On list_neondb_public_public: ROLLBACK
[0m17:48:31.596599 [debug] [ThreadPool]: On list_neondb_public_public: Close
[0m17:48:31.607589 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:31.608190 [debug] [MainThread]: On master: BEGIN
[0m17:48:31.608613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:31.786541 [debug] [MainThread]: SQL status: BEGIN in 0.178 seconds
[0m17:48:31.787325 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:31.787971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:48:31.814812 [debug] [MainThread]: SQL status: SELECT 62 in 0.026 seconds
[0m17:48:31.822028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f71d60>]}
[0m17:48:31.823000 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:31.839987 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:31.840708 [debug] [MainThread]: On master: BEGIN
[0m17:48:31.875308 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m17:48:31.876282 [debug] [MainThread]: On master: COMMIT
[0m17:48:31.877034 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:31.877635 [debug] [MainThread]: On master: COMMIT
[0m17:48:31.894855 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m17:48:31.896069 [debug] [MainThread]: On master: Close
[0m17:48:31.902072 [debug] [Thread-1 (]: Began running node model.dashdash_lab.stg_couriers
[0m17:48:31.902887 [debug] [Thread-2 (]: Began running node model.dashdash_lab.stg_customers
[0m17:48:31.903491 [debug] [Thread-3 (]: Began running node model.dashdash_lab.stg_orders
[0m17:48:31.904166 [debug] [Thread-4 (]: Began running node model.dashdash_lab.stg_restaurants
[0m17:48:31.905030 [info ] [Thread-1 (]: 1 of 10 START sql view model public_public.stg_couriers ........................ [RUN]
[0m17:48:31.905743 [info ] [Thread-2 (]: 2 of 10 START sql view model public_public.stg_customers ....................... [RUN]
[0m17:48:31.906399 [info ] [Thread-3 (]: 3 of 10 START sql view model public_public.stg_orders .......................... [RUN]
[0m17:48:31.907030 [info ] [Thread-4 (]: 4 of 10 START sql view model public_public.stg_restaurants ..................... [RUN]
[0m17:48:31.907661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public_public, now model.dashdash_lab.stg_couriers)
[0m17:48:31.908287 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_customers'
[0m17:48:31.908857 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_orders'
[0m17:48:31.909416 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_restaurants'
[0m17:48:31.909864 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.stg_couriers
[0m17:48:31.910304 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.stg_customers
[0m17:48:31.910739 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.stg_orders
[0m17:48:31.910932 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.stg_restaurants
[0m17:48:31.943502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.stg_couriers"
[0m17:48:31.944729 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.stg_customers"
[0m17:48:31.946822 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.stg_orders"
[0m17:48:31.947898 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.stg_restaurants"
[0m17:48:31.948399 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.stg_couriers
[0m17:48:31.948568 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.stg_customers
[0m17:48:31.948735 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.stg_orders
[0m17:48:31.954424 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.stg_restaurants
[0m17:48:31.963562 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.stg_couriers"
[0m17:48:31.965027 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.stg_customers"
[0m17:48:31.966279 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.stg_orders"
[0m17:48:31.968406 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.stg_restaurants"
[0m17:48:31.969021 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:48:31.969233 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: BEGIN
[0m17:48:31.969452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:31.969680 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:48:31.969946 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:48:31.970134 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:48:31.970305 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: BEGIN
[0m17:48:31.970473 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: BEGIN
[0m17:48:31.970626 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: BEGIN
[0m17:48:31.970772 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:48:31.970919 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:48:31.971061 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:48:32.123070 [debug] [Thread-3 (]: SQL status: BEGIN in 0.152 seconds
[0m17:48:32.123582 [debug] [Thread-4 (]: SQL status: BEGIN in 0.152 seconds
[0m17:48:32.123970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.154 seconds
[0m17:48:32.124406 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:48:32.124797 [debug] [Thread-2 (]: SQL status: BEGIN in 0.154 seconds
[0m17:48:32.125228 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:48:32.125635 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:48:32.126240 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */

  create view "neondb"."public_public"."stg_orders__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(nullif(trim(status), '')) as status_norm,
        payment_method,
        
    
        NULLIF(BTRIM(subtotal::text), '')::numeric(10, 2)
    
 as subtotal,
        
    
        NULLIF(BTRIM(delivery_fee::text), '')::numeric(10, 2)
    
 as delivery_fee,
        
    
        NULLIF(BTRIM(tip_amount::text), '')::numeric(10, 2)
    
 as tip_amount,
        
    
        NULLIF(BTRIM(distance_km::text), '')::numeric(6, 2)
    
 as distance_km,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."public"."orders"
),
dedup as (
    select *
    from base
    where rn = 1
),
clean as (
    select
        *,
        case
            when status_norm in ('delivered', 'canceled', 'returned') then status_norm
            when status_norm is null or status_norm = '' then 'unknown'
            else 'unknown'
        end as status_final,
        case
            when pickup_ts is not null and dropoff_ts is not null
                then 
    
        EXTRACT(epoch FROM (dropoff_ts - pickup_ts)) / 60.0
    

            else null
        end as delivery_minutes
    from dedup
)
select
    order_id,
    customer_id,
    restaurant_id,
    courier_id,
    order_ts,
    pickup_ts,
    dropoff_ts,
    status_final as status,
    payment_method,
    subtotal,
    delivery_fee,
    tip_amount,
    distance_km,
    delivery_minutes,
    case
        when status_final = 'delivered' and delivery_minutes <= 45 then 
    TRUE

        else 
    FALSE

    end as on_time_flag
from clean
  );
[0m17:48:32.126658 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:48:32.126845 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */

  create view "neondb"."public_public"."stg_restaurants__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."public"."restaurants"
  );
[0m17:48:32.127042 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */

  create view "neondb"."public_public"."stg_couriers__dbt_tmp"
    
    
  as (
    

select
  courier_id,
  courier_name,
  lower(vehicle_type) as vehicle_type,
  active_from,
  active_to,
  region
from "neondb"."public"."couriers"
  );
[0m17:48:32.127270 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */

  create view "neondb"."public_public"."stg_customers__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."public"."customers"
  );
[0m17:48:32.148369 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m17:48:32.155222 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:48:32.155412 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m17:48:32.155558 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m17:48:32.155732 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */
alter table "neondb"."public_public"."stg_couriers__dbt_tmp" rename to "stg_couriers"
[0m17:48:32.157051 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:48:32.157230 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m17:48:32.158535 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:48:32.158770 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */
alter table "neondb"."public_public"."stg_restaurants__dbt_tmp" rename to "stg_restaurants"
[0m17:48:32.160006 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:48:32.160194 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */
alter table "neondb"."public_public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:48:32.160414 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */
alter table "neondb"."public_public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:48:32.175146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:48:32.180826 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: COMMIT
[0m17:48:32.181007 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m17:48:32.181170 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m17:48:32.181316 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:48:32.181447 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m17:48:32.181906 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: COMMIT
[0m17:48:32.182337 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: COMMIT
[0m17:48:32.182494 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: COMMIT
[0m17:48:32.182928 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: COMMIT
[0m17:48:32.183084 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:48:32.183230 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:48:32.183417 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:48:32.183590 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: COMMIT
[0m17:48:32.183741 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: COMMIT
[0m17:48:32.183907 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: COMMIT
[0m17:48:32.205352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m17:48:32.205515 [debug] [Thread-3 (]: SQL status: COMMIT in 0.021 seconds
[0m17:48:32.205679 [debug] [Thread-4 (]: SQL status: COMMIT in 0.022 seconds
[0m17:48:32.208192 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."stg_couriers__dbt_backup"
[0m17:48:32.208340 [debug] [Thread-2 (]: SQL status: COMMIT in 0.024 seconds
[0m17:48:32.209258 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."stg_orders__dbt_backup"
[0m17:48:32.210154 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."stg_restaurants__dbt_backup"
[0m17:48:32.211991 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:48:32.213555 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_public"."stg_customers__dbt_backup"
[0m17:48:32.213777 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:48:32.213987 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:48:32.214148 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */
drop view if exists "neondb"."public_public"."stg_couriers__dbt_backup" cascade
[0m17:48:32.214362 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:48:32.214524 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */
drop view if exists "neondb"."public_public"."stg_orders__dbt_backup" cascade
[0m17:48:32.214687 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */
drop view if exists "neondb"."public_public"."stg_restaurants__dbt_backup" cascade
[0m17:48:32.214882 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */
drop view if exists "neondb"."public_public"."stg_customers__dbt_backup" cascade
[0m17:48:32.235745 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.021 seconds
[0m17:48:32.235911 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.021 seconds
[0m17:48:32.236060 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.021 seconds
[0m17:48:32.236194 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m17:48:32.237174 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: Close
[0m17:48:32.237666 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: Close
[0m17:48:32.238123 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: Close
[0m17:48:32.238571 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: Close
[0m17:48:32.240253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a5670>]}
[0m17:48:32.240407 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a5250>]}
[0m17:48:32.240555 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e726f0>]}
[0m17:48:32.240825 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public_public.stg_couriers ................... [[32mCREATE VIEW[0m in 0.33s]
[0m17:48:32.240982 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868c050>]}
[0m17:48:32.241220 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public_public.stg_restaurants ................ [[32mCREATE VIEW[0m in 0.33s]
[0m17:48:32.241485 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public_public.stg_orders ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m17:48:32.241723 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.stg_couriers
[0m17:48:32.241948 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public_public.stg_customers .................. [[32mCREATE VIEW[0m in 0.33s]
[0m17:48:32.242182 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.stg_restaurants
[0m17:48:32.242394 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.stg_orders
[0m17:48:32.242663 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_courier
[0m17:48:32.242871 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.stg_customers
[0m17:48:32.243112 [debug] [Thread-4 (]: Began running node model.dashdash_lab.dim_restaurant
[0m17:48:32.243270 [debug] [Thread-3 (]: Began running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:48:32.243477 [info ] [Thread-1 (]: 5 of 10 START sql view model public_public.dim_courier ......................... [RUN]
[0m17:48:32.243667 [debug] [Thread-2 (]: Began running node model.dashdash_lab.fct_deliveries
[0m17:48:32.243888 [info ] [Thread-4 (]: 6 of 10 START sql view model public_public.dim_restaurant ...................... [RUN]
[0m17:48:32.244106 [info ] [Thread-3 (]: 7 of 10 START sql view model public_public.monitoring_dq_exceptions ............ [RUN]
[0m17:48:32.244294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_couriers, now model.dashdash_lab.dim_courier)
[0m17:48:32.244488 [info ] [Thread-2 (]: 8 of 10 START sql view model public_public.fct_deliveries ...................... [RUN]
[0m17:48:32.244663 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_restaurants, now model.dashdash_lab.dim_restaurant)
[0m17:48:32.244837 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_orders, now model.dashdash_lab.monitoring_dq_exceptions)
[0m17:48:32.244996 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.dim_courier
[0m17:48:32.245157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_customers, now model.dashdash_lab.fct_deliveries)
[0m17:48:32.245305 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.dim_restaurant
[0m17:48:32.245454 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.monitoring_dq_exceptions
[0m17:48:32.246782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.dim_courier"
[0m17:48:32.246945 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.fct_deliveries
[0m17:48:32.248026 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.dim_restaurant"
[0m17:48:32.249817 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:48:32.251190 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.fct_deliveries"
[0m17:48:32.251477 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.dim_courier
[0m17:48:32.251772 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.dim_restaurant
[0m17:48:32.253087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.dim_courier"
[0m17:48:32.253263 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.monitoring_dq_exceptions
[0m17:48:32.253417 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.fct_deliveries
[0m17:48:32.254671 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.dim_restaurant"
[0m17:48:32.255973 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:48:32.257160 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.fct_deliveries"
[0m17:48:32.257384 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:48:32.257662 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:48:32.257834 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: BEGIN
[0m17:48:32.258014 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: BEGIN
[0m17:48:32.258196 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:48:32.258387 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:48:32.258549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:32.258716 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:32.258890 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: BEGIN
[0m17:48:32.259046 [debug] [Thread-2 (]: On model.dashdash_lab.fct_deliveries: BEGIN
[0m17:48:32.259337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:32.259520 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:32.409586 [debug] [Thread-2 (]: SQL status: BEGIN in 0.150 seconds
[0m17:48:32.410196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m17:48:32.410732 [debug] [Thread-4 (]: SQL status: BEGIN in 0.152 seconds
[0m17:48:32.411329 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:48:32.411807 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:48:32.412270 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:48:32.412733 [debug] [Thread-2 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */

  create view "neondb"."public_public"."fct_deliveries__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_orders" as o
where o.status = 'delivered'
  and o.restaurant_id in (select restaurant_id from "neondb"."public_public"."stg_restaurants")
  and (
        o.courier_id is null
        or o.courier_id in (select courier_id from "neondb"."public_public"."stg_couriers")
      )
  );
[0m17:48:32.413174 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */

  create view "neondb"."public_public"."dim_courier__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_couriers"
  );
[0m17:48:32.413593 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */

  create view "neondb"."public_public"."dim_restaurant__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_restaurants"
  );
[0m17:48:32.413994 [debug] [Thread-3 (]: SQL status: BEGIN in 0.155 seconds
[0m17:48:32.414517 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:48:32.414770 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */

  create view "neondb"."public_public"."monitoring_dq_exceptions__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(trim(coalesce(status, ''))) as status_norm,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."public"."orders"
),
dupes as (
    select order_id, 'duplicate_order' as reason
    from base
    where rn > 1
),
bad_rest_fk as (
    select o.order_id, 'bad_fk_restaurant' as reason
    from "neondb"."public"."orders" as o
    left join "neondb"."public_public"."stg_restaurants" as r on o.restaurant_id = r.restaurant_id
    where r.restaurant_id is null
),
bad_cour_fk as (
    select o.order_id, 'bad_fk_courier' as reason
    from "neondb"."public"."orders" as o
    left join "neondb"."public_public"."stg_couriers" as c on o.courier_id = c.courier_id
    where o.courier_id is not null and c.courier_id is null
),
unknown_status as (
    select order_id, 'status_unknown' as reason
    from base
    where status_norm is null or status_norm not in ('delivered', 'canceled', 'returned')
)
select distinct order_id, reason
from (
    select * from dupes
    union all
    select * from bad_rest_fk
    union all
    select * from bad_cour_fk
    union all
    select * from unknown_status
) as unioned
order by order_id, reason
  );
[0m17:48:32.434585 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:48:32.439875 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:48:32.440078 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m17:48:32.440266 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m17:48:32.440457 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */
alter table "neondb"."public_public"."dim_restaurant__dbt_tmp" rename to "dim_restaurant"
[0m17:48:32.440612 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m17:48:32.441953 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:48:32.443075 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:48:32.444319 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:48:32.444503 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */
alter table "neondb"."public_public"."monitoring_dq_exceptions__dbt_tmp" rename to "monitoring_dq_exceptions"
[0m17:48:32.444671 [debug] [Thread-2 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */
alter table "neondb"."public_public"."fct_deliveries__dbt_tmp" rename to "fct_deliveries"
[0m17:48:32.444830 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */
alter table "neondb"."public_public"."dim_courier__dbt_tmp" rename to "dim_courier"
[0m17:48:32.460670 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m17:48:32.461220 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: COMMIT
[0m17:48:32.461376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:48:32.461543 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:48:32.462060 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: COMMIT
[0m17:48:32.462226 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: COMMIT
[0m17:48:32.462387 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:48:32.462521 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m17:48:32.462661 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m17:48:32.462830 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: COMMIT
[0m17:48:32.463292 [debug] [Thread-2 (]: On model.dashdash_lab.fct_deliveries: COMMIT
[0m17:48:32.463745 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: COMMIT
[0m17:48:32.463926 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:48:32.464084 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:48:32.464320 [debug] [Thread-2 (]: On model.dashdash_lab.fct_deliveries: COMMIT
[0m17:48:32.464950 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: COMMIT
[0m17:48:32.484211 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m17:48:32.484701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m17:48:32.485100 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m17:48:32.485508 [debug] [Thread-4 (]: SQL status: COMMIT in 0.023 seconds
[0m17:48:32.487656 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_public"."fct_deliveries__dbt_backup"
[0m17:48:32.488595 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."dim_courier__dbt_backup"
[0m17:48:32.489447 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."monitoring_dq_exceptions__dbt_backup"
[0m17:48:32.490312 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."dim_restaurant__dbt_backup"
[0m17:48:32.490537 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:48:32.490748 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:48:32.490953 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:48:32.491168 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:48:32.491326 [debug] [Thread-2 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */
drop view if exists "neondb"."public_public"."fct_deliveries__dbt_backup" cascade
[0m17:48:32.491480 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */
drop view if exists "neondb"."public_public"."dim_courier__dbt_backup" cascade
[0m17:48:32.491637 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */
drop view if exists "neondb"."public_public"."monitoring_dq_exceptions__dbt_backup" cascade
[0m17:48:32.491790 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */
drop view if exists "neondb"."public_public"."dim_restaurant__dbt_backup" cascade
[0m17:48:32.509609 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.018 seconds
[0m17:48:32.511239 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: Close
[0m17:48:32.511612 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.020 seconds
[0m17:48:32.511963 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.020 seconds
[0m17:48:32.512279 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.020 seconds
[0m17:48:32.513240 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: Close
[0m17:48:32.513473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863c9e0>]}
[0m17:48:32.513984 [debug] [Thread-2 (]: On model.dashdash_lab.fct_deliveries: Close
[0m17:48:32.514449 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: Close
[0m17:48:32.514934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8b770>]}
[0m17:48:32.514750 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public_public.dim_courier .................... [[32mCREATE VIEW[0m in 0.27s]
[0m17:48:32.515289 [info ] [Thread-3 (]: 7 of 10 OK created sql view model public_public.monitoring_dq_exceptions ....... [[32mCREATE VIEW[0m in 0.27s]
[0m17:48:32.515526 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f59b80>]}
[0m17:48:32.515716 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe4f20>]}
[0m17:48:32.515954 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_courier
[0m17:48:32.516170 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:48:32.516414 [info ] [Thread-4 (]: 6 of 10 OK created sql view model public_public.dim_restaurant ................. [[32mCREATE VIEW[0m in 0.27s]
[0m17:48:32.516675 [info ] [Thread-2 (]: 8 of 10 OK created sql view model public_public.fct_deliveries ................. [[32mCREATE VIEW[0m in 0.27s]
[0m17:48:32.516877 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_customer
[0m17:48:32.517167 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.dim_restaurant
[0m17:48:32.517373 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.fct_deliveries
[0m17:48:32.517564 [info ] [Thread-1 (]: 9 of 10 START sql view model public_public.dim_customer ........................ [RUN]
[0m17:48:32.517860 [debug] [Thread-3 (]: Began running node model.dashdash_lab.kpi_delivery_overview
[0m17:48:32.518018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.dim_courier, now model.dashdash_lab.dim_customer)
[0m17:48:32.518211 [info ] [Thread-3 (]: 10 of 10 START sql view model public_public.kpi_delivery_overview .............. [RUN]
[0m17:48:32.518376 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.dim_customer
[0m17:48:32.518532 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.monitoring_dq_exceptions, now model.dashdash_lab.kpi_delivery_overview)
[0m17:48:32.519870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.dim_customer"
[0m17:48:32.520031 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.kpi_delivery_overview
[0m17:48:32.522404 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.kpi_delivery_overview"
[0m17:48:32.522684 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.dim_customer
[0m17:48:32.522854 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.kpi_delivery_overview
[0m17:48:32.524079 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.dim_customer"
[0m17:48:32.525271 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.kpi_delivery_overview"
[0m17:48:32.525562 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:48:32.525731 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: BEGIN
[0m17:48:32.525876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:32.526033 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:48:32.526245 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: BEGIN
[0m17:48:32.526382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:32.678040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m17:48:32.678684 [debug] [Thread-3 (]: SQL status: BEGIN in 0.152 seconds
[0m17:48:32.679410 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:48:32.679969 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:48:32.680492 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */

  create view "neondb"."public_public"."dim_customer__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_customers"
  );
[0m17:48:32.681083 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */

  create view "neondb"."public_public"."kpi_delivery_overview__dbt_tmp"
    
    
  as (
    

with d as (
    select *
    from "neondb"."public_public"."fct_deliveries"
)
select
    
    
        AVG(CASE WHEN on_time_flag THEN 1 ELSE 0 END)::numeric(5, 4)
    
 as on_time_rate,
    
    
        AVG(delivery_minutes)::numeric(6, 2)
    
 as avg_delivery_minutes,
    (
        select 
    
        (COUNT(*) FILTER (WHERE status IN ('canceled', 'returned'))::numeric / NULLIF(COUNT(*), 0))
    

        from "neondb"."public_public"."stg_orders"
    ) as cancel_return_rate
from d
  );
[0m17:48:32.701161 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m17:48:32.702296 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:48:32.707330 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:48:32.711050 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:48:32.711568 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */
alter table "neondb"."public_public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:48:32.711972 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */
alter table "neondb"."public_public"."kpi_delivery_overview__dbt_tmp" rename to "kpi_delivery_overview"
[0m17:48:32.728760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:48:32.730387 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: COMMIT
[0m17:48:32.730880 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:48:32.731377 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: COMMIT
[0m17:48:32.732442 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m17:48:32.734349 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: COMMIT
[0m17:48:32.734943 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:48:32.735330 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: COMMIT
[0m17:48:32.752350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m17:48:32.755426 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."dim_customer__dbt_backup"
[0m17:48:32.756143 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:48:32.756521 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */
drop view if exists "neondb"."public_public"."dim_customer__dbt_backup" cascade
[0m17:48:32.766563 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m17:48:32.769698 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."kpi_delivery_overview__dbt_backup"
[0m17:48:32.770315 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:48:32.770755 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */
drop view if exists "neondb"."public_public"."kpi_delivery_overview__dbt_backup" cascade
[0m17:48:32.773980 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m17:48:32.774625 [debug] [Thread-1 (]: On model.dashdash_lab.dim_customer: Close
[0m17:48:32.774966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087043e0>]}
[0m17:48:32.775274 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public_public.dim_customer ................... [[32mCREATE VIEW[0m in 0.26s]
[0m17:48:32.775523 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_customer
[0m17:48:32.787274 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m17:48:32.788882 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: Close
[0m17:48:32.789758 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a64fe3a-ca50-43e2-aa53-2ebb9c4b36cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108003ad0>]}
[0m17:48:32.790498 [info ] [Thread-3 (]: 10 of 10 OK created sql view model public_public.kpi_delivery_overview ......... [[32mCREATE VIEW[0m in 0.27s]
[0m17:48:32.791077 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.kpi_delivery_overview
[0m17:48:32.792154 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:32.792549 [debug] [MainThread]: On master: BEGIN
[0m17:48:32.792747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:32.941772 [debug] [MainThread]: SQL status: BEGIN in 0.149 seconds
[0m17:48:32.943654 [debug] [MainThread]: On master: COMMIT
[0m17:48:32.944721 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:32.945461 [debug] [MainThread]: On master: COMMIT
[0m17:48:32.963604 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m17:48:32.965010 [debug] [MainThread]: On master: Close
[0m17:48:32.966621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:32.967215 [debug] [MainThread]: Connection 'model.dashdash_lab.dim_customer' was properly closed.
[0m17:48:32.967874 [debug] [MainThread]: Connection 'model.dashdash_lab.fct_deliveries' was properly closed.
[0m17:48:32.969414 [debug] [MainThread]: Connection 'model.dashdash_lab.kpi_delivery_overview' was properly closed.
[0m17:48:32.970034 [debug] [MainThread]: Connection 'model.dashdash_lab.dim_restaurant' was properly closed.
[0m17:48:32.970750 [info ] [MainThread]: 
[0m17:48:32.971351 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m17:48:32.974160 [debug] [MainThread]: Command end result
[0m17:48:32.992051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:48:32.992845 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:48:32.995354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/run_results.json
[0m17:48:32.995519 [info ] [MainThread]: 
[0m17:48:32.995681 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:32.995815 [info ] [MainThread]: 
[0m17:48:32.995959 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m17:48:32.996195 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:48:32.997669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7915587, "process_in_blocks": "0", "process_kernel_time": 0.208463, "process_mem_max_rss": "146489344", "process_out_blocks": "0", "process_user_time": 1.840812}
[0m17:48:32.997888 [debug] [MainThread]: Command `dbt run` succeeded at 17:48:32.997850 after 2.79 seconds
[0m17:48:32.998058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076141a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108363020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8b770>]}
[0m17:48:32.998222 [debug] [MainThread]: Flushing usage events
[0m17:48:33.084542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:33.904737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a898890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a898200>]}


============================== 17:48:33.906867 | 6b46a805-e04b-482d-8e13-a5787254583e ==============================
[0m17:48:33.906867 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:48:33.907172 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'introspect': 'True', 'invocation_command': 'dbt test --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'no_print': 'None', 'log_path': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'empty': 'None', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/_profiles', 'partial_parse': 'True', 'static_parser': 'True'}
[0m17:48:34.006537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b46a805-e04b-482d-8e13-a5787254583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeaec30>]}
[0m17:48:34.037047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b46a805-e04b-482d-8e13-a5787254583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4845f0>]}
[0m17:48:34.037490 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:48:34.094575 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:48:34.148401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:34.148629 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:34.167478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b46a805-e04b-482d-8e13-a5787254583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb69f0>]}
[0m17:48:34.203822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:48:34.204698 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:48:34.216091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b46a805-e04b-482d-8e13-a5787254583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce6540>]}
[0m17:48:34.216377 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:48:34.216549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b46a805-e04b-482d-8e13-a5787254583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4b3140>]}
[0m17:48:34.217696 [info ] [MainThread]: 
[0m17:48:34.217891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:34.218026 [info ] [MainThread]: 
[0m17:48:34.218263 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:34.220047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_public'
[0m17:48:34.240559 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:48:34.240813 [debug] [ThreadPool]: On list_neondb_public_public: BEGIN
[0m17:48:34.240952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:34.402121 [debug] [ThreadPool]: SQL status: BEGIN in 0.161 seconds
[0m17:48:34.402389 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:48:34.402551 [debug] [ThreadPool]: On list_neondb_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_public_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m17:48:34.422139 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.019 seconds
[0m17:48:34.422801 [debug] [ThreadPool]: On list_neondb_public_public: ROLLBACK
[0m17:48:34.439552 [debug] [ThreadPool]: On list_neondb_public_public: Close
[0m17:48:34.444473 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:34.444659 [debug] [MainThread]: On master: BEGIN
[0m17:48:34.444787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:34.593153 [debug] [MainThread]: SQL status: BEGIN in 0.148 seconds
[0m17:48:34.594134 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:34.595070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:48:34.616893 [debug] [MainThread]: SQL status: SELECT 77 in 0.021 seconds
[0m17:48:34.625364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b46a805-e04b-482d-8e13-a5787254583e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae28b60>]}
[0m17:48:34.626439 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:34.644145 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:34.644857 [debug] [MainThread]: On master: BEGIN
[0m17:48:34.678593 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m17:48:34.680129 [debug] [MainThread]: On master: COMMIT
[0m17:48:34.680800 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:34.681404 [debug] [MainThread]: On master: COMMIT
[0m17:48:34.698411 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:48:34.699217 [debug] [MainThread]: On master: Close
[0m17:48:34.703912 [debug] [Thread-1 (]: Began running node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:48:34.704650 [debug] [Thread-2 (]: Began running node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:48:34.705279 [debug] [Thread-3 (]: Began running node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:48:34.705895 [debug] [Thread-4 (]: Began running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:48:34.706471 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_dim_courier_vehicle_type__bike__scooter__car  [RUN]
[0m17:48:34.707050 [info ] [Thread-2 (]: 2 of 13 START test accepted_values_stg_couriers_vehicle_type__bike__scooter__car  [RUN]
[0m17:48:34.707617 [info ] [Thread-3 (]: 3 of 13 START test accepted_values_stg_orders_status__delivered__canceled__returned__unknown  [RUN]
[0m17:48:34.708168 [info ] [Thread-4 (]: 4 of 13 START test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0  [RUN]
[0m17:48:34.709107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public_public, now test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3)
[0m17:48:34.710036 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37'
[0m17:48:34.710798 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e'
[0m17:48:34.711369 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486'
[0m17:48:34.711830 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:48:34.712313 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:48:34.712743 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:48:34.713149 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:48:34.720412 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:48:34.722224 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:48:34.753202 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:48:34.757288 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:48:34.758673 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:48:34.758893 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:48:34.759075 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:48:34.766392 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:48:34.767505 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:48:34.767700 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:48:34.768658 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:48:34.769866 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:48:34.770177 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:48:34.770398 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:48:34.770631 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:48:34.770813 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: BEGIN
[0m17:48:34.771010 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: BEGIN
[0m17:48:34.771189 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:48:34.771369 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: BEGIN
[0m17:48:34.771537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:34.771697 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:48:34.771858 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: BEGIN
[0m17:48:34.772005 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:48:34.772268 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:48:34.917574 [debug] [Thread-3 (]: SQL status: BEGIN in 0.146 seconds
[0m17:48:34.917852 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:48:34.918033 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "neondb"."public_public"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'delivered','canceled','returned','unknown'
)



  
  
      
    ) dbt_internal_test
[0m17:48:34.921568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m17:48:34.921761 [debug] [Thread-4 (]: SQL status: BEGIN in 0.149 seconds
[0m17:48:34.921917 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:48:34.922074 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:48:34.922246 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vehicle_type as value_field,
        count(*) as n_records

    from "neondb"."public_public"."dim_courier"
    group by vehicle_type

)

select *
from all_values
where value_field not in (
    'bike','scooter','car'
)



  
  
      
    ) dbt_internal_test
[0m17:48:34.922436 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "neondb"."public_public"."stg_orders"

where not(delivery_minutes delivery_minutes IS NULL OR delivery_minutes >= 0)


  
  
      
    ) dbt_internal_test
[0m17:48:34.922915 [debug] [Thread-2 (]: SQL status: BEGIN in 0.151 seconds
[0m17:48:34.923115 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:48:34.923298 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vehicle_type as value_field,
        count(*) as n_records

    from "neondb"."public_public"."stg_couriers"
    group by vehicle_type

)

select *
from all_values
where value_field not in (
    'bike','scooter','car'
)



  
  
      
    ) dbt_internal_test
[0m17:48:34.935449 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m17:48:34.937347 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: ROLLBACK
[0m17:48:34.938469 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "delivery_minutes"
LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                    ^

[0m17:48:34.938655 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: ROLLBACK
[0m17:48:34.939167 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m17:48:34.939744 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: ROLLBACK
[0m17:48:34.939919 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m17:48:34.940488 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: ROLLBACK
[0m17:48:34.953444 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: Close
[0m17:48:34.954446 [info ] [Thread-3 (]: 3 of 13 PASS accepted_values_stg_orders_status__delivered__canceled__returned__unknown  [[32mPASS[0m in 0.24s]
[0m17:48:34.955117 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:48:34.955656 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: Close
[0m17:48:34.956089 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: Close
[0m17:48:34.956466 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: Close
[0m17:48:34.956796 [debug] [Thread-3 (]: Began running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:48:34.957122 [info ] [Thread-3 (]: 5 of 13 START test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_  [RUN]
[0m17:48:34.957418 [error] [Thread-1 (]: 1 of 13 FAIL 1 accepted_values_dim_courier_vehicle_type__bike__scooter__car .... [[31mFAIL 1[0m in 0.25s]
[0m17:48:34.957685 [error] [Thread-2 (]: 2 of 13 FAIL 1 accepted_values_stg_couriers_vehicle_type__bike__scooter__car ... [[31mFAIL 1[0m in 0.25s]
[0m17:48:34.957893 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e, now test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3)
[0m17:48:34.958646 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:48:34.958895 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:48:34.959084 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:48:34.959270 [debug] [Thread-1 (]: Began running node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:48:34.959463 [debug] [Thread-2 (]: Began running node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:48:34.961636 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:48:34.961871 [info ] [Thread-1 (]: 6 of 13 START test not_null_fct_deliveries_order_id ............................ [RUN]
[0m17:48:34.962122 [info ] [Thread-2 (]: 7 of 13 START test not_null_stg_orders_order_id ................................ [RUN]
[0m17:48:34.962399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3, now test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4)
[0m17:48:34.962595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37, now test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:48:34.962820 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:48:34.963020 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:48:34.963169 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:48:34.965746 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:48:34.967251 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:48:34.969168 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:48:34.969548 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:48:34.970462 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:48:34.970730 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:48:34.970916 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:48:34.971817 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:48:34.971985 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:48:34.972165 [debug] [Thread-3 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: BEGIN
[0m17:48:34.972399 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: BEGIN
[0m17:48:34.972593 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:34.972815 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:48:34.972983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:34.973245 [debug] [Thread-2 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m17:48:34.973488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:34.975110 [debug] [Thread-4 (]: Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m17:48:34.975372 [error] [Thread-4 (]: 4 of 13 ERROR dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0  [[31mERROR[0m in 0.26s]
[0m17:48:34.975648 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:48:34.975838 [debug] [Thread-4 (]: Began running node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:48:34.976045 [debug] [Thread-7 (]: Marking all children of 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql.
[0m17:48:34.976246 [info ] [Thread-4 (]: 8 of 13 START test relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_  [RUN]
[0m17:48:34.976761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486, now test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447)
[0m17:48:34.976943 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:48:34.980260 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:48:34.980586 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:48:34.981504 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:48:34.981783 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:48:34.981937 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: BEGIN
[0m17:48:34.982076 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:35.127522 [debug] [Thread-3 (]: SQL status: BEGIN in 0.155 seconds
[0m17:48:35.128128 [debug] [Thread-2 (]: SQL status: BEGIN in 0.155 seconds
[0m17:48:35.128630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m17:48:35.129119 [debug] [Thread-4 (]: SQL status: BEGIN in 0.147 seconds
[0m17:48:35.129651 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:48:35.130148 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:48:35.130606 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:48:35.131142 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:48:35.131754 [debug] [Thread-3 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "neondb"."public_public"."stg_orders"

where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS NOT NULL) OR (status IN ('canceled','returned','unknown') AND dropoff_ts IS NULL))


  
  
      
    ) dbt_internal_test
[0m17:48:35.132361 [debug] [Thread-2 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "neondb"."public_public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:48:35.132877 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "neondb"."public_public"."fct_deliveries"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:48:35.133349 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select courier_id as from_field
    from (select * from "neondb"."public_public"."fct_deliveries" where courier_id IS NOT NULL) dbt_subquery
    where courier_id is not null
),

parent as (
    select courier_id as to_field
    from "neondb"."public_public"."dim_courier"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:48:35.151431 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function dropoff_ts(boolean) does not exist
LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m17:48:35.152032 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m17:48:35.152739 [debug] [Thread-3 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: ROLLBACK
[0m17:48:35.154712 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: ROLLBACK
[0m17:48:35.155358 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m17:48:35.155809 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m17:48:35.157210 [debug] [Thread-2 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m17:48:35.158336 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: ROLLBACK
[0m17:48:35.171676 [debug] [Thread-3 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: Close
[0m17:48:35.172089 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: Close
[0m17:48:35.174412 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: Close
[0m17:48:35.174060 [info ] [Thread-1 (]: 6 of 13 PASS not_null_fct_deliveries_order_id .................................. [[32mPASS[0m in 0.21s]
[0m17:48:35.174880 [debug] [Thread-2 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:48:35.176060 [debug] [Thread-3 (]: Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m17:48:35.176326 [info ] [Thread-4 (]: 8 of 13 PASS relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_  [[32mPASS[0m in 0.20s]
[0m17:48:35.176566 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:48:35.176834 [error] [Thread-3 (]: 5 of 13 ERROR dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_  [[31mERROR[0m in 0.22s]
[0m17:48:35.177098 [info ] [Thread-2 (]: 7 of 13 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.21s]
[0m17:48:35.177357 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:48:35.177553 [debug] [Thread-1 (]: Began running node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:48:35.177846 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:48:35.178084 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:48:35.178265 [debug] [Thread-4 (]: Began running node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:48:35.178456 [info ] [Thread-1 (]: 9 of 13 START test relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_  [RUN]
[0m17:48:35.178640 [debug] [Thread-3 (]: Began running node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:48:35.178848 [debug] [Thread-7 (]: Marking all children of 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql.
[0m17:48:35.179040 [debug] [Thread-2 (]: Began running node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:48:35.179202 [info ] [Thread-4 (]: 10 of 13 START test relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_  [RUN]
[0m17:48:35.179400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4, now test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501)
[0m17:48:35.179574 [info ] [Thread-3 (]: 11 of 13 START test relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_  [RUN]
[0m17:48:35.179783 [info ] [Thread-2 (]: 12 of 13 START test unique_fct_deliveries_order_id ............................. [RUN]
[0m17:48:35.179959 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447, now test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c)
[0m17:48:35.180121 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:48:35.180279 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3, now test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465)
[0m17:48:35.180436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64, now test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a)
[0m17:48:35.180588 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:48:35.182979 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:48:35.183161 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:48:35.183311 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:48:35.185221 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:48:35.187395 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:48:35.189751 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:48:35.190020 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:48:35.192151 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:48:35.192365 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:48:35.193406 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:48:35.193585 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:48:35.193813 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:48:35.194731 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:48:35.194970 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:48:35.195877 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:48:35.196104 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:48:35.196268 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: BEGIN
[0m17:48:35.196487 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: BEGIN
[0m17:48:35.196670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:35.196848 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:48:35.196989 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:35.197154 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:48:35.197373 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: BEGIN
[0m17:48:35.197605 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: BEGIN
[0m17:48:35.197767 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:35.197925 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:35.351555 [debug] [Thread-2 (]: SQL status: BEGIN in 0.154 seconds
[0m17:48:35.352246 [debug] [Thread-3 (]: SQL status: BEGIN in 0.154 seconds
[0m17:48:35.352755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m17:48:35.353240 [debug] [Thread-4 (]: SQL status: BEGIN in 0.156 seconds
[0m17:48:35.353820 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:48:35.354350 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:48:35.354840 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:48:35.355321 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:48:35.355788 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "neondb"."public_public"."fct_deliveries"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:48:35.356305 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select restaurant_id as from_field
    from "neondb"."public_public"."stg_orders"
    where restaurant_id is not null
),

parent as (
    select restaurant_id as to_field
    from "neondb"."public_public"."stg_restaurants"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:48:35.356838 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select restaurant_id as from_field
    from "neondb"."public_public"."fct_deliveries"
    where restaurant_id is not null
),

parent as (
    select restaurant_id as to_field
    from "neondb"."public_public"."dim_restaurant"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:48:35.357319 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select courier_id as from_field
    from (select * from "neondb"."public_public"."stg_orders" where courier_id IS NOT NULL) dbt_subquery
    where courier_id is not null
),

parent as (
    select courier_id as to_field
    from "neondb"."public_public"."stg_couriers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:48:35.375793 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m17:48:35.376369 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.019 seconds
[0m17:48:35.378538 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: ROLLBACK
[0m17:48:35.379119 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m17:48:35.379545 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m17:48:35.381131 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: ROLLBACK
[0m17:48:35.382659 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: ROLLBACK
[0m17:48:35.383517 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: ROLLBACK
[0m17:48:35.397733 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: Close
[0m17:48:35.398723 [error] [Thread-3 (]: 11 of 13 FAIL 1 relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_  [[31mFAIL 1[0m in 0.22s]
[0m17:48:35.399337 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:48:35.399764 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: Close
[0m17:48:35.400094 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: Close
[0m17:48:35.400424 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: Close
[0m17:48:35.400809 [debug] [Thread-3 (]: Began running node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:48:35.401142 [info ] [Thread-3 (]: 13 of 13 START test unique_stg_orders_order_id ................................. [RUN]
[0m17:48:35.401435 [info ] [Thread-1 (]: 9 of 13 PASS relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_  [[32mPASS[0m in 0.22s]
[0m17:48:35.401700 [info ] [Thread-2 (]: 12 of 13 PASS unique_fct_deliveries_order_id ................................... [[32mPASS[0m in 0.22s]
[0m17:48:35.401907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465, now test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a)
[0m17:48:35.402123 [info ] [Thread-4 (]: 10 of 13 PASS relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_  [[32mPASS[0m in 0.22s]
[0m17:48:35.402366 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:48:35.402571 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:48:35.402721 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:48:35.402920 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:48:35.404762 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:48:35.405192 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:48:35.406117 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:48:35.406390 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:48:35.406536 [debug] [Thread-3 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m17:48:35.406678 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:35.560375 [debug] [Thread-3 (]: SQL status: BEGIN in 0.153 seconds
[0m17:48:35.561516 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:48:35.562363 [debug] [Thread-3 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "neondb"."public_public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:48:35.580016 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m17:48:35.583064 [debug] [Thread-3 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m17:48:35.600654 [debug] [Thread-3 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:48:35.602464 [info ] [Thread-3 (]: 13 of 13 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.20s]
[0m17:48:35.603634 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:48:35.605308 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:35.605792 [debug] [MainThread]: On master: BEGIN
[0m17:48:35.606213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:35.775166 [debug] [MainThread]: SQL status: BEGIN in 0.169 seconds
[0m17:48:35.776885 [debug] [MainThread]: On master: COMMIT
[0m17:48:35.777927 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:35.778652 [debug] [MainThread]: On master: COMMIT
[0m17:48:35.795784 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:48:35.796571 [debug] [MainThread]: On master: Close
[0m17:48:35.797773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:35.798358 [debug] [MainThread]: Connection 'test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501' was properly closed.
[0m17:48:35.799527 [debug] [MainThread]: Connection 'test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a' was properly closed.
[0m17:48:35.799927 [debug] [MainThread]: Connection 'test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m17:48:35.800301 [debug] [MainThread]: Connection 'test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c' was properly closed.
[0m17:48:35.801126 [info ] [MainThread]: 
[0m17:48:35.801740 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m17:48:35.804403 [debug] [MainThread]: Command end result
[0m17:48:35.818534 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/manifest.json
[0m17:48:35.819282 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/semantic_manifest.json
[0m17:48:35.822134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/nyu-postgres-dq-lab-codex-identify-ipynb-compatibility-issues-w48kxn/dbt_dashdash/target/run_results.json
[0m17:48:35.822306 [info ] [MainThread]: 
[0m17:48:35.822481 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m17:48:35.822617 [info ] [MainThread]: 
[0m17:48:35.822782 [error] [MainThread]: [31mFailure in test accepted_values_dim_courier_vehicle_type__bike__scooter__car (models/marts/schema.yml)[0m
[0m17:48:35.822938 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:48:35.823055 [info ] [MainThread]: 
[0m17:48:35.823198 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/marts/schema.yml/accepted_values_dim_courier_vehicle_type__bike__scooter__car.sql
[0m17:48:35.823323 [info ] [MainThread]: 
[0m17:48:35.823479 [error] [MainThread]: [31mFailure in test accepted_values_stg_couriers_vehicle_type__bike__scooter__car (models/staging/stg_couriers.yml)[0m
[0m17:48:35.823634 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:48:35.823748 [info ] [MainThread]: 
[0m17:48:35.823887 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_couriers.yml/accepted_values_stg_couriers_vehicle_type__bike__scooter__car.sql
[0m17:48:35.824008 [info ] [MainThread]: 
[0m17:48:35.824156 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)[0m
[0m17:48:35.824317 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m17:48:35.824443 [info ] [MainThread]: 
[0m17:48:35.824589 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m17:48:35.824707 [info ] [MainThread]: 
[0m17:48:35.824858 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)[0m
[0m17:48:35.825030 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m17:48:35.825163 [info ] [MainThread]: 
[0m17:48:35.825307 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m17:48:35.825421 [info ] [MainThread]: 
[0m17:48:35.825561 [error] [MainThread]: [31mFailure in test relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_ (models/staging/stg_orders.yml)[0m
[0m17:48:35.825705 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:48:35.825814 [info ] [MainThread]: 
[0m17:48:35.825952 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/relationships_stg_orders_30762036887c15c825a33e927a3d9200.sql
[0m17:48:35.826071 [info ] [MainThread]: 
[0m17:48:35.826211 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=13
[0m17:48:35.827869 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.9579474, "process_in_blocks": "0", "process_kernel_time": 0.179742, "process_mem_max_rss": "135905280", "process_out_blocks": "0", "process_user_time": 1.198181}
[0m17:48:35.828074 [debug] [MainThread]: Command `dbt test` failed at 17:48:35.828039 after 1.96 seconds
[0m17:48:35.828245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e66dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e660440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e661940>]}
[0m17:48:35.828404 [debug] [MainThread]: Flushing usage events
[0m17:48:35.897218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:25.569466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5a270>]}


============================== 17:59:25.572298 | e8a0e459-d4dc-457c-8671-d13275edd7a0 ==============================
[0m17:59:25.572298 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:59:25.572598 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'log_path': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/logs', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'None', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:59:25.698734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a0e459-d4dc-457c-8671-d13275edd7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e49e80>]}
[0m17:59:25.723830 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-v2uimiuj'
[0m17:59:25.724089 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:59:25.792858 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:59:25.793859 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:59:25.834294 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:59:25.836577 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:59:25.981330 [info ] [MainThread]: Installed from version 1.1.1
[0m17:59:25.981590 [info ] [MainThread]: Updated version available: 1.3.1
[0m17:59:25.981781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e8a0e459-d4dc-457c-8671-d13275edd7a0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109029be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a1190>]}
[0m17:59:25.981977 [info ] [MainThread]: 
[0m17:59:25.982142 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:59:25.983767 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45117742, "process_in_blocks": "0", "process_kernel_time": 0.174926, "process_mem_max_rss": "115654656", "process_out_blocks": "0", "process_user_time": 0.757632}
[0m17:59:25.984024 [debug] [MainThread]: Command `dbt deps` succeeded at 17:59:25.983984 after 0.45 seconds
[0m17:59:25.984196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f16960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e49e80>]}
[0m17:59:25.984353 [debug] [MainThread]: Flushing usage events
[0m17:59:26.072619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:26.905933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105656ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4bf20>]}


============================== 17:59:26.908171 | 6fc60d47-2b44-469a-b470-a75771e17202 ==============================
[0m17:59:26.908171 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:59:26.908486 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'log_path': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'static_parser': 'True', 'empty': 'False', 'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'use_experimental_parser': 'False', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m17:59:27.022539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bc980>]}
[0m17:59:27.053854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720bb90>]}
[0m17:59:27.054495 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:59:27.110295 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:59:27.175450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:27.175719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:27.194909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f03b0>]}
[0m17:59:27.231607 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/manifest.json
[0m17:59:27.232746 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/semantic_manifest.json
[0m17:59:27.240704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb70b0>]}
[0m17:59:27.240961 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:59:27.241133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b751c0>]}
[0m17:59:27.242098 [info ] [MainThread]: 
[0m17:59:27.242274 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:59:27.242403 [info ] [MainThread]: 
[0m17:59:27.242632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:59:27.244830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m17:59:27.272399 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m17:59:27.272649 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m17:59:27.272792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:27.432246 [debug] [ThreadPool]: SQL status: SELECT 102 in 0.159 seconds
[0m17:59:27.433051 [debug] [ThreadPool]: On list_neondb: Close
[0m17:59:27.433943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public_public)
[0m17:59:27.436544 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:59:27.436701 [debug] [ThreadPool]: On list_neondb_public_public: BEGIN
[0m17:59:27.436824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:27.607239 [debug] [ThreadPool]: SQL status: BEGIN in 0.170 seconds
[0m17:59:27.608491 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:59:27.609833 [debug] [ThreadPool]: On list_neondb_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_public_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m17:59:27.645344 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.035 seconds
[0m17:59:27.648682 [debug] [ThreadPool]: On list_neondb_public_public: ROLLBACK
[0m17:59:27.666213 [debug] [ThreadPool]: On list_neondb_public_public: Close
[0m17:59:27.676665 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:27.677314 [debug] [MainThread]: On master: BEGIN
[0m17:59:27.677896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:27.832637 [debug] [MainThread]: SQL status: BEGIN in 0.155 seconds
[0m17:59:27.834128 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:27.835247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:59:27.860750 [debug] [MainThread]: SQL status: SELECT 62 in 0.025 seconds
[0m17:59:27.866316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e82cf0>]}
[0m17:59:27.867433 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:27.884229 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:27.885175 [debug] [MainThread]: On master: BEGIN
[0m17:59:27.924895 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m17:59:27.925816 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.926534 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:27.927128 [debug] [MainThread]: On master: COMMIT
[0m17:59:27.944150 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:59:27.945650 [debug] [MainThread]: On master: Close
[0m17:59:27.951833 [debug] [Thread-1 (]: Began running node model.dashdash_lab.stg_couriers
[0m17:59:27.952566 [debug] [Thread-2 (]: Began running node model.dashdash_lab.stg_customers
[0m17:59:27.953273 [debug] [Thread-3 (]: Began running node model.dashdash_lab.stg_orders
[0m17:59:27.954178 [debug] [Thread-4 (]: Began running node model.dashdash_lab.stg_restaurants
[0m17:59:27.955214 [info ] [Thread-1 (]: 1 of 10 START sql view model public_public.stg_couriers ........................ [RUN]
[0m17:59:27.956148 [info ] [Thread-2 (]: 2 of 10 START sql view model public_public.stg_customers ....................... [RUN]
[0m17:59:27.956878 [info ] [Thread-3 (]: 3 of 10 START sql view model public_public.stg_orders .......................... [RUN]
[0m17:59:27.957776 [info ] [Thread-4 (]: 4 of 10 START sql view model public_public.stg_restaurants ..................... [RUN]
[0m17:59:27.958775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public_public, now model.dashdash_lab.stg_couriers)
[0m17:59:27.959753 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_customers'
[0m17:59:27.960434 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_orders'
[0m17:59:27.961184 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_restaurants'
[0m17:59:27.961693 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.stg_couriers
[0m17:59:27.962132 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.stg_customers
[0m17:59:27.962550 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.stg_orders
[0m17:59:27.962904 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.stg_restaurants
[0m17:59:27.966677 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.stg_couriers"
[0m17:59:27.967967 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.stg_customers"
[0m17:59:27.973856 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.stg_orders"
[0m17:59:27.975234 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.stg_restaurants"
[0m17:59:27.976397 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.stg_orders
[0m17:59:27.976620 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.stg_couriers
[0m17:59:27.976828 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.stg_customers
[0m17:59:27.983371 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.stg_restaurants
[0m17:59:28.022897 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.stg_orders"
[0m17:59:28.024355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.stg_couriers"
[0m17:59:28.025723 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.stg_customers"
[0m17:59:28.027321 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.stg_restaurants"
[0m17:59:28.028201 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:59:28.028428 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:59:28.028621 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:59:28.028802 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: BEGIN
[0m17:59:28.029013 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: BEGIN
[0m17:59:28.029190 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: BEGIN
[0m17:59:28.029362 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:59:28.029521 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:59:28.029667 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:59:28.029809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:28.029954 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: BEGIN
[0m17:59:28.030339 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:59:28.184760 [debug] [Thread-2 (]: SQL status: BEGIN in 0.155 seconds
[0m17:59:28.185102 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:59:28.185277 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */

  create view "neondb"."public_public"."stg_customers__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."public"."customers"
  );
[0m17:59:28.189160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m17:59:28.189364 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:59:28.189540 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */

  create view "neondb"."public_public"."stg_couriers__dbt_tmp"
    
    
  as (
    

select
  courier_id,
  courier_name,
  lower(vehicle_type) as vehicle_type,
  active_from,
  active_to,
  region
from "neondb"."public"."couriers"
  );
[0m17:59:28.191826 [debug] [Thread-4 (]: SQL status: BEGIN in 0.162 seconds
[0m17:59:28.191998 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:59:28.192396 [debug] [Thread-3 (]: SQL status: BEGIN in 0.163 seconds
[0m17:59:28.192651 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */

  create view "neondb"."public_public"."stg_restaurants__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."public"."restaurants"
  );
[0m17:59:28.192827 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:59:28.193107 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */

  create view "neondb"."public_public"."stg_orders__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(nullif(trim(status), '')) as status_norm,
        payment_method,
        
    
        NULLIF(BTRIM(subtotal::text), '')::numeric(10, 2)
    
 as subtotal,
        
    
        NULLIF(BTRIM(delivery_fee::text), '')::numeric(10, 2)
    
 as delivery_fee,
        
    
        NULLIF(BTRIM(tip_amount::text), '')::numeric(10, 2)
    
 as tip_amount,
        
    
        NULLIF(BTRIM(distance_km::text), '')::numeric(6, 2)
    
 as distance_km,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."public"."orders"
),
dedup as (
    select *
    from base
    where rn = 1
),
clean as (
    select
        *,
        case
            when status_norm in ('delivered', 'canceled', 'returned') then status_norm
            when status_norm is null or status_norm = '' then 'unknown'
            else 'unknown'
        end as status_final,
        case
            when pickup_ts is not null and dropoff_ts is not null
                then 
    
        EXTRACT(epoch FROM (dropoff_ts - pickup_ts)) / 60.0
    

            else null
        end as delivery_minutes
    from dedup
)
select
    order_id,
    customer_id,
    restaurant_id,
    courier_id,
    order_ts,
    pickup_ts,
    dropoff_ts,
    status_final as status,
    payment_method,
    subtotal,
    delivery_fee,
    tip_amount,
    distance_km,
    delivery_minutes,
    case
        when status_final = 'delivered' and delivery_minutes <= 45 then 
    TRUE

        else 
    FALSE

    end as on_time_flag
from clean
  );
[0m17:59:28.206772 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m17:59:28.210177 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:59:28.210458 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */
alter table "neondb"."public_public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m17:59:28.216309 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m17:59:28.218031 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:59:28.218249 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m17:59:28.218471 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */
alter table "neondb"."public_public"."stg_couriers__dbt_tmp" rename to "stg_couriers"
[0m17:59:28.219731 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:59:28.219967 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */
alter table "neondb"."public_public"."stg_restaurants__dbt_tmp" rename to "stg_restaurants"
[0m17:59:28.226186 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:59:28.232223 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: COMMIT
[0m17:59:28.232427 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m17:59:28.232621 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:59:28.234070 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:59:28.234295 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: COMMIT
[0m17:59:28.234473 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */
alter table "neondb"."public_public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:59:28.236269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:59:28.236818 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: COMMIT
[0m17:59:28.236975 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:59:28.237117 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: COMMIT
[0m17:59:28.237281 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m17:59:28.237821 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: COMMIT
[0m17:59:28.237986 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:59:28.238128 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: COMMIT
[0m17:59:28.251145 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:59:28.251940 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: COMMIT
[0m17:59:28.252107 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:59:28.252239 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: COMMIT
[0m17:59:28.254339 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m17:59:28.254493 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m17:59:28.254638 [debug] [Thread-4 (]: SQL status: COMMIT in 0.016 seconds
[0m17:59:28.258067 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_public"."stg_customers__dbt_backup"
[0m17:59:28.259340 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."stg_couriers__dbt_backup"
[0m17:59:28.260533 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."stg_restaurants__dbt_backup"
[0m17:59:28.262653 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m17:59:28.262909 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m17:59:28.263122 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m17:59:28.263283 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */
drop view if exists "neondb"."public_public"."stg_customers__dbt_backup" cascade
[0m17:59:28.263440 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */
drop view if exists "neondb"."public_public"."stg_couriers__dbt_backup" cascade
[0m17:59:28.263593 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */
drop view if exists "neondb"."public_public"."stg_restaurants__dbt_backup" cascade
[0m17:59:28.269263 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m17:59:28.270403 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."stg_orders__dbt_backup"
[0m17:59:28.270650 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m17:59:28.270804 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */
drop view if exists "neondb"."public_public"."stg_orders__dbt_backup" cascade
[0m17:59:28.279635 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m17:59:28.279836 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.016 seconds
[0m17:59:28.280011 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.016 seconds
[0m17:59:28.281104 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: Close
[0m17:59:28.281643 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: Close
[0m17:59:28.282100 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: Close
[0m17:59:28.283895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794eff0>]}
[0m17:59:28.284248 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727db20>]}
[0m17:59:28.284708 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef54c0>]}
[0m17:59:28.284558 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public_public.stg_couriers ................... [[32mCREATE VIEW[0m in 0.32s]
[0m17:59:28.285063 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public_public.stg_restaurants ................ [[32mCREATE VIEW[0m in 0.32s]
[0m17:59:28.285367 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public_public.stg_customers .................. [[32mCREATE VIEW[0m in 0.32s]
[0m17:59:28.285642 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.stg_couriers
[0m17:59:28.285838 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.stg_restaurants
[0m17:59:28.286037 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.stg_customers
[0m17:59:28.286315 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_courier
[0m17:59:28.286524 [debug] [Thread-4 (]: Began running node model.dashdash_lab.dim_restaurant
[0m17:59:28.286679 [debug] [Thread-2 (]: Began running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:59:28.286936 [info ] [Thread-1 (]: 5 of 10 START sql view model public_public.dim_courier ......................... [RUN]
[0m17:59:28.287117 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m17:59:28.287306 [info ] [Thread-4 (]: 6 of 10 START sql view model public_public.dim_restaurant ...................... [RUN]
[0m17:59:28.287506 [info ] [Thread-2 (]: 7 of 10 START sql view model public_public.monitoring_dq_exceptions ............ [RUN]
[0m17:59:28.287712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_couriers, now model.dashdash_lab.dim_courier)
[0m17:59:28.288258 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: Close
[0m17:59:28.288417 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_restaurants, now model.dashdash_lab.dim_restaurant)
[0m17:59:28.288572 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_customers, now model.dashdash_lab.monitoring_dq_exceptions)
[0m17:59:28.288722 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.dim_courier
[0m17:59:28.288891 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.dim_restaurant
[0m17:59:28.289124 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e05d010>]}
[0m17:59:28.289292 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.monitoring_dq_exceptions
[0m17:59:28.290779 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.dim_courier"
[0m17:59:28.291941 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.dim_restaurant"
[0m17:59:28.292484 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public_public.stg_orders ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m17:59:28.294586 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:59:28.294963 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.stg_orders
[0m17:59:28.295275 [debug] [Thread-3 (]: Began running node model.dashdash_lab.dim_customer
[0m17:59:28.295474 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.dim_restaurant
[0m17:59:28.295614 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.dim_courier
[0m17:59:28.295800 [info ] [Thread-3 (]: 8 of 10 START sql view model public_public.dim_customer ........................ [RUN]
[0m17:59:28.297164 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.dim_restaurant"
[0m17:59:28.297325 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.monitoring_dq_exceptions
[0m17:59:28.298608 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.dim_courier"
[0m17:59:28.298796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_orders, now model.dashdash_lab.dim_customer)
[0m17:59:28.301335 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:59:28.301650 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.dim_customer
[0m17:59:28.301864 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:59:28.302131 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:59:28.303395 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.dim_customer"
[0m17:59:28.303620 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: BEGIN
[0m17:59:28.303812 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:59:28.303966 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: BEGIN
[0m17:59:28.304175 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:59:28.304344 [debug] [Thread-2 (]: On model.dashdash_lab.monitoring_dq_exceptions: BEGIN
[0m17:59:28.304509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:28.304659 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.dim_customer
[0m17:59:28.304883 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:59:28.306237 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.dim_customer"
[0m17:59:28.306631 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:59:28.306811 [debug] [Thread-3 (]: On model.dashdash_lab.dim_customer: BEGIN
[0m17:59:28.306956 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:59:28.448487 [debug] [Thread-4 (]: SQL status: BEGIN in 0.144 seconds
[0m17:59:28.448747 [debug] [Thread-2 (]: SQL status: BEGIN in 0.144 seconds
[0m17:59:28.448934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m17:59:28.449144 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:59:28.449316 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:59:28.449470 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:59:28.449630 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */

  create view "neondb"."public_public"."dim_restaurant__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_restaurants"
  );
[0m17:59:28.449843 [debug] [Thread-2 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */

  create view "neondb"."public_public"."monitoring_dq_exceptions__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(trim(coalesce(status, ''))) as status_norm,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."public"."orders"
),
dupes as (
    select order_id, 'duplicate_order' as reason
    from base
    where rn > 1
),
bad_rest_fk as (
    select o.order_id, 'bad_fk_restaurant' as reason
    from "neondb"."public"."orders" as o
    left join "neondb"."public_public"."stg_restaurants" as r on o.restaurant_id = r.restaurant_id
    where r.restaurant_id is null
),
bad_cour_fk as (
    select o.order_id, 'bad_fk_courier' as reason
    from "neondb"."public"."orders" as o
    left join "neondb"."public_public"."stg_couriers" as c on o.courier_id = c.courier_id
    where o.courier_id is not null and c.courier_id is null
),
unknown_status as (
    select order_id, 'status_unknown' as reason
    from base
    where status_norm is null or status_norm not in ('delivered', 'canceled', 'returned')
)
select distinct order_id, reason
from (
    select * from dupes
    union all
    select * from bad_rest_fk
    union all
    select * from bad_cour_fk
    union all
    select * from unknown_status
) as unioned
order by order_id, reason
  );
[0m17:59:28.450048 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */

  create view "neondb"."public_public"."dim_courier__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_couriers"
  );
[0m17:59:28.459748 [debug] [Thread-3 (]: SQL status: BEGIN in 0.153 seconds
[0m17:59:28.460041 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:59:28.460220 [debug] [Thread-3 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */

  create view "neondb"."public_public"."dim_customer__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_customers"
  );
[0m17:59:28.468745 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m17:59:28.468996 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m17:59:28.470436 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:59:28.471656 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:59:28.471822 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m17:59:28.472010 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */
alter table "neondb"."public_public"."dim_restaurant__dbt_tmp" rename to "dim_restaurant"
[0m17:59:28.472192 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */
alter table "neondb"."public_public"."dim_courier__dbt_tmp" rename to "dim_courier"
[0m17:59:28.473348 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:59:28.473596 [debug] [Thread-2 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */
alter table "neondb"."public_public"."monitoring_dq_exceptions__dbt_tmp" rename to "monitoring_dq_exceptions"
[0m17:59:28.478078 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m17:59:28.479485 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:59:28.479663 [debug] [Thread-3 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */
alter table "neondb"."public_public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m17:59:28.490200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m17:59:28.490437 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m17:59:28.490604 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m17:59:28.491233 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: COMMIT
[0m17:59:28.491720 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: COMMIT
[0m17:59:28.492467 [debug] [Thread-2 (]: On model.dashdash_lab.monitoring_dq_exceptions: COMMIT
[0m17:59:28.492676 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:59:28.492838 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:59:28.493093 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:59:28.493244 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: COMMIT
[0m17:59:28.493397 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: COMMIT
[0m17:59:28.493589 [debug] [Thread-2 (]: On model.dashdash_lab.monitoring_dq_exceptions: COMMIT
[0m17:59:28.495995 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:59:28.496509 [debug] [Thread-3 (]: On model.dashdash_lab.dim_customer: COMMIT
[0m17:59:28.496660 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:59:28.496790 [debug] [Thread-3 (]: On model.dashdash_lab.dim_customer: COMMIT
[0m17:59:28.512844 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m17:59:28.513040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m17:59:28.513183 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m17:59:28.514249 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."dim_restaurant__dbt_backup"
[0m17:59:28.515192 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."dim_courier__dbt_backup"
[0m17:59:28.515367 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m17:59:28.516939 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_public"."monitoring_dq_exceptions__dbt_backup"
[0m17:59:28.517490 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m17:59:28.517784 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m17:59:28.518817 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."dim_customer__dbt_backup"
[0m17:59:28.519058 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m17:59:28.519227 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */
drop view if exists "neondb"."public_public"."dim_restaurant__dbt_backup" cascade
[0m17:59:28.519388 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */
drop view if exists "neondb"."public_public"."dim_courier__dbt_backup" cascade
[0m17:59:28.519596 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m17:59:28.519752 [debug] [Thread-2 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */
drop view if exists "neondb"."public_public"."monitoring_dq_exceptions__dbt_backup" cascade
[0m17:59:28.520000 [debug] [Thread-3 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */
drop view if exists "neondb"."public_public"."dim_customer__dbt_backup" cascade
[0m17:59:28.536364 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m17:59:28.536564 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.017 seconds
[0m17:59:28.537169 [debug] [Thread-1 (]: On model.dashdash_lab.dim_courier: Close
[0m17:59:28.537627 [debug] [Thread-4 (]: On model.dashdash_lab.dim_restaurant: Close
[0m17:59:28.537805 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.018 seconds
[0m17:59:28.537999 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m17:59:28.538257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e09d9a0>]}
[0m17:59:28.538819 [debug] [Thread-2 (]: On model.dashdash_lab.monitoring_dq_exceptions: Close
[0m17:59:28.539037 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e09c410>]}
[0m17:59:28.539611 [debug] [Thread-3 (]: On model.dashdash_lab.dim_customer: Close
[0m17:59:28.539928 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public_public.dim_courier .................... [[32mCREATE VIEW[0m in 0.25s]
[0m17:59:28.540241 [info ] [Thread-4 (]: 6 of 10 OK created sql view model public_public.dim_restaurant ................. [[32mCREATE VIEW[0m in 0.25s]
[0m17:59:28.540463 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0b7500>]}
[0m17:59:28.540726 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_courier
[0m17:59:28.540934 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e07fa10>]}
[0m17:59:28.541160 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.dim_restaurant
[0m17:59:28.541410 [info ] [Thread-2 (]: 7 of 10 OK created sql view model public_public.monitoring_dq_exceptions ....... [[32mCREATE VIEW[0m in 0.25s]
[0m17:59:28.541607 [debug] [Thread-1 (]: Began running node model.dashdash_lab.fct_deliveries
[0m17:59:28.541990 [info ] [Thread-3 (]: 8 of 10 OK created sql view model public_public.dim_customer ................... [[32mCREATE VIEW[0m in 0.24s]
[0m17:59:28.542343 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.monitoring_dq_exceptions
[0m17:59:28.542617 [info ] [Thread-1 (]: 9 of 10 START sql view model public_public.fct_deliveries ...................... [RUN]
[0m17:59:28.542943 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.dim_customer
[0m17:59:28.543214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.dim_courier, now model.dashdash_lab.fct_deliveries)
[0m17:59:28.543420 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.fct_deliveries
[0m17:59:28.545146 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.fct_deliveries"
[0m17:59:28.545504 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.fct_deliveries
[0m17:59:28.546807 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.fct_deliveries"
[0m17:59:28.547096 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:59:28.547251 [debug] [Thread-1 (]: On model.dashdash_lab.fct_deliveries: BEGIN
[0m17:59:28.547394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:28.686553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.139 seconds
[0m17:59:28.686859 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:59:28.687036 [debug] [Thread-1 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */

  create view "neondb"."public_public"."fct_deliveries__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_orders" as o
where o.status = 'delivered'
  and o.restaurant_id in (select restaurant_id from "neondb"."public_public"."stg_restaurants")
  and (
        o.courier_id is null
        or o.courier_id in (select courier_id from "neondb"."public_public"."stg_couriers")
      )
  );
[0m17:59:28.707930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m17:59:28.709526 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:59:28.709723 [debug] [Thread-1 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */
alter table "neondb"."public_public"."fct_deliveries__dbt_tmp" rename to "fct_deliveries"
[0m17:59:28.726202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:59:28.727380 [debug] [Thread-1 (]: On model.dashdash_lab.fct_deliveries: COMMIT
[0m17:59:28.727572 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:59:28.727724 [debug] [Thread-1 (]: On model.dashdash_lab.fct_deliveries: COMMIT
[0m17:59:28.747379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m17:59:28.748541 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."fct_deliveries__dbt_backup"
[0m17:59:28.748785 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m17:59:28.748937 [debug] [Thread-1 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */
drop view if exists "neondb"."public_public"."fct_deliveries__dbt_backup" cascade
[0m17:59:28.765546 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m17:59:28.766198 [debug] [Thread-1 (]: On model.dashdash_lab.fct_deliveries: Close
[0m17:59:28.766554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0bc800>]}
[0m17:59:28.766822 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public_public.fct_deliveries ................. [[32mCREATE VIEW[0m in 0.22s]
[0m17:59:28.767091 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.fct_deliveries
[0m17:59:28.767492 [debug] [Thread-4 (]: Began running node model.dashdash_lab.kpi_delivery_overview
[0m17:59:28.767760 [info ] [Thread-4 (]: 10 of 10 START sql view model public_public.kpi_delivery_overview .............. [RUN]
[0m17:59:28.767949 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.dim_restaurant, now model.dashdash_lab.kpi_delivery_overview)
[0m17:59:28.768101 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.kpi_delivery_overview
[0m17:59:28.771994 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.kpi_delivery_overview"
[0m17:59:28.772438 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.kpi_delivery_overview
[0m17:59:28.773889 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.kpi_delivery_overview"
[0m17:59:28.774199 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:59:28.774353 [debug] [Thread-4 (]: On model.dashdash_lab.kpi_delivery_overview: BEGIN
[0m17:59:28.774494 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:59:28.920360 [debug] [Thread-4 (]: SQL status: BEGIN in 0.146 seconds
[0m17:59:28.921378 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:59:28.922337 [debug] [Thread-4 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */

  create view "neondb"."public_public"."kpi_delivery_overview__dbt_tmp"
    
    
  as (
    

with d as (
    select *
    from "neondb"."public_public"."fct_deliveries"
)
select
    
    
        AVG(CASE WHEN on_time_flag THEN 1 ELSE 0 END)::numeric(5, 4)
    
 as on_time_rate,
    
    
        AVG(delivery_minutes)::numeric(6, 2)
    
 as avg_delivery_minutes,
    (
        select 
    
        (COUNT(*) FILTER (WHERE status IN ('canceled', 'returned'))::numeric / NULLIF(COUNT(*), 0))
    

        from "neondb"."public_public"."stg_orders"
    ) as cancel_return_rate
from d
  );
[0m17:59:28.943299 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:59:28.949081 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:59:28.949853 [debug] [Thread-4 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */
alter table "neondb"."public_public"."kpi_delivery_overview__dbt_tmp" rename to "kpi_delivery_overview"
[0m17:59:28.968880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m17:59:28.971335 [debug] [Thread-4 (]: On model.dashdash_lab.kpi_delivery_overview: COMMIT
[0m17:59:28.972264 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:59:28.972992 [debug] [Thread-4 (]: On model.dashdash_lab.kpi_delivery_overview: COMMIT
[0m17:59:28.992096 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m17:59:28.999126 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."kpi_delivery_overview__dbt_backup"
[0m17:59:29.000080 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m17:59:29.000661 [debug] [Thread-4 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */
drop view if exists "neondb"."public_public"."kpi_delivery_overview__dbt_backup" cascade
[0m17:59:29.018307 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.017 seconds
[0m17:59:29.020232 [debug] [Thread-4 (]: On model.dashdash_lab.kpi_delivery_overview: Close
[0m17:59:29.021310 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fc60d47-2b44-469a-b470-a75771e17202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0ff9e0>]}
[0m17:59:29.022159 [info ] [Thread-4 (]: 10 of 10 OK created sql view model public_public.kpi_delivery_overview ......... [[32mCREATE VIEW[0m in 0.25s]
[0m17:59:29.022873 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.kpi_delivery_overview
[0m17:59:29.024174 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:29.024569 [debug] [MainThread]: On master: BEGIN
[0m17:59:29.024937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:29.170488 [debug] [MainThread]: SQL status: BEGIN in 0.146 seconds
[0m17:59:29.170758 [debug] [MainThread]: On master: COMMIT
[0m17:59:29.170906 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:29.171031 [debug] [MainThread]: On master: COMMIT
[0m17:59:29.188763 [debug] [MainThread]: SQL status: COMMIT in 0.018 seconds
[0m17:59:29.189005 [debug] [MainThread]: On master: Close
[0m17:59:29.189319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:29.189446 [debug] [MainThread]: Connection 'model.dashdash_lab.fct_deliveries' was properly closed.
[0m17:59:29.189558 [debug] [MainThread]: Connection 'model.dashdash_lab.monitoring_dq_exceptions' was properly closed.
[0m17:59:29.189665 [debug] [MainThread]: Connection 'model.dashdash_lab.dim_customer' was properly closed.
[0m17:59:29.189769 [debug] [MainThread]: Connection 'model.dashdash_lab.kpi_delivery_overview' was properly closed.
[0m17:59:29.189947 [info ] [MainThread]: 
[0m17:59:29.190091 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m17:59:29.190775 [debug] [MainThread]: Command end result
[0m17:59:29.203407 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/manifest.json
[0m17:59:29.204294 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/semantic_manifest.json
[0m17:59:29.206940 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/run_results.json
[0m17:59:29.207099 [info ] [MainThread]: 
[0m17:59:29.207281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:29.207422 [info ] [MainThread]: 
[0m17:59:29.207574 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m17:59:29.209406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3422458, "process_in_blocks": "0", "process_kernel_time": 0.205179, "process_mem_max_rss": "134938624", "process_out_blocks": "0", "process_user_time": 1.221701}
[0m17:59:29.209758 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:29.209711 after 2.34 seconds
[0m17:59:29.209955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e80740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afb230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e93e30>]}
[0m17:59:29.210131 [debug] [MainThread]: Flushing usage events
[0m17:59:29.292937 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:30.180573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11419c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11419c1d0>]}


============================== 17:59:30.182704 | 57cb099c-6da7-42fc-9581-9709a5b32e0e ==============================
[0m17:59:30.182704 [info ] [MainThread]: Running with dbt=1.10.11
[0m17:59:30.183000 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'static_parser': 'True', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'printer_width': '80'}
[0m17:59:30.287289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57cb099c-6da7-42fc-9581-9709a5b32e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114465fd0>]}
[0m17:59:30.321954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57cb099c-6da7-42fc-9581-9709a5b32e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111468590>]}
[0m17:59:30.322526 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:59:30.373207 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m17:59:30.430876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:30.431127 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:30.452047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57cb099c-6da7-42fc-9581-9709a5b32e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141382c0>]}
[0m17:59:30.492049 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/manifest.json
[0m17:59:30.493545 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/semantic_manifest.json
[0m17:59:30.505780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57cb099c-6da7-42fc-9581-9709a5b32e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158ee3f0>]}
[0m17:59:30.506091 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m17:59:30.506263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57cb099c-6da7-42fc-9581-9709a5b32e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11413aa20>]}
[0m17:59:30.507282 [info ] [MainThread]: 
[0m17:59:30.507456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:59:30.507597 [info ] [MainThread]: 
[0m17:59:30.507827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:59:30.510082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_public'
[0m17:59:30.531191 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:59:30.531487 [debug] [ThreadPool]: On list_neondb_public_public: BEGIN
[0m17:59:30.531639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:30.688616 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m17:59:30.688986 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m17:59:30.689174 [debug] [ThreadPool]: On list_neondb_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_public_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m17:59:30.706617 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.017 seconds
[0m17:59:30.707441 [debug] [ThreadPool]: On list_neondb_public_public: ROLLBACK
[0m17:59:30.723916 [debug] [ThreadPool]: On list_neondb_public_public: Close
[0m17:59:30.727602 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:30.727856 [debug] [MainThread]: On master: BEGIN
[0m17:59:30.727987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:30.873066 [debug] [MainThread]: SQL status: BEGIN in 0.145 seconds
[0m17:59:30.873920 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:30.874726 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:59:30.899189 [debug] [MainThread]: SQL status: SELECT 77 in 0.024 seconds
[0m17:59:30.906414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57cb099c-6da7-42fc-9581-9709a5b32e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a3f290>]}
[0m17:59:30.907108 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:30.923789 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:30.924565 [debug] [MainThread]: On master: BEGIN
[0m17:59:30.962982 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m17:59:30.964619 [debug] [MainThread]: On master: COMMIT
[0m17:59:30.965304 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:30.965886 [debug] [MainThread]: On master: COMMIT
[0m17:59:30.982747 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:59:30.983915 [debug] [MainThread]: On master: Close
[0m17:59:30.989331 [debug] [Thread-1 (]: Began running node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:59:30.990060 [debug] [Thread-2 (]: Began running node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:59:30.990766 [debug] [Thread-3 (]: Began running node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:59:30.991468 [debug] [Thread-4 (]: Began running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:59:30.992138 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_dim_courier_vehicle_type__bike__scooter__car  [RUN]
[0m17:59:30.992808 [info ] [Thread-2 (]: 2 of 13 START test accepted_values_stg_couriers_vehicle_type__bike__scooter__car  [RUN]
[0m17:59:30.993381 [info ] [Thread-3 (]: 3 of 13 START test accepted_values_stg_orders_status__delivered__canceled__returned__unknown  [RUN]
[0m17:59:30.993961 [info ] [Thread-4 (]: 4 of 13 START test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0  [RUN]
[0m17:59:30.994613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public_public, now test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3)
[0m17:59:30.995200 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37'
[0m17:59:30.995840 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e'
[0m17:59:30.996409 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486'
[0m17:59:30.996893 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:59:30.997309 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:59:30.997695 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:59:30.998085 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:59:31.005741 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:59:31.007515 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:59:31.038190 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:59:31.042966 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:59:31.043701 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:59:31.044186 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:59:31.044366 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:59:31.044514 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:59:31.051737 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:59:31.052737 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:59:31.053680 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:59:31.054537 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:59:31.054945 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:59:31.055182 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:59:31.055366 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:59:31.055546 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: BEGIN
[0m17:59:31.055770 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: BEGIN
[0m17:59:31.055932 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: BEGIN
[0m17:59:31.056114 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:59:31.056300 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:59:31.056484 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:59:31.056643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:31.056811 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: BEGIN
[0m17:59:31.057139 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:59:31.211980 [debug] [Thread-2 (]: SQL status: BEGIN in 0.155 seconds
[0m17:59:31.212235 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m17:59:31.212417 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vehicle_type as value_field,
        count(*) as n_records

    from "neondb"."public_public"."stg_couriers"
    group by vehicle_type

)

select *
from all_values
where value_field not in (
    'bike','scooter','car'
)



  
  
      
    ) dbt_internal_test
[0m17:59:31.213283 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m17:59:31.213472 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m17:59:31.213651 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vehicle_type as value_field,
        count(*) as n_records

    from "neondb"."public_public"."dim_courier"
    group by vehicle_type

)

select *
from all_values
where value_field not in (
    'bike','scooter','car'
)



  
  
      
    ) dbt_internal_test
[0m17:59:31.214462 [debug] [Thread-3 (]: SQL status: BEGIN in 0.158 seconds
[0m17:59:31.214611 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m17:59:31.214774 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "neondb"."public_public"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'delivered','canceled','returned','unknown'
)



  
  
      
    ) dbt_internal_test
[0m17:59:31.228642 [debug] [Thread-4 (]: SQL status: BEGIN in 0.171 seconds
[0m17:59:31.229256 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m17:59:31.229895 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "neondb"."public_public"."stg_orders"

where not(delivery_minutes delivery_minutes IS NULL OR delivery_minutes >= 0)


  
  
      
    ) dbt_internal_test
[0m17:59:31.231233 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.019 seconds
[0m17:59:31.236137 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: ROLLBACK
[0m17:59:31.236584 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.022 seconds
[0m17:59:31.236848 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.023 seconds
[0m17:59:31.237555 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: ROLLBACK
[0m17:59:31.238126 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: ROLLBACK
[0m17:59:31.247531 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "delivery_minutes"
LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                    ^

[0m17:59:31.248061 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: ROLLBACK
[0m17:59:31.252847 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: Close
[0m17:59:31.253854 [error] [Thread-2 (]: 2 of 13 FAIL 1 accepted_values_stg_couriers_vehicle_type__bike__scooter__car ... [[31mFAIL 1[0m in 0.26s]
[0m17:59:31.254434 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: Close
[0m17:59:31.254991 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: Close
[0m17:59:31.255694 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m17:59:31.256422 [debug] [Thread-2 (]: Began running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:59:31.256810 [error] [Thread-1 (]: 1 of 13 FAIL 1 accepted_values_dim_courier_vehicle_type__bike__scooter__car .... [[31mFAIL 1[0m in 0.26s]
[0m17:59:31.257066 [info ] [Thread-2 (]: 5 of 13 START test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_  [RUN]
[0m17:59:31.257341 [info ] [Thread-3 (]: 3 of 13 PASS accepted_values_stg_orders_status__delivered__canceled__returned__unknown  [[32mPASS[0m in 0.26s]
[0m17:59:31.257619 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m17:59:31.257801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37, now test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3)
[0m17:59:31.258036 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m17:59:31.258216 [debug] [Thread-1 (]: Began running node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:59:31.258456 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:59:31.258697 [debug] [Thread-3 (]: Began running node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:59:31.258887 [info ] [Thread-1 (]: 6 of 13 START test not_null_fct_deliveries_order_id ............................ [RUN]
[0m17:59:31.261178 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:59:31.261668 [info ] [Thread-3 (]: 7 of 13 START test not_null_stg_orders_order_id ................................ [RUN]
[0m17:59:31.261883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3, now test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4)
[0m17:59:31.262125 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e, now test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:59:31.262298 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:59:31.262483 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:59:31.262681 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:59:31.265353 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:59:31.265601 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: Close
[0m17:59:31.267233 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:59:31.269023 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:59:31.269964 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:59:31.270951 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:59:31.271147 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:59:31.271447 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:59:31.272409 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:59:31.272621 [debug] [Thread-2 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: BEGIN
[0m17:59:31.272802 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:59:31.273013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:59:31.273216 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: BEGIN
[0m17:59:31.273386 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:59:31.273630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:31.273839 [debug] [Thread-3 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m17:59:31.274052 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:59:31.276756 [debug] [Thread-4 (]: Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m17:59:31.277006 [error] [Thread-4 (]: 4 of 13 ERROR dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0  [[31mERROR[0m in 0.28s]
[0m17:59:31.277257 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m17:59:31.277430 [debug] [Thread-4 (]: Began running node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:59:31.277651 [debug] [Thread-7 (]: Marking all children of 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql.
[0m17:59:31.277828 [info ] [Thread-4 (]: 8 of 13 START test relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_  [RUN]
[0m17:59:31.278320 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486, now test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447)
[0m17:59:31.278497 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:59:31.281796 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:59:31.282093 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:59:31.283008 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:59:31.283287 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:59:31.283444 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: BEGIN
[0m17:59:31.283596 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:59:31.423208 [debug] [Thread-4 (]: SQL status: BEGIN in 0.139 seconds
[0m17:59:31.423771 [debug] [Thread-2 (]: SQL status: BEGIN in 0.151 seconds
[0m17:59:31.424208 [debug] [Thread-3 (]: SQL status: BEGIN in 0.150 seconds
[0m17:59:31.424656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m17:59:31.425043 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m17:59:31.425535 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m17:59:31.426072 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:59:31.426510 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m17:59:31.426831 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select courier_id as from_field
    from (select * from "neondb"."public_public"."fct_deliveries" where courier_id IS NOT NULL) dbt_subquery
    where courier_id is not null
),

parent as (
    select courier_id as to_field
    from "neondb"."public_public"."dim_courier"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:59:31.427110 [debug] [Thread-2 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "neondb"."public_public"."stg_orders"

where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS NOT NULL) OR (status IN ('canceled','returned','unknown') AND dropoff_ts IS NULL))


  
  
      
    ) dbt_internal_test
[0m17:59:31.427348 [debug] [Thread-3 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "neondb"."public_public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:59:31.427537 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "neondb"."public_public"."fct_deliveries"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:59:31.446791 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m17:59:31.447437 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m17:59:31.449457 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: ROLLBACK
[0m17:59:31.449996 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function dropoff_ts(boolean) does not exist
LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m17:59:31.450444 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.023 seconds
[0m17:59:31.451941 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: ROLLBACK
[0m17:59:31.452364 [debug] [Thread-2 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: ROLLBACK
[0m17:59:31.453084 [debug] [Thread-3 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m17:59:31.467624 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: Close
[0m17:59:31.468797 [info ] [Thread-4 (]: 8 of 13 PASS relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_  [[32mPASS[0m in 0.19s]
[0m17:59:31.469515 [debug] [Thread-2 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: Close
[0m17:59:31.470373 [debug] [Thread-1 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: Close
[0m17:59:31.470760 [debug] [Thread-3 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:59:31.471327 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m17:59:31.472026 [debug] [Thread-4 (]: Began running node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:59:31.472305 [info ] [Thread-1 (]: 6 of 13 PASS not_null_fct_deliveries_order_id .................................. [[32mPASS[0m in 0.21s]
[0m17:59:31.472522 [info ] [Thread-4 (]: 9 of 13 START test relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_  [RUN]
[0m17:59:31.473272 [info ] [Thread-3 (]: 7 of 13 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.21s]
[0m17:59:31.473552 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m17:59:31.473766 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447, now test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501)
[0m17:59:31.474517 [debug] [Thread-2 (]: Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m17:59:31.474750 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m17:59:31.474927 [debug] [Thread-1 (]: Began running node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:59:31.475119 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:59:31.475349 [error] [Thread-2 (]: 5 of 13 ERROR dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_  [[31mERROR[0m in 0.22s]
[0m17:59:31.475552 [debug] [Thread-3 (]: Began running node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:59:31.475743 [info ] [Thread-1 (]: 10 of 13 START test relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_  [RUN]
[0m17:59:31.478179 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:59:31.478448 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m17:59:31.478629 [info ] [Thread-3 (]: 11 of 13 START test relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_  [RUN]
[0m17:59:31.478832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4, now test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c)
[0m17:59:31.479067 [debug] [Thread-2 (]: Began running node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:59:31.479299 [debug] [Thread-7 (]: Marking all children of 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql.
[0m17:59:31.479485 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64, now test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465)
[0m17:59:31.479654 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:59:31.479816 [info ] [Thread-2 (]: 12 of 13 START test unique_fct_deliveries_order_id ............................. [RUN]
[0m17:59:31.480070 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:59:31.482126 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:59:31.482338 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:59:31.482497 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3, now test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a)
[0m17:59:31.484413 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:59:31.485428 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:59:31.485595 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:59:31.485793 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:59:31.489041 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:59:31.489218 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:59:31.490141 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:59:31.490340 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:59:31.491316 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:59:31.491527 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:59:31.491708 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: BEGIN
[0m17:59:31.491945 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:59:31.492835 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:59:31.493027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:59:31.493206 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: BEGIN
[0m17:59:31.493385 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:59:31.493667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:31.493840 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:59:31.493990 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: BEGIN
[0m17:59:31.494194 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: BEGIN
[0m17:59:31.494340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:59:31.494486 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:59:31.648295 [debug] [Thread-2 (]: SQL status: BEGIN in 0.154 seconds
[0m17:59:31.648965 [debug] [Thread-3 (]: SQL status: BEGIN in 0.154 seconds
[0m17:59:31.649531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.156 seconds
[0m17:59:31.650081 [debug] [Thread-4 (]: SQL status: BEGIN in 0.157 seconds
[0m17:59:31.650596 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m17:59:31.651115 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m17:59:31.651582 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m17:59:31.652013 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m17:59:31.652434 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "neondb"."public_public"."fct_deliveries"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:59:31.652891 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select restaurant_id as from_field
    from "neondb"."public_public"."stg_orders"
    where restaurant_id is not null
),

parent as (
    select restaurant_id as to_field
    from "neondb"."public_public"."stg_restaurants"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:59:31.653356 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select courier_id as from_field
    from (select * from "neondb"."public_public"."stg_orders" where courier_id IS NOT NULL) dbt_subquery
    where courier_id is not null
),

parent as (
    select courier_id as to_field
    from "neondb"."public_public"."stg_couriers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:59:31.653870 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select restaurant_id as from_field
    from "neondb"."public_public"."fct_deliveries"
    where restaurant_id is not null
),

parent as (
    select restaurant_id as to_field
    from "neondb"."public_public"."dim_restaurant"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:59:31.671240 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m17:59:31.673321 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: ROLLBACK
[0m17:59:31.674343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m17:59:31.674777 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m17:59:31.675895 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: ROLLBACK
[0m17:59:31.676520 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: ROLLBACK
[0m17:59:31.676746 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.023 seconds
[0m17:59:31.677408 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: ROLLBACK
[0m17:59:31.690995 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: Close
[0m17:59:31.692068 [error] [Thread-3 (]: 11 of 13 FAIL 1 relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_  [[31mFAIL 1[0m in 0.21s]
[0m17:59:31.692802 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m17:59:31.693263 [debug] [Thread-3 (]: Began running node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:59:31.693567 [info ] [Thread-3 (]: 13 of 13 START test unique_stg_orders_order_id ................................. [RUN]
[0m17:59:31.693790 [debug] [Thread-2 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: Close
[0m17:59:31.693966 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: Close
[0m17:59:31.694139 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: Close
[0m17:59:31.694331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465, now test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a)
[0m17:59:31.694596 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:59:31.694840 [info ] [Thread-4 (]: 9 of 13 PASS relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_  [[32mPASS[0m in 0.22s]
[0m17:59:31.695069 [info ] [Thread-2 (]: 12 of 13 PASS unique_fct_deliveries_order_id ................................... [[32mPASS[0m in 0.21s]
[0m17:59:31.695291 [info ] [Thread-1 (]: 10 of 13 PASS relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_  [[32mPASS[0m in 0.22s]
[0m17:59:31.697046 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:59:31.697288 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m17:59:31.697519 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m17:59:31.697742 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m17:59:31.698193 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:59:31.699158 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:59:31.699448 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:59:31.699592 [debug] [Thread-3 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m17:59:31.699726 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:59:31.848462 [debug] [Thread-3 (]: SQL status: BEGIN in 0.149 seconds
[0m17:59:31.849276 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m17:59:31.849884 [debug] [Thread-3 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "neondb"."public_public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:59:31.867994 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m17:59:31.870875 [debug] [Thread-3 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m17:59:31.887911 [debug] [Thread-3 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:59:31.889810 [info ] [Thread-3 (]: 13 of 13 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.20s]
[0m17:59:31.890985 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m17:59:31.893246 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:31.893889 [debug] [MainThread]: On master: BEGIN
[0m17:59:31.894430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:32.041501 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m17:59:32.042465 [debug] [MainThread]: On master: COMMIT
[0m17:59:32.043184 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:32.043777 [debug] [MainThread]: On master: COMMIT
[0m17:59:32.060654 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m17:59:32.061425 [debug] [MainThread]: On master: Close
[0m17:59:32.062636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:32.063256 [debug] [MainThread]: Connection 'test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c' was properly closed.
[0m17:59:32.063955 [debug] [MainThread]: Connection 'test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a' was properly closed.
[0m17:59:32.064519 [debug] [MainThread]: Connection 'test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m17:59:32.065042 [debug] [MainThread]: Connection 'test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501' was properly closed.
[0m17:59:32.065630 [info ] [MainThread]: 
[0m17:59:32.066233 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m17:59:32.069599 [debug] [MainThread]: Command end result
[0m17:59:32.087039 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/manifest.json
[0m17:59:32.087778 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/semantic_manifest.json
[0m17:59:32.090626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/run_results.json
[0m17:59:32.090791 [info ] [MainThread]: 
[0m17:59:32.090953 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m17:59:32.091090 [info ] [MainThread]: 
[0m17:59:32.091258 [error] [MainThread]: [31mFailure in test accepted_values_stg_couriers_vehicle_type__bike__scooter__car (models/staging/stg_couriers.yml)[0m
[0m17:59:32.091416 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:59:32.091533 [info ] [MainThread]: 
[0m17:59:32.091682 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_couriers.yml/accepted_values_stg_couriers_vehicle_type__bike__scooter__car.sql
[0m17:59:32.091813 [info ] [MainThread]: 
[0m17:59:32.091971 [error] [MainThread]: [31mFailure in test accepted_values_dim_courier_vehicle_type__bike__scooter__car (models/marts/schema.yml)[0m
[0m17:59:32.092122 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:59:32.092236 [info ] [MainThread]: 
[0m17:59:32.092374 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/marts/schema.yml/accepted_values_dim_courier_vehicle_type__bike__scooter__car.sql
[0m17:59:32.092490 [info ] [MainThread]: 
[0m17:59:32.092634 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)[0m
[0m17:59:32.092789 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m17:59:32.092917 [info ] [MainThread]: 
[0m17:59:32.093058 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m17:59:32.093171 [info ] [MainThread]: 
[0m17:59:32.093319 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)[0m
[0m17:59:32.093487 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m17:59:32.093619 [info ] [MainThread]: 
[0m17:59:32.093761 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m17:59:32.093878 [info ] [MainThread]: 
[0m17:59:32.094021 [error] [MainThread]: [31mFailure in test relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_ (models/staging/stg_orders.yml)[0m
[0m17:59:32.094163 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:59:32.094274 [info ] [MainThread]: 
[0m17:59:32.094410 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/relationships_stg_orders_30762036887c15c825a33e927a3d9200.sql
[0m17:59:32.094527 [info ] [MainThread]: 
[0m17:59:32.094665 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=13
[0m17:59:32.096110 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.9504541, "process_in_blocks": "0", "process_kernel_time": 0.19092, "process_mem_max_rss": "137281536", "process_out_blocks": "0", "process_user_time": 1.200483}
[0m17:59:32.096320 [debug] [MainThread]: Command `dbt test` failed at 17:59:32.096286 after 1.95 seconds
[0m17:59:32.096494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c12f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11607baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11607b7d0>]}
[0m17:59:32.096652 [debug] [MainThread]: Flushing usage events
[0m17:59:32.168112 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:07:25.271245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e04950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e59d60>]}


============================== 21:07:25.273949 | 5cd87333-06a6-42d3-bdc5-d5d60518c055 ==============================
[0m21:07:25.273949 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:07:25.274258 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt deps --profiles-dir /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'version_check': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'None', 'quiet': 'False', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'log_cache_events': 'False', 'log_path': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/logs', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m21:07:25.354278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cd87333-06a6-42d3-bdc5-d5d60518c055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cff740>]}
[0m21:07:25.380154 [debug] [MainThread]: Set downloads directory='/var/folders/7d/7c4hrscx0vg406v60dbtjg9h0000gn/T/dbt-downloads-nim502yq'
[0m21:07:25.380414 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:07:25.528525 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:07:25.529433 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:07:25.570383 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:07:25.572575 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:07:25.720288 [info ] [MainThread]: Installed from version 1.1.1
[0m21:07:25.720568 [info ] [MainThread]: Updated version available: 1.3.1
[0m21:07:25.720775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5cd87333-06a6-42d3-bdc5-d5d60518c055', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120ab650>]}
[0m21:07:25.720980 [info ] [MainThread]: 
[0m21:07:25.721139 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m21:07:25.722837 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.48650262, "process_in_blocks": "0", "process_kernel_time": 0.192979, "process_mem_max_rss": "117096448", "process_out_blocks": "0", "process_user_time": 0.761706}
[0m21:07:25.723118 [debug] [MainThread]: Command `dbt deps` succeeded at 21:07:25.723073 after 0.49 seconds
[0m21:07:25.723304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e04950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e6be60>]}
[0m21:07:25.723465 [debug] [MainThread]: Flushing usage events
[0m21:07:25.897828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:07:26.778277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055a2a0>]}


============================== 21:07:26.780422 | e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9 ==============================
[0m21:07:26.780422 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:07:26.780715 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'introspect': 'True', 'target_path': 'None', 'debug': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'version_check': 'True', 'warn_error': 'None', 'quiet': 'False'}
[0m21:07:26.902653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11150f200>]}
[0m21:07:26.933656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111599760>]}
[0m21:07:26.934297 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:07:27.006477 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m21:07:27.069161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:07:27.069404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:07:27.088563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11193b710>]}
[0m21:07:27.125006 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/manifest.json
[0m21:07:27.126160 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/semantic_manifest.json
[0m21:07:27.134080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a0be90>]}
[0m21:07:27.134353 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m21:07:27.134522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139ef920>]}
[0m21:07:27.135465 [info ] [MainThread]: 
[0m21:07:27.135635 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:07:27.135763 [info ] [MainThread]: 
[0m21:07:27.136001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:07:27.137746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb'
[0m21:07:27.174569 [debug] [ThreadPool]: Using postgres connection "list_neondb"
[0m21:07:27.174819 [debug] [ThreadPool]: On list_neondb: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb"} */

    select distinct nspname from pg_namespace
  
[0m21:07:27.174968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:27.438650 [debug] [ThreadPool]: SQL status: SELECT 102 in 0.264 seconds
[0m21:07:27.440603 [debug] [ThreadPool]: On list_neondb: Close
[0m21:07:27.443362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_neondb, now list_neondb_public_public)
[0m21:07:27.449976 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m21:07:27.450480 [debug] [ThreadPool]: On list_neondb_public_public: BEGIN
[0m21:07:27.450848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:27.616981 [debug] [ThreadPool]: SQL status: BEGIN in 0.166 seconds
[0m21:07:27.619004 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m21:07:27.619828 [debug] [ThreadPool]: On list_neondb_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_public_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:07:27.659092 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.038 seconds
[0m21:07:27.661599 [debug] [ThreadPool]: On list_neondb_public_public: ROLLBACK
[0m21:07:27.679547 [debug] [ThreadPool]: On list_neondb_public_public: Close
[0m21:07:27.689835 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:27.690431 [debug] [MainThread]: On master: BEGIN
[0m21:07:27.690903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:07:27.938530 [debug] [MainThread]: SQL status: BEGIN in 0.247 seconds
[0m21:07:27.939943 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:27.940923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:07:27.971953 [debug] [MainThread]: SQL status: SELECT 13 in 0.030 seconds
[0m21:07:27.975946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11276a1e0>]}
[0m21:07:27.976928 [debug] [MainThread]: On master: ROLLBACK
[0m21:07:27.994485 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:27.995846 [debug] [MainThread]: On master: BEGIN
[0m21:07:28.031795 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m21:07:28.033395 [debug] [MainThread]: On master: COMMIT
[0m21:07:28.034645 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:28.035552 [debug] [MainThread]: On master: COMMIT
[0m21:07:28.053918 [debug] [MainThread]: SQL status: COMMIT in 0.018 seconds
[0m21:07:28.054800 [debug] [MainThread]: On master: Close
[0m21:07:28.060946 [debug] [Thread-1 (]: Began running node model.dashdash_lab.stg_couriers
[0m21:07:28.061670 [debug] [Thread-2 (]: Began running node model.dashdash_lab.stg_customers
[0m21:07:28.062037 [debug] [Thread-3 (]: Began running node model.dashdash_lab.stg_orders
[0m21:07:28.062400 [debug] [Thread-4 (]: Began running node model.dashdash_lab.stg_restaurants
[0m21:07:28.063108 [info ] [Thread-1 (]: 1 of 10 START sql view model public_public.stg_couriers ........................ [RUN]
[0m21:07:28.063729 [info ] [Thread-2 (]: 2 of 10 START sql view model public_public.stg_customers ....................... [RUN]
[0m21:07:28.064304 [info ] [Thread-3 (]: 3 of 10 START sql view model public_public.stg_orders .......................... [RUN]
[0m21:07:28.064909 [info ] [Thread-4 (]: 4 of 10 START sql view model public_public.stg_restaurants ..................... [RUN]
[0m21:07:28.065775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public_public, now model.dashdash_lab.stg_couriers)
[0m21:07:28.066388 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_customers'
[0m21:07:28.066954 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_orders'
[0m21:07:28.067402 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dashdash_lab.stg_restaurants'
[0m21:07:28.067777 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.stg_couriers
[0m21:07:28.068124 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.stg_customers
[0m21:07:28.068459 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.stg_orders
[0m21:07:28.068796 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.stg_restaurants
[0m21:07:28.072482 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.stg_couriers"
[0m21:07:28.073716 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.stg_customers"
[0m21:07:28.078883 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.stg_orders"
[0m21:07:28.079988 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.stg_restaurants"
[0m21:07:28.080769 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.stg_customers
[0m21:07:28.080983 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.stg_couriers
[0m21:07:28.081197 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.stg_orders
[0m21:07:28.093937 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.stg_restaurants
[0m21:07:28.095716 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.stg_customers"
[0m21:07:28.126036 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.stg_couriers"
[0m21:07:28.127332 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.stg_orders"
[0m21:07:28.128477 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.stg_restaurants"
[0m21:07:28.129069 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m21:07:28.129303 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m21:07:28.129549 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m21:07:28.129728 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: BEGIN
[0m21:07:28.129893 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m21:07:28.130060 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: BEGIN
[0m21:07:28.130207 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: BEGIN
[0m21:07:28.130352 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:07:28.130497 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: BEGIN
[0m21:07:28.130638 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:07:28.130774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:28.131003 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:07:28.280493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m21:07:28.280772 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m21:07:28.280944 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */

  create view "neondb"."public_public"."stg_couriers__dbt_tmp"
    
    
  as (
    

select
  courier_id,
  courier_name,
  lower(vehicle_type) as vehicle_type,
  active_from,
  active_to,
  region
from "neondb"."public"."couriers"
  );
[0m21:07:28.286446 [debug] [Thread-3 (]: SQL status: BEGIN in 0.156 seconds
[0m21:07:28.286591 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m21:07:28.286797 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */

  create view "neondb"."public_public"."stg_orders__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(nullif(trim(status), '')) as status_norm,
        payment_method,
        
    
        NULLIF(BTRIM(subtotal::text), '')::numeric(10, 2)
    
 as subtotal,
        
    
        NULLIF(BTRIM(delivery_fee::text), '')::numeric(10, 2)
    
 as delivery_fee,
        
    
        NULLIF(BTRIM(tip_amount::text), '')::numeric(10, 2)
    
 as tip_amount,
        
    
        NULLIF(BTRIM(distance_km::text), '')::numeric(6, 2)
    
 as distance_km,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."public"."orders"
),
dedup as (
    select *
    from base
    where rn = 1
),
clean as (
    select
        *,
        case
            when status_norm in ('delivered', 'canceled', 'returned') then status_norm
            when status_norm is null or status_norm = '' then 'unknown'
            else 'unknown'
        end as status_final,
        case
            when pickup_ts is not null and dropoff_ts is not null
                then 
    
        EXTRACT(epoch FROM (dropoff_ts - pickup_ts)) / 60.0
    

            else null
        end as delivery_minutes
    from dedup
)
select
    order_id,
    customer_id,
    restaurant_id,
    courier_id,
    order_ts,
    pickup_ts,
    dropoff_ts,
    status_final as status,
    payment_method,
    subtotal,
    delivery_fee,
    tip_amount,
    distance_km,
    delivery_minutes,
    case
        when status_final = 'delivered' and delivery_minutes <= 45 then 
    TRUE

        else 
    FALSE

    end as on_time_flag
from clean
  );
[0m21:07:28.293293 [debug] [Thread-4 (]: SQL status: BEGIN in 0.162 seconds
[0m21:07:28.293471 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m21:07:28.293626 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */

  create view "neondb"."public_public"."stg_restaurants__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."public"."restaurants"
  );
[0m21:07:28.295399 [debug] [Thread-2 (]: SQL status: BEGIN in 0.165 seconds
[0m21:07:28.295581 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m21:07:28.295744 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */

  create view "neondb"."public_public"."stg_customers__dbt_tmp"
    
    
  as (
    

select
  *
from "neondb"."public"."customers"
  );
[0m21:07:28.309283 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m21:07:28.315006 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m21:07:28.315204 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */
alter table "neondb"."public_public"."stg_couriers__dbt_tmp" rename to "stg_couriers"
[0m21:07:28.321896 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.026 seconds
[0m21:07:28.322081 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m21:07:28.323420 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m21:07:28.324601 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m21:07:28.324778 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */
alter table "neondb"."public_public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:07:28.324943 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */
alter table "neondb"."public_public"."stg_restaurants__dbt_tmp" rename to "stg_restaurants"
[0m21:07:28.332526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m21:07:28.340398 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: COMMIT
[0m21:07:28.340598 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m21:07:28.340773 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m21:07:28.342087 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m21:07:28.342247 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m21:07:28.342386 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m21:07:28.342553 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: COMMIT
[0m21:07:28.342701 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */
alter table "neondb"."public_public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:07:28.343171 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: COMMIT
[0m21:07:28.343597 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: COMMIT
[0m21:07:28.343885 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m21:07:28.344038 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m21:07:28.344180 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: COMMIT
[0m21:07:28.344322 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: COMMIT
[0m21:07:28.449144 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.105 seconds
[0m21:07:28.450953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.107 seconds
[0m21:07:28.452481 [debug] [Thread-4 (]: SQL status: COMMIT in 0.108 seconds
[0m21:07:28.453188 [debug] [Thread-2 (]: SQL status: COMMIT in 0.109 seconds
[0m21:07:28.455527 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: COMMIT
[0m21:07:28.467405 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."stg_couriers__dbt_backup"
[0m21:07:28.469071 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."stg_restaurants__dbt_backup"
[0m21:07:28.470085 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_public"."stg_customers__dbt_backup"
[0m21:07:28.470258 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m21:07:28.472269 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.stg_couriers"
[0m21:07:28.472492 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.stg_restaurants"
[0m21:07:28.472707 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.stg_customers"
[0m21:07:28.472860 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: COMMIT
[0m21:07:28.473016 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_couriers"} */
drop view if exists "neondb"."public_public"."stg_couriers__dbt_backup" cascade
[0m21:07:28.473169 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_restaurants"} */
drop view if exists "neondb"."public_public"."stg_restaurants__dbt_backup" cascade
[0m21:07:28.473327 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_customers"} */
drop view if exists "neondb"."public_public"."stg_customers__dbt_backup" cascade
[0m21:07:28.490203 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m21:07:28.490368 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.017 seconds
[0m21:07:28.490503 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.017 seconds
[0m21:07:28.491580 [debug] [Thread-1 (]: On model.dashdash_lab.stg_couriers: Close
[0m21:07:28.492099 [debug] [Thread-2 (]: On model.dashdash_lab.stg_customers: Close
[0m21:07:28.492543 [debug] [Thread-4 (]: On model.dashdash_lab.stg_restaurants: Close
[0m21:07:28.492699 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m21:07:28.493852 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."stg_orders__dbt_backup"
[0m21:07:28.495112 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.stg_orders"
[0m21:07:28.495333 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.stg_orders"} */
drop view if exists "neondb"."public_public"."stg_orders__dbt_backup" cascade
[0m21:07:28.496214 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111982de0>]}
[0m21:07:28.496377 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f9df0>]}
[0m21:07:28.496555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127698e0>]}
[0m21:07:28.496790 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public_public.stg_customers .................. [[32mCREATE VIEW[0m in 0.43s]
[0m21:07:28.497057 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public_public.stg_restaurants ................ [[32mCREATE VIEW[0m in 0.43s]
[0m21:07:28.497295 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public_public.stg_couriers ................... [[32mCREATE VIEW[0m in 0.43s]
[0m21:07:28.497535 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.stg_customers
[0m21:07:28.497746 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.stg_restaurants
[0m21:07:28.497939 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.stg_couriers
[0m21:07:28.498199 [debug] [Thread-2 (]: Began running node model.dashdash_lab.dim_customer
[0m21:07:28.498433 [debug] [Thread-1 (]: Began running node model.dashdash_lab.dim_restaurant
[0m21:07:28.498642 [debug] [Thread-4 (]: Began running node model.dashdash_lab.dim_courier
[0m21:07:28.498830 [info ] [Thread-2 (]: 5 of 10 START sql view model public_public.dim_customer ........................ [RUN]
[0m21:07:28.499059 [info ] [Thread-1 (]: 6 of 10 START sql view model public_public.dim_restaurant ...................... [RUN]
[0m21:07:28.499264 [info ] [Thread-4 (]: 7 of 10 START sql view model public_public.dim_courier ......................... [RUN]
[0m21:07:28.499457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_customers, now model.dashdash_lab.dim_customer)
[0m21:07:28.499615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_couriers, now model.dashdash_lab.dim_restaurant)
[0m21:07:28.499761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_restaurants, now model.dashdash_lab.dim_courier)
[0m21:07:28.499909 [debug] [Thread-2 (]: Began compiling node model.dashdash_lab.dim_customer
[0m21:07:28.500054 [debug] [Thread-1 (]: Began compiling node model.dashdash_lab.dim_restaurant
[0m21:07:28.500198 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.dim_courier
[0m21:07:28.501401 [debug] [Thread-2 (]: Writing injected SQL for node "model.dashdash_lab.dim_customer"
[0m21:07:28.502474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dashdash_lab.dim_restaurant"
[0m21:07:28.503508 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.dim_courier"
[0m21:07:28.503872 [debug] [Thread-2 (]: Began executing node model.dashdash_lab.dim_customer
[0m21:07:28.504026 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.dim_courier
[0m21:07:28.504162 [debug] [Thread-1 (]: Began executing node model.dashdash_lab.dim_restaurant
[0m21:07:28.505459 [debug] [Thread-2 (]: Writing runtime sql for node "model.dashdash_lab.dim_customer"
[0m21:07:28.506671 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.dim_courier"
[0m21:07:28.508512 [debug] [Thread-1 (]: Writing runtime sql for node "model.dashdash_lab.dim_restaurant"
[0m21:07:28.508866 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m21:07:28.509032 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m21:07:28.509196 [debug] [Thread-2 (]: On model.dashdash_lab.dim_customer: BEGIN
[0m21:07:28.509349 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m21:07:28.509500 [debug] [Thread-4 (]: On model.dashdash_lab.dim_courier: BEGIN
[0m21:07:28.509645 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:07:28.509791 [debug] [Thread-1 (]: On model.dashdash_lab.dim_restaurant: BEGIN
[0m21:07:28.509930 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:07:28.510129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:28.513890 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.018 seconds
[0m21:07:28.514463 [debug] [Thread-3 (]: On model.dashdash_lab.stg_orders: Close
[0m21:07:28.514773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116091ac0>]}
[0m21:07:28.515037 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public_public.stg_orders ..................... [[32mCREATE VIEW[0m in 0.45s]
[0m21:07:28.515289 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.stg_orders
[0m21:07:28.515490 [debug] [Thread-3 (]: Began running node model.dashdash_lab.monitoring_dq_exceptions
[0m21:07:28.515735 [info ] [Thread-3 (]: 8 of 10 START sql view model public_public.monitoring_dq_exceptions ............ [RUN]
[0m21:07:28.515912 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.stg_orders, now model.dashdash_lab.monitoring_dq_exceptions)
[0m21:07:28.516065 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.monitoring_dq_exceptions
[0m21:07:28.518018 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.monitoring_dq_exceptions"
[0m21:07:28.518302 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.monitoring_dq_exceptions
[0m21:07:28.519502 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.monitoring_dq_exceptions"
[0m21:07:28.519770 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m21:07:28.519917 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: BEGIN
[0m21:07:28.520053 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:07:28.666409 [debug] [Thread-4 (]: SQL status: BEGIN in 0.156 seconds
[0m21:07:28.667130 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m21:07:28.667714 [debug] [Thread-4 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */

  create view "neondb"."public_public"."dim_courier__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_couriers"
  );
[0m21:07:28.668580 [debug] [Thread-3 (]: SQL status: BEGIN in 0.148 seconds
[0m21:07:28.668773 [debug] [Thread-2 (]: SQL status: BEGIN in 0.159 seconds
[0m21:07:28.668963 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m21:07:28.669121 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m21:07:28.669349 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */

  create view "neondb"."public_public"."monitoring_dq_exceptions__dbt_tmp"
    
    
  as (
    

with base as (
    select
        order_id,
        customer_id,
        restaurant_id,
        courier_id,
        
    
        NULLIF(BTRIM(order_timestamp::text), '')::timestamp
    
 as order_ts,
        
    
        NULLIF(BTRIM(pickup_timestamp::text), '')::timestamp
    
 as pickup_ts,
        
    
        NULLIF(BTRIM(dropoff_timestamp::text), '')::timestamp
    
 as dropoff_ts,
        lower(trim(coalesce(status, ''))) as status_norm,
        row_number() over (partition by order_id order by order_timestamp) as rn
    from "neondb"."public"."orders"
),
dupes as (
    select order_id, 'duplicate_order' as reason
    from base
    where rn > 1
),
bad_rest_fk as (
    select o.order_id, 'bad_fk_restaurant' as reason
    from "neondb"."public"."orders" as o
    left join "neondb"."public_public"."stg_restaurants" as r on o.restaurant_id = r.restaurant_id
    where r.restaurant_id is null
),
bad_cour_fk as (
    select o.order_id, 'bad_fk_courier' as reason
    from "neondb"."public"."orders" as o
    left join "neondb"."public_public"."stg_couriers" as c on o.courier_id = c.courier_id
    where o.courier_id is not null and c.courier_id is null
),
unknown_status as (
    select order_id, 'status_unknown' as reason
    from base
    where status_norm is null or status_norm not in ('delivered', 'canceled', 'returned')
)
select distinct order_id, reason
from (
    select * from dupes
    union all
    select * from bad_rest_fk
    union all
    select * from bad_cour_fk
    union all
    select * from unknown_status
) as unioned
order by order_id, reason
  );
[0m21:07:28.669570 [debug] [Thread-2 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */

  create view "neondb"."public_public"."dim_customer__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_customers"
  );
[0m21:07:28.686510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.176 seconds
[0m21:07:28.686979 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m21:07:28.687493 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m21:07:28.691011 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m21:07:28.691408 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m21:07:28.691628 [debug] [Thread-1 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */

  create view "neondb"."public_public"."dim_restaurant__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_restaurants"
  );
[0m21:07:28.691815 [debug] [Thread-4 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */
alter table "neondb"."public_public"."dim_courier__dbt_tmp" rename to "dim_courier"
[0m21:07:28.693155 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m21:07:28.693323 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m21:07:28.693550 [debug] [Thread-2 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */
alter table "neondb"."public_public"."dim_customer__dbt_tmp" rename to "dim_customer"
[0m21:07:28.694762 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m21:07:28.695017 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */
alter table "neondb"."public_public"."monitoring_dq_exceptions__dbt_tmp" rename to "monitoring_dq_exceptions"
[0m21:07:28.711446 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m21:07:28.711621 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m21:07:28.712158 [debug] [Thread-4 (]: On model.dashdash_lab.dim_courier: COMMIT
[0m21:07:28.712613 [debug] [Thread-2 (]: On model.dashdash_lab.dim_customer: COMMIT
[0m21:07:28.712788 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m21:07:28.712950 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m21:07:28.713098 [debug] [Thread-4 (]: On model.dashdash_lab.dim_courier: COMMIT
[0m21:07:28.713254 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m21:07:28.713415 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m21:07:28.713555 [debug] [Thread-2 (]: On model.dashdash_lab.dim_customer: COMMIT
[0m21:07:28.714733 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m21:07:28.715207 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: COMMIT
[0m21:07:28.715393 [debug] [Thread-1 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */
alter table "neondb"."public_public"."dim_restaurant__dbt_tmp" rename to "dim_restaurant"
[0m21:07:28.715570 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m21:07:28.715755 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: COMMIT
[0m21:07:28.732767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m21:07:28.733311 [debug] [Thread-4 (]: SQL status: COMMIT in 0.020 seconds
[0m21:07:28.734143 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m21:07:28.734571 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m21:07:28.735240 [debug] [Thread-1 (]: On model.dashdash_lab.dim_restaurant: COMMIT
[0m21:07:28.736314 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."dim_courier__dbt_backup"
[0m21:07:28.737207 [debug] [Thread-2 (]: Applying DROP to: "neondb"."public_public"."dim_customer__dbt_backup"
[0m21:07:28.738746 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."monitoring_dq_exceptions__dbt_backup"
[0m21:07:28.738922 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m21:07:28.739138 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.dim_courier"
[0m21:07:28.739350 [debug] [Thread-2 (]: Using postgres connection "model.dashdash_lab.dim_customer"
[0m21:07:28.739559 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.monitoring_dq_exceptions"
[0m21:07:28.739714 [debug] [Thread-1 (]: On model.dashdash_lab.dim_restaurant: COMMIT
[0m21:07:28.739868 [debug] [Thread-4 (]: On model.dashdash_lab.dim_courier: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_courier"} */
drop view if exists "neondb"."public_public"."dim_courier__dbt_backup" cascade
[0m21:07:28.740024 [debug] [Thread-2 (]: On model.dashdash_lab.dim_customer: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_customer"} */
drop view if exists "neondb"."public_public"."dim_customer__dbt_backup" cascade
[0m21:07:28.740185 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.monitoring_dq_exceptions"} */
drop view if exists "neondb"."public_public"."monitoring_dq_exceptions__dbt_backup" cascade
[0m21:07:28.756532 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.016 seconds
[0m21:07:28.756714 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m21:07:28.756892 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.016 seconds
[0m21:07:28.757451 [debug] [Thread-4 (]: On model.dashdash_lab.dim_courier: Close
[0m21:07:28.757931 [debug] [Thread-3 (]: On model.dashdash_lab.monitoring_dq_exceptions: Close
[0m21:07:28.758398 [debug] [Thread-2 (]: On model.dashdash_lab.dim_customer: Close
[0m21:07:28.758845 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160da9c0>]}
[0m21:07:28.759070 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160c2960>]}
[0m21:07:28.759260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m21:07:28.759799 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1160cda90>]}
[0m21:07:28.759557 [info ] [Thread-4 (]: 7 of 10 OK created sql view model public_public.dim_courier .................... [[32mCREATE VIEW[0m in 0.26s]
[0m21:07:28.760116 [info ] [Thread-3 (]: 8 of 10 OK created sql view model public_public.monitoring_dq_exceptions ....... [[32mCREATE VIEW[0m in 0.24s]
[0m21:07:28.761181 [debug] [Thread-1 (]: Applying DROP to: "neondb"."public_public"."dim_restaurant__dbt_backup"
[0m21:07:28.761428 [info ] [Thread-2 (]: 5 of 10 OK created sql view model public_public.dim_customer ................... [[32mCREATE VIEW[0m in 0.26s]
[0m21:07:28.761671 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.dim_courier
[0m21:07:28.761864 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.monitoring_dq_exceptions
[0m21:07:28.762076 [debug] [Thread-1 (]: Using postgres connection "model.dashdash_lab.dim_restaurant"
[0m21:07:28.762270 [debug] [Thread-2 (]: Finished running node model.dashdash_lab.dim_customer
[0m21:07:28.762453 [debug] [Thread-4 (]: Began running node model.dashdash_lab.fct_deliveries
[0m21:07:28.762692 [debug] [Thread-1 (]: On model.dashdash_lab.dim_restaurant: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.dim_restaurant"} */
drop view if exists "neondb"."public_public"."dim_restaurant__dbt_backup" cascade
[0m21:07:28.762942 [info ] [Thread-4 (]: 9 of 10 START sql view model public_public.fct_deliveries ...................... [RUN]
[0m21:07:28.763161 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.dim_courier, now model.dashdash_lab.fct_deliveries)
[0m21:07:28.763316 [debug] [Thread-4 (]: Began compiling node model.dashdash_lab.fct_deliveries
[0m21:07:28.764737 [debug] [Thread-4 (]: Writing injected SQL for node "model.dashdash_lab.fct_deliveries"
[0m21:07:28.765809 [debug] [Thread-4 (]: Began executing node model.dashdash_lab.fct_deliveries
[0m21:07:28.767129 [debug] [Thread-4 (]: Writing runtime sql for node "model.dashdash_lab.fct_deliveries"
[0m21:07:28.767408 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m21:07:28.767549 [debug] [Thread-4 (]: On model.dashdash_lab.fct_deliveries: BEGIN
[0m21:07:28.767684 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:07:28.779526 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.016 seconds
[0m21:07:28.780127 [debug] [Thread-1 (]: On model.dashdash_lab.dim_restaurant: Close
[0m21:07:28.780428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116016cf0>]}
[0m21:07:28.780673 [info ] [Thread-1 (]: 6 of 10 OK created sql view model public_public.dim_restaurant ................. [[32mCREATE VIEW[0m in 0.28s]
[0m21:07:28.780905 [debug] [Thread-1 (]: Finished running node model.dashdash_lab.dim_restaurant
[0m21:07:29.007949 [debug] [Thread-4 (]: SQL status: BEGIN in 0.240 seconds
[0m21:07:29.009560 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m21:07:29.010521 [debug] [Thread-4 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */

  create view "neondb"."public_public"."fct_deliveries__dbt_tmp"
    
    
  as (
    

select *
from "neondb"."public_public"."stg_orders" as o
where o.status = 'delivered'
  and o.restaurant_id in (select restaurant_id from "neondb"."public_public"."stg_restaurants")
  and (
        o.courier_id is null
        or o.courier_id in (select courier_id from "neondb"."public_public"."stg_couriers")
      )
  );
[0m21:07:29.032920 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m21:07:29.039659 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m21:07:29.040391 [debug] [Thread-4 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */
alter table "neondb"."public_public"."fct_deliveries__dbt_tmp" rename to "fct_deliveries"
[0m21:07:29.058740 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m21:07:29.061439 [debug] [Thread-4 (]: On model.dashdash_lab.fct_deliveries: COMMIT
[0m21:07:29.062246 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m21:07:29.062757 [debug] [Thread-4 (]: On model.dashdash_lab.fct_deliveries: COMMIT
[0m21:07:29.083102 [debug] [Thread-4 (]: SQL status: COMMIT in 0.020 seconds
[0m21:07:29.087917 [debug] [Thread-4 (]: Applying DROP to: "neondb"."public_public"."fct_deliveries__dbt_backup"
[0m21:07:29.088943 [debug] [Thread-4 (]: Using postgres connection "model.dashdash_lab.fct_deliveries"
[0m21:07:29.089621 [debug] [Thread-4 (]: On model.dashdash_lab.fct_deliveries: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.fct_deliveries"} */
drop view if exists "neondb"."public_public"."fct_deliveries__dbt_backup" cascade
[0m21:07:29.107344 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.017 seconds
[0m21:07:29.110006 [debug] [Thread-4 (]: On model.dashdash_lab.fct_deliveries: Close
[0m21:07:29.111482 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116010560>]}
[0m21:07:29.112640 [info ] [Thread-4 (]: 9 of 10 OK created sql view model public_public.fct_deliveries ................. [[32mCREATE VIEW[0m in 0.35s]
[0m21:07:29.113653 [debug] [Thread-4 (]: Finished running node model.dashdash_lab.fct_deliveries
[0m21:07:29.114886 [debug] [Thread-3 (]: Began running node model.dashdash_lab.kpi_delivery_overview
[0m21:07:29.115788 [info ] [Thread-3 (]: 10 of 10 START sql view model public_public.kpi_delivery_overview .............. [RUN]
[0m21:07:29.116487 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dashdash_lab.monitoring_dq_exceptions, now model.dashdash_lab.kpi_delivery_overview)
[0m21:07:29.117089 [debug] [Thread-3 (]: Began compiling node model.dashdash_lab.kpi_delivery_overview
[0m21:07:29.125253 [debug] [Thread-3 (]: Writing injected SQL for node "model.dashdash_lab.kpi_delivery_overview"
[0m21:07:29.125683 [debug] [Thread-3 (]: Began executing node model.dashdash_lab.kpi_delivery_overview
[0m21:07:29.127031 [debug] [Thread-3 (]: Writing runtime sql for node "model.dashdash_lab.kpi_delivery_overview"
[0m21:07:29.127328 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m21:07:29.127482 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: BEGIN
[0m21:07:29.127624 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:07:29.277872 [debug] [Thread-3 (]: SQL status: BEGIN in 0.150 seconds
[0m21:07:29.278842 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m21:07:29.279671 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */

  create view "neondb"."public_public"."kpi_delivery_overview__dbt_tmp"
    
    
  as (
    

with d as (
    select *
    from "neondb"."public_public"."fct_deliveries"
)
select
    
    
        AVG(CASE WHEN on_time_flag THEN 1 ELSE 0 END)::numeric(5, 4)
    
 as on_time_rate,
    
    
        AVG(delivery_minutes)::numeric(6, 2)
    
 as avg_delivery_minutes,
    (
        select 
    
        (COUNT(*) FILTER (WHERE status IN ('canceled', 'returned'))::numeric / NULLIF(COUNT(*), 0))
    

        from "neondb"."public_public"."stg_orders"
    ) as cancel_return_rate
from d
  );
[0m21:07:29.310210 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m21:07:29.317720 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m21:07:29.318532 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */
alter table "neondb"."public_public"."kpi_delivery_overview__dbt_tmp" rename to "kpi_delivery_overview"
[0m21:07:29.336073 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m21:07:29.338499 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: COMMIT
[0m21:07:29.339236 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m21:07:29.339904 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: COMMIT
[0m21:07:29.360426 [debug] [Thread-3 (]: SQL status: COMMIT in 0.020 seconds
[0m21:07:29.367852 [debug] [Thread-3 (]: Applying DROP to: "neondb"."public_public"."kpi_delivery_overview__dbt_backup"
[0m21:07:29.368723 [debug] [Thread-3 (]: Using postgres connection "model.dashdash_lab.kpi_delivery_overview"
[0m21:07:29.369301 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "model.dashdash_lab.kpi_delivery_overview"} */
drop view if exists "neondb"."public_public"."kpi_delivery_overview__dbt_backup" cascade
[0m21:07:29.386619 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.017 seconds
[0m21:07:29.389091 [debug] [Thread-3 (]: On model.dashdash_lab.kpi_delivery_overview: Close
[0m21:07:29.390402 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8fa0f30-c3b7-4371-8bb2-5a4740d20ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161219a0>]}
[0m21:07:29.391591 [info ] [Thread-3 (]: 10 of 10 OK created sql view model public_public.kpi_delivery_overview ......... [[32mCREATE VIEW[0m in 0.27s]
[0m21:07:29.392623 [debug] [Thread-3 (]: Finished running node model.dashdash_lab.kpi_delivery_overview
[0m21:07:29.394243 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:29.394658 [debug] [MainThread]: On master: BEGIN
[0m21:07:29.395009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:07:29.633114 [debug] [MainThread]: SQL status: BEGIN in 0.238 seconds
[0m21:07:29.634744 [debug] [MainThread]: On master: COMMIT
[0m21:07:29.635945 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:29.636515 [debug] [MainThread]: On master: COMMIT
[0m21:07:29.654431 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m21:07:29.655867 [debug] [MainThread]: On master: Close
[0m21:07:29.657860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:29.658600 [debug] [MainThread]: Connection 'model.dashdash_lab.dim_restaurant' was properly closed.
[0m21:07:29.659192 [debug] [MainThread]: Connection 'model.dashdash_lab.dim_customer' was properly closed.
[0m21:07:29.659837 [debug] [MainThread]: Connection 'model.dashdash_lab.kpi_delivery_overview' was properly closed.
[0m21:07:29.660404 [debug] [MainThread]: Connection 'model.dashdash_lab.fct_deliveries' was properly closed.
[0m21:07:29.661154 [info ] [MainThread]: 
[0m21:07:29.661785 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m21:07:29.664859 [debug] [MainThread]: Command end result
[0m21:07:29.681431 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/manifest.json
[0m21:07:29.682308 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/semantic_manifest.json
[0m21:07:29.684829 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/run_results.json
[0m21:07:29.684992 [info ] [MainThread]: 
[0m21:07:29.685169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:07:29.685305 [info ] [MainThread]: 
[0m21:07:29.685450 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m21:07:29.687023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9433348, "process_in_blocks": "0", "process_kernel_time": 0.231092, "process_mem_max_rss": "130695168", "process_out_blocks": "0", "process_user_time": 1.313684}
[0m21:07:29.687303 [debug] [MainThread]: Command `dbt run` succeeded at 21:07:29.687264 after 2.94 seconds
[0m21:07:29.687485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11052c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a3bb30>]}
[0m21:07:29.687656 [debug] [MainThread]: Flushing usage events
[0m21:07:29.772855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:07:30.575694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c52fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569c1a0>]}


============================== 21:07:30.577749 | 0301ccfc-3dfc-49d4-b6fe-cdace941addc ==============================
[0m21:07:30.577749 [info ] [MainThread]: Running with dbt=1.10.11
[0m21:07:30.578041 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt test --target dev --profiles-dir /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/_profiles', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'empty': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'quiet': 'False', 'indirect_selection': 'eager'}
[0m21:07:30.689716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0301ccfc-3dfc-49d4-b6fe-cdace941addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caeba0>]}
[0m21:07:30.721284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0301ccfc-3dfc-49d4-b6fe-cdace941addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10295a090>]}
[0m21:07:30.721834 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:07:30.770264 [debug] [MainThread]: checksum: f3a15f20cd0e17be8ec6b80249cbdcbd069c0abe6ee56424d4c8bc1a8c4095f7, vars: {}, profile: , target: dev, version: 1.10.11
[0m21:07:30.822438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:07:30.822678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:07:30.841573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0301ccfc-3dfc-49d4-b6fe-cdace941addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6b7d0>]}
[0m21:07:30.877858 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/manifest.json
[0m21:07:30.878810 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/semantic_manifest.json
[0m21:07:30.889903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0301ccfc-3dfc-49d4-b6fe-cdace941addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10affa1b0>]}
[0m21:07:30.890183 [info ] [MainThread]: Found 10 models, 13 data tests, 4 sources, 556 macros
[0m21:07:30.890358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0301ccfc-3dfc-49d4-b6fe-cdace941addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af3e360>]}
[0m21:07:30.891405 [info ] [MainThread]: 
[0m21:07:30.891574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:07:30.891698 [info ] [MainThread]: 
[0m21:07:30.891919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:07:30.893681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_neondb_public_public'
[0m21:07:30.913715 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m21:07:30.913991 [debug] [ThreadPool]: On list_neondb_public_public: BEGIN
[0m21:07:30.914135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:31.164109 [debug] [ThreadPool]: SQL status: BEGIN in 0.250 seconds
[0m21:07:31.166113 [debug] [ThreadPool]: Using postgres connection "list_neondb_public_public"
[0m21:07:31.167707 [debug] [ThreadPool]: On list_neondb_public_public: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "list_neondb_public_public"} */
select
      'neondb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'neondb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:07:31.189589 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.021 seconds
[0m21:07:31.193061 [debug] [ThreadPool]: On list_neondb_public_public: ROLLBACK
[0m21:07:31.211156 [debug] [ThreadPool]: On list_neondb_public_public: Close
[0m21:07:31.223066 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:31.223653 [debug] [MainThread]: On master: BEGIN
[0m21:07:31.224104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:07:31.380024 [debug] [MainThread]: SQL status: BEGIN in 0.156 seconds
[0m21:07:31.380886 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:31.381768 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:07:31.404896 [debug] [MainThread]: SQL status: SELECT 28 in 0.022 seconds
[0m21:07:31.411798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0301ccfc-3dfc-49d4-b6fe-cdace941addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c28bc0>]}
[0m21:07:31.412636 [debug] [MainThread]: On master: ROLLBACK
[0m21:07:31.429564 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:31.430254 [debug] [MainThread]: On master: BEGIN
[0m21:07:31.465636 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m21:07:31.467278 [debug] [MainThread]: On master: COMMIT
[0m21:07:31.468491 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:31.469335 [debug] [MainThread]: On master: COMMIT
[0m21:07:31.486418 [debug] [MainThread]: SQL status: COMMIT in 0.016 seconds
[0m21:07:31.487219 [debug] [MainThread]: On master: Close
[0m21:07:31.491910 [debug] [Thread-1 (]: Began running node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m21:07:31.492677 [debug] [Thread-2 (]: Began running node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m21:07:31.493356 [debug] [Thread-3 (]: Began running node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m21:07:31.494061 [debug] [Thread-4 (]: Began running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m21:07:31.494673 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_dim_courier_vehicle_type__bike__scooter__car  [RUN]
[0m21:07:31.495366 [info ] [Thread-2 (]: 2 of 13 START test accepted_values_stg_couriers_vehicle_type__bike__scooter__car  [RUN]
[0m21:07:31.496023 [info ] [Thread-3 (]: 3 of 13 START test accepted_values_stg_orders_status__delivered__canceled__returned__unknown  [RUN]
[0m21:07:31.496590 [info ] [Thread-4 (]: 4 of 13 START test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0  [RUN]
[0m21:07:31.497213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_neondb_public_public, now test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3)
[0m21:07:31.497830 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37'
[0m21:07:31.498353 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e'
[0m21:07:31.498874 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486'
[0m21:07:31.499341 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m21:07:31.499874 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m21:07:31.500294 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m21:07:31.500740 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m21:07:31.508894 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m21:07:31.510541 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m21:07:31.513553 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m21:07:31.542172 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m21:07:31.542777 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m21:07:31.548996 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m21:07:31.549196 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m21:07:31.550074 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m21:07:31.551006 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m21:07:31.551193 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m21:07:31.552091 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m21:07:31.553152 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m21:07:31.553504 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m21:07:31.553722 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m21:07:31.553909 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: BEGIN
[0m21:07:31.554094 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m21:07:31.554285 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: BEGIN
[0m21:07:31.554484 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m21:07:31.554698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:31.554858 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: BEGIN
[0m21:07:31.555012 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:07:31.555196 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: BEGIN
[0m21:07:31.555457 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:07:31.555685 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:07:31.744041 [debug] [Thread-4 (]: SQL status: BEGIN in 0.188 seconds
[0m21:07:31.744901 [debug] [Thread-3 (]: SQL status: BEGIN in 0.189 seconds
[0m21:07:31.745805 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"
[0m21:07:31.746490 [debug] [Thread-2 (]: SQL status: BEGIN in 0.191 seconds
[0m21:07:31.747130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.192 seconds
[0m21:07:31.747826 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"
[0m21:07:31.748553 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "neondb"."public_public"."stg_orders"

where not(delivery_minutes delivery_minutes IS NULL OR delivery_minutes >= 0)


  
  
      
    ) dbt_internal_test
[0m21:07:31.749241 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"
[0m21:07:31.749788 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"
[0m21:07:31.750415 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "neondb"."public_public"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'delivered','canceled','returned','unknown'
)



  
  
      
    ) dbt_internal_test
[0m21:07:31.751195 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vehicle_type as value_field,
        count(*) as n_records

    from "neondb"."public_public"."stg_couriers"
    group by vehicle_type

)

select *
from all_values
where value_field not in (
    'bike','scooter','car'
)



  
  
      
    ) dbt_internal_test
[0m21:07:31.751720 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        vehicle_type as value_field,
        count(*) as n_records

    from "neondb"."public_public"."dim_courier"
    group by vehicle_type

)

select *
from all_values
where value_field not in (
    'bike','scooter','car'
)



  
  
      
    ) dbt_internal_test
[0m21:07:31.768465 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "delivery_minutes"
LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                    ^

[0m21:07:31.769378 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: ROLLBACK
[0m21:07:31.773665 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m21:07:31.774659 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m21:07:31.775342 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.023 seconds
[0m21:07:31.781010 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: ROLLBACK
[0m21:07:31.782696 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: ROLLBACK
[0m21:07:31.784361 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: ROLLBACK
[0m21:07:31.787398 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486: Close
[0m21:07:31.792437 [debug] [Thread-4 (]: Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m21:07:31.792693 [error] [Thread-4 (]: 4 of 13 ERROR dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0  [[31mERROR[0m in 0.29s]
[0m21:07:31.792972 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486
[0m21:07:31.793159 [debug] [Thread-4 (]: Began running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m21:07:31.793396 [debug] [Thread-7 (]: Marking all children of 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql.
[0m21:07:31.793615 [info ] [Thread-4 (]: 5 of 13 START test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_  [RUN]
[0m21:07:31.794111 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0.9ab87c4486, now test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3)
[0m21:07:31.794283 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m21:07:31.796467 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m21:07:31.796821 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m21:07:31.797752 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m21:07:31.798081 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m21:07:31.798247 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: BEGIN
[0m21:07:31.798402 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:07:31.801323 [debug] [Thread-2 (]: On test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37: Close
[0m21:07:31.801483 [debug] [Thread-1 (]: On test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3: Close
[0m21:07:31.801678 [debug] [Thread-3 (]: On test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e: Close
[0m21:07:31.802070 [error] [Thread-2 (]: 2 of 13 FAIL 1 accepted_values_stg_couriers_vehicle_type__bike__scooter__car ... [[31mFAIL 1[0m in 0.30s]
[0m21:07:31.802334 [info ] [Thread-3 (]: 3 of 13 PASS accepted_values_stg_orders_status__delivered__canceled__returned__unknown  [[32mPASS[0m in 0.30s]
[0m21:07:31.802807 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37
[0m21:07:31.802545 [error] [Thread-1 (]: 1 of 13 FAIL 1 accepted_values_dim_courier_vehicle_type__bike__scooter__car .... [[31mFAIL 1[0m in 0.31s]
[0m21:07:31.803085 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e
[0m21:07:31.803263 [debug] [Thread-2 (]: Began running node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m21:07:31.803503 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3
[0m21:07:31.803664 [debug] [Thread-3 (]: Began running node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m21:07:31.803837 [info ] [Thread-2 (]: 6 of 13 START test not_null_fct_deliveries_order_id ............................ [RUN]
[0m21:07:31.804027 [debug] [Thread-1 (]: Began running node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m21:07:31.804196 [info ] [Thread-3 (]: 7 of 13 START test not_null_stg_orders_order_id ................................ [RUN]
[0m21:07:31.804384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_stg_couriers_vehicle_type__bike__scooter__car.9b9a6b8e37, now test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4)
[0m21:07:31.804557 [info ] [Thread-1 (]: 8 of 13 START test relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_  [RUN]
[0m21:07:31.804750 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_stg_orders_status__delivered__canceled__returned__unknown.5a7d49a78e, now test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:07:31.804923 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m21:07:31.805084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.accepted_values_dim_courier_vehicle_type__bike__scooter__car.5fd38639b3, now test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447)
[0m21:07:31.805241 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m21:07:31.807980 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m21:07:31.808168 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m21:07:31.810525 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:07:31.813640 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m21:07:31.813909 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m21:07:31.814871 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m21:07:31.815102 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m21:07:31.815267 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m21:07:31.816274 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:07:31.817279 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m21:07:31.817490 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m21:07:31.817810 [debug] [Thread-2 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: BEGIN
[0m21:07:31.818008 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:07:31.818171 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:07:31.818425 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m21:07:31.818605 [debug] [Thread-3 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m21:07:31.818769 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: BEGIN
[0m21:07:31.818924 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:07:31.819071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:31.947042 [debug] [Thread-4 (]: SQL status: BEGIN in 0.148 seconds
[0m21:07:31.947756 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"
[0m21:07:31.948293 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  



select
    1
from "neondb"."public_public"."stg_orders"

where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS NOT NULL) OR (status IN ('canceled','returned','unknown') AND dropoff_ts IS NULL))


  
  
      
    ) dbt_internal_test
[0m21:07:31.967665 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function dropoff_ts(boolean) does not exist
LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m21:07:31.968255 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: ROLLBACK
[0m21:07:31.978281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m21:07:31.978810 [debug] [Thread-2 (]: SQL status: BEGIN in 0.161 seconds
[0m21:07:31.979289 [debug] [Thread-3 (]: SQL status: BEGIN in 0.160 seconds
[0m21:07:31.979769 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"
[0m21:07:31.980231 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"
[0m21:07:31.980634 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:07:31.981117 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select courier_id as from_field
    from (select * from "neondb"."public_public"."fct_deliveries" where courier_id IS NOT NULL) dbt_subquery
    where courier_id is not null
),

parent as (
    select courier_id as to_field
    from "neondb"."public_public"."dim_courier"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:07:31.981622 [debug] [Thread-2 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "neondb"."public_public"."fct_deliveries"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:07:31.982078 [debug] [Thread-3 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "neondb"."public_public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:07:31.985051 [debug] [Thread-4 (]: On test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3: Close
[0m21:07:31.988173 [debug] [Thread-4 (]: Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m21:07:31.988812 [error] [Thread-4 (]: 5 of 13 ERROR dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_  [[31mERROR[0m in 0.19s]
[0m21:07:31.989397 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3
[0m21:07:31.989742 [debug] [Thread-4 (]: Began running node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m21:07:31.990199 [debug] [Thread-7 (]: Marking all children of 'test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql.
[0m21:07:31.990625 [info ] [Thread-4 (]: 9 of 13 START test relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_  [RUN]
[0m21:07:31.991170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_.377249f2e3, now test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501)
[0m21:07:31.991503 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m21:07:31.996119 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m21:07:31.997053 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m21:07:31.998685 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m21:07:31.999224 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m21:07:31.999483 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: BEGIN
[0m21:07:31.999723 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:07:32.009232 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.027 seconds
[0m21:07:32.009527 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m21:07:32.009761 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.027 seconds
[0m21:07:32.011032 [debug] [Thread-3 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m21:07:32.011935 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: ROLLBACK
[0m21:07:32.012773 [debug] [Thread-2 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: ROLLBACK
[0m21:07:32.117113 [debug] [Thread-3 (]: On test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m21:07:32.117641 [debug] [Thread-2 (]: On test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4: Close
[0m21:07:32.118098 [debug] [Thread-1 (]: On test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447: Close
[0m21:07:32.119277 [info ] [Thread-3 (]: 7 of 13 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.31s]
[0m21:07:32.121112 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64
[0m21:07:32.119878 [info ] [Thread-2 (]: 6 of 13 PASS not_null_fct_deliveries_order_id .................................. [[32mPASS[0m in 0.32s]
[0m21:07:32.121762 [debug] [Thread-3 (]: Began running node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m21:07:32.120417 [info ] [Thread-1 (]: 8 of 13 PASS relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_  [[32mPASS[0m in 0.32s]
[0m21:07:32.122485 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4
[0m21:07:32.122984 [info ] [Thread-3 (]: 10 of 13 START test relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_  [RUN]
[0m21:07:32.123583 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447
[0m21:07:32.124039 [debug] [Thread-2 (]: Began running node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m21:07:32.124515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.not_null_stg_orders_order_id.81cfe2fe64, now test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c)
[0m21:07:32.124922 [debug] [Thread-1 (]: Began running node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m21:07:32.125346 [info ] [Thread-2 (]: 11 of 13 START test relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_  [RUN]
[0m21:07:32.125742 [debug] [Thread-3 (]: Began compiling node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m21:07:32.126099 [info ] [Thread-1 (]: 12 of 13 START test unique_fct_deliveries_order_id ............................. [RUN]
[0m21:07:32.126496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.not_null_fct_deliveries_order_id.c19a99eed4, now test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465)
[0m21:07:32.131484 [debug] [Thread-3 (]: Writing injected SQL for node "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m21:07:32.131851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.relationships_fct_deliveries_courier_id__courier_id__ref_dim_courier_.2a099aa447, now test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a)
[0m21:07:32.132162 [debug] [Thread-2 (]: Began compiling node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m21:07:32.132572 [debug] [Thread-1 (]: Began compiling node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m21:07:32.136529 [debug] [Thread-2 (]: Writing injected SQL for node "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m21:07:32.142112 [debug] [Thread-1 (]: Writing injected SQL for node "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m21:07:32.142639 [debug] [Thread-3 (]: Began executing node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m21:07:32.144223 [debug] [Thread-3 (]: Writing runtime sql for node "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m21:07:32.144489 [debug] [Thread-2 (]: Began executing node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m21:07:32.144799 [debug] [Thread-1 (]: Began executing node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m21:07:32.146196 [debug] [Thread-2 (]: Writing runtime sql for node "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m21:07:32.147625 [debug] [Thread-1 (]: Writing runtime sql for node "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m21:07:32.147952 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m21:07:32.148331 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: BEGIN
[0m21:07:32.148615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:07:32.148849 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m21:07:32.149065 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m21:07:32.149393 [debug] [Thread-1 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: BEGIN
[0m21:07:32.149609 [debug] [Thread-2 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: BEGIN
[0m21:07:32.149823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:32.150027 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:07:32.239291 [debug] [Thread-4 (]: SQL status: BEGIN in 0.239 seconds
[0m21:07:32.239681 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"
[0m21:07:32.239923 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select restaurant_id as from_field
    from "neondb"."public_public"."fct_deliveries"
    where restaurant_id is not null
),

parent as (
    select restaurant_id as to_field
    from "neondb"."public_public"."dim_restaurant"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:07:32.258077 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m21:07:32.258966 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: ROLLBACK
[0m21:07:32.275336 [debug] [Thread-4 (]: On test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501: Close
[0m21:07:32.276823 [info ] [Thread-4 (]: 9 of 13 PASS relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_  [[32mPASS[0m in 0.29s]
[0m21:07:32.277102 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501
[0m21:07:32.277290 [debug] [Thread-4 (]: Began running node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m21:07:32.277511 [info ] [Thread-4 (]: 13 of 13 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:07:32.277813 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dashdash_lab.relationships_fct_deliveries_restaurant_id__restaurant_id__ref_dim_restaurant_.afbe833501, now test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a)
[0m21:07:32.277981 [debug] [Thread-4 (]: Began compiling node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m21:07:32.280039 [debug] [Thread-4 (]: Writing injected SQL for node "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m21:07:32.280670 [debug] [Thread-4 (]: Began executing node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m21:07:32.281607 [debug] [Thread-4 (]: Writing runtime sql for node "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m21:07:32.282776 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m21:07:32.282938 [debug] [Thread-4 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m21:07:32.283084 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:07:32.305028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m21:07:32.305363 [debug] [Thread-3 (]: SQL status: BEGIN in 0.157 seconds
[0m21:07:32.305579 [debug] [Thread-1 (]: Using postgres connection "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"
[0m21:07:32.305757 [debug] [Thread-3 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"
[0m21:07:32.305924 [debug] [Thread-1 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "neondb"."public_public"."fct_deliveries"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:07:32.306111 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select courier_id as from_field
    from (select * from "neondb"."public_public"."stg_orders" where courier_id IS NOT NULL) dbt_subquery
    where courier_id is not null
),

parent as (
    select courier_id as to_field
    from "neondb"."public_public"."stg_couriers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:07:32.318477 [debug] [Thread-2 (]: SQL status: BEGIN in 0.168 seconds
[0m21:07:32.318828 [debug] [Thread-2 (]: Using postgres connection "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"
[0m21:07:32.319028 [debug] [Thread-2 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select restaurant_id as from_field
    from "neondb"."public_public"."stg_orders"
    where restaurant_id is not null
),

parent as (
    select restaurant_id as to_field
    from "neondb"."public_public"."stg_restaurants"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:07:32.326463 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.020 seconds
[0m21:07:32.326724 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m21:07:32.327826 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: ROLLBACK
[0m21:07:32.328609 [debug] [Thread-1 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: ROLLBACK
[0m21:07:32.336576 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m21:07:32.337213 [debug] [Thread-2 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: ROLLBACK
[0m21:07:32.345417 [debug] [Thread-3 (]: On test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c: Close
[0m21:07:32.345581 [debug] [Thread-1 (]: On test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a: Close
[0m21:07:32.346066 [info ] [Thread-3 (]: 10 of 13 PASS relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_  [[32mPASS[0m in 0.22s]
[0m21:07:32.346291 [info ] [Thread-1 (]: 12 of 13 PASS unique_fct_deliveries_order_id ................................... [[32mPASS[0m in 0.21s]
[0m21:07:32.346642 [debug] [Thread-3 (]: Finished running node test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c
[0m21:07:32.346868 [debug] [Thread-1 (]: Finished running node test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a
[0m21:07:32.354170 [debug] [Thread-2 (]: On test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465: Close
[0m21:07:32.354508 [error] [Thread-2 (]: 11 of 13 FAIL 1 relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_  [[31mFAIL 1[0m in 0.23s]
[0m21:07:32.354740 [debug] [Thread-2 (]: Finished running node test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465
[0m21:07:32.432099 [debug] [Thread-4 (]: SQL status: BEGIN in 0.149 seconds
[0m21:07:32.433864 [debug] [Thread-4 (]: Using postgres connection "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"
[0m21:07:32.434593 [debug] [Thread-4 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "dashdash_lab", "target_name": "dev", "node_id": "test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "neondb"."public_public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:07:32.452741 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m21:07:32.455569 [debug] [Thread-4 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m21:07:32.472471 [debug] [Thread-4 (]: On test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a: Close
[0m21:07:32.474685 [info ] [Thread-4 (]: 13 of 13 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.20s]
[0m21:07:32.475817 [debug] [Thread-4 (]: Finished running node test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a
[0m21:07:32.478098 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:32.478717 [debug] [MainThread]: On master: BEGIN
[0m21:07:32.479190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:07:32.728354 [debug] [MainThread]: SQL status: BEGIN in 0.249 seconds
[0m21:07:32.729633 [debug] [MainThread]: On master: COMMIT
[0m21:07:32.730381 [debug] [MainThread]: Using postgres connection "master"
[0m21:07:32.730931 [debug] [MainThread]: On master: COMMIT
[0m21:07:32.748531 [debug] [MainThread]: SQL status: COMMIT in 0.017 seconds
[0m21:07:32.749652 [debug] [MainThread]: On master: Close
[0m21:07:32.750923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:32.751366 [debug] [MainThread]: Connection 'test.dashdash_lab.unique_fct_deliveries_order_id.fb7156d55a' was properly closed.
[0m21:07:32.751738 [debug] [MainThread]: Connection 'test.dashdash_lab.relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_.46f8754465' was properly closed.
[0m21:07:32.752090 [debug] [MainThread]: Connection 'test.dashdash_lab.relationships_stg_orders_courier_id__courier_id__ref_stg_couriers_.2c4f527a9c' was properly closed.
[0m21:07:32.752480 [debug] [MainThread]: Connection 'test.dashdash_lab.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m21:07:32.752996 [info ] [MainThread]: 
[0m21:07:32.753460 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m21:07:32.756091 [debug] [MainThread]: Command end result
[0m21:07:32.780754 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/manifest.json
[0m21:07:32.782119 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/semantic_manifest.json
[0m21:07:32.786684 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/kenechukwuezekwem/Documents/MACY1_GC_3260_LAB06_V2.0_10152025/dbt_dashdash/target/run_results.json
[0m21:07:32.786931 [info ] [MainThread]: 
[0m21:07:32.787171 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m21:07:32.787371 [info ] [MainThread]: 
[0m21:07:32.787620 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)[0m
[0m21:07:32.787886 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_orders_delivery_minutes__delivery_minutes_IS_NULL_OR_delivery_minutes_0 (models/staging/stg_orders.yml)
  syntax error at or near "delivery_minutes"
  LINE 18: where not(delivery_minutes delivery_minutes IS NULL OR deliv...
                                      ^
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m21:07:32.788083 [info ] [MainThread]: 
[0m21:07:32.788302 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_97868106d11f5495721f85614fe56303.sql
[0m21:07:32.788470 [info ] [MainThread]: 
[0m21:07:32.788669 [error] [MainThread]: [31mFailure in test accepted_values_stg_couriers_vehicle_type__bike__scooter__car (models/staging/stg_couriers.yml)[0m
[0m21:07:32.788873 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:07:32.789029 [info ] [MainThread]: 
[0m21:07:32.789221 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_couriers.yml/accepted_values_stg_couriers_vehicle_type__bike__scooter__car.sql
[0m21:07:32.789385 [info ] [MainThread]: 
[0m21:07:32.789580 [error] [MainThread]: [31mFailure in test accepted_values_dim_courier_vehicle_type__bike__scooter__car (models/marts/schema.yml)[0m
[0m21:07:32.789775 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:07:32.789930 [info ] [MainThread]: 
[0m21:07:32.790121 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/marts/schema.yml/accepted_values_dim_courier_vehicle_type__bike__scooter__car.sql
[0m21:07:32.790280 [info ] [MainThread]: 
[0m21:07:32.790487 [error] [MainThread]: [31mFailure in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)[0m
[0m21:07:32.790725 [error] [MainThread]:   Database Error in test dbt_utils_expression_is_true_stg_orders_dropoff_ts___status_delivered_AND_dropoff_ts_IS_NOT_NULL_OR_status_IN_canceled_returned_unknown_AND_dropoff_ts_IS_NULL_ (models/staging/stg_orders.yml)
  function dropoff_ts(boolean) does not exist
  LINE 18: where not(dropoff_ts (status = 'delivered' AND dropoff_ts IS...
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m21:07:32.790906 [info ] [MainThread]: 
[0m21:07:32.791104 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/dbt_utils_expression_is_true_s_6f1f3db7fd331fd5e80168eeafd17ba3.sql
[0m21:07:32.791265 [info ] [MainThread]: 
[0m21:07:32.791462 [error] [MainThread]: [31mFailure in test relationships_stg_orders_restaurant_id__restaurant_id__ref_stg_restaurants_ (models/staging/stg_orders.yml)[0m
[0m21:07:32.791669 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:07:32.791825 [info ] [MainThread]: 
[0m21:07:32.792014 [info ] [MainThread]:   compiled code at target/compiled/dashdash_lab/models/staging/stg_orders.yml/relationships_stg_orders_30762036887c15c825a33e927a3d9200.sql
[0m21:07:32.792179 [info ] [MainThread]: 
[0m21:07:32.792367 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=13
[0m21:07:32.794347 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.2536817, "process_in_blocks": "0", "process_kernel_time": 0.189539, "process_mem_max_rss": "138051584", "process_out_blocks": "0", "process_user_time": 1.264106}
[0m21:07:32.794645 [debug] [MainThread]: Command `dbt test` failed at 21:07:32.794597 after 2.25 seconds
[0m21:07:32.794883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b570ec0>]}
[0m21:07:32.795094 [debug] [MainThread]: Flushing usage events
[0m21:07:32.871845 [debug] [MainThread]: An error was encountered while trying to flush usage events
